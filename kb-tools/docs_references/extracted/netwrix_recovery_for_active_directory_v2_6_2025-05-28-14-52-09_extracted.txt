A single improper change to Microsoft Active Directory, whether accidental or deliberate, can lead to disaster. Alter the wrong Group Policy setting and suddenly users are free to install ransomware on their machines or copy data to USB drives. Make the wrong person a member of an Active Directory group and they’ll be able to read, access or delete files they shouldn’t. Delete the wrong account and an essential business process might come to a halt. Even more devastating, a cyberattack, hardware failure, internal error, or natural calamity can bring down your entire Active Directory forest. Native tools don’t make it easy to revert these critical changes — but Netwrix Recovery for Active Directory does. Administrators can quickly rollback and recover Active Directory objects or just a single attribute to a known good state, with little to no downtime. They can also restore a domain controller or an entire forest to a specific state-in-time image. Getting Started This topic provides information on installing and configuring Netwrix Recovery for Active Directory, which enables organizations to quickly and easily roll back and recover unintended directory changes. Installation Requirements Before installing Recovery for Active Directory, review the recommended configuration of the servers needed to install this product in a production environment. See the Requirements topic for additional information. Installation Install and configure Recovery for Active Directory. See the Install the Application topic for additional information. NOTE: Installing the server automatically installs the RSAT Extension locally. v2.6 First Launch Launch Recovery for Active Directory using the desktop icon and sign in with the administrator role account that was configured during installation. See the First Launch topic for additional information on signing in for the first time. Initial Configuration Several Recovery for Active Directory components require configuration after the first launch of the product. Configure Domain Backup – On logging into the Recovery Console, you land on the Domain Backup Configuration Page, that directs you to configure a domain to be backed up. It is recommended a start a backup of the domain after configuring it. See the Domains Page topic for additional information on configuring a domain to backup. Configure Forest Backup – Configure a forest and then configure backup settings for domain controllers in the forest. It is recommended a start a backup of the domain controllers after configuring backup settings. See the Forest Page topic for additional information on configuring a domain controller backup. (Optional) Install RSAT Extension on Additional Servers – The RSAT Extension.msi is automatically installed with the Recovery for Active Directory application on the application server. The extension can also be installed on other servers where ADUC is installed. See the Install the RSAT Extension topic for additional information. Configure Additional Users – The user or group configured during installation of the product has administrator access to the Recovery Console. Additional users and groups can be added and assigned roles. See the Users and Roles Page topic for additional information. (Optional) Configure Notifications – Email notifications require configuration before they can be enabled. See the Notifications Page topic for additional information on c onfiguring email notifications. Rollback and Restore Operations Now that the initial configuration of Recovery for Active Directory is complete and backups have been created, you can rollback and recover Active Directory objects, as well as restore domain controllers. What's New v2.6 New Netwrix Community! All Netwrix product announcements have moved to the new Netwrix Community. See announcements for Netwrix Recovery for Active Directory in the Recovery for Active Directory area of our new community. The following information highlights the new and improved features introduced in this Netwrix Recovery for Active Directory version. v2.6 v2.6 enables comprehensive domain controller backup and recovery. If your domain controllers get corrupted, encrypted due to ransomware, or even completely wiped out either intentionally or accidentally, you can always recover your Active Directory forest from a secure backup. NOTE: The dashboard has been deprecated in this version. v2.6 New: Automated AD Forest Recovery Enhance the availability of your Active Directory with a rapid and reliable automated recovery process for entire Active Directory forests and domains. Benefit from significantly improved storage optimization, reducing backup sizes from 20GB to just 10MB. New: Flexible Backup and Restore Options Backup and restore physical or virtual domain controllers regardless of their hosting environment. Maximize flexibility and ensure seamless recovery processes for any Active Directory infrastructure. New: Data Retention Policy Stale data can now be purged from the database using a configurable range and options. You can specify x number of days after which backup data will be deleted. New: Integration with Netwrix Threat Prevention (formerly StealthINTERCEPT) Improve threat detection and response by combining Active Directory change data with realtime security intelligence from Netwrix Threat Prevention. This integration provides a comprehensive view of AD activity, enabling faster incident investigation and resolution. Enhancement: Unified Interface for Object Rollback and Recovery The Rollback and Recover navigation items have been merged into a consolidated Active Directory interface to enhance user experience. This simplifies object rollback and recovery, enabling faster, easier management for IT teams. Enhancement: Additional Audit Details View detailed information on audit events generated by the product, such as what settings were updated and what constitutes the change. Use Cases Recovery for Active Directory enables you to rollback and recover both accidental and malicious changes to Active Directory. This topic outlines common use cases as examples. Recover a Deleted Object Deleted objects can be difficult to recover natively without the Active Directory Recycle Bin enabled, which is not enabled by default. While enabling the Recycle Bin enhances the restore v2.6 process, it is not a requirement for Recovery for Active Directory. An example of when a deleted object may need to be restored is: A user account has been accidentally deleted and it needs to be reinstated Restoring a deleted object can be accomplished through the following interface in the Recovery for Active Directory Console: Active Directory Page ◦ Locate the desired object in the Recycle Bin. ◦ Recover the object by following the steps in the Recover an Object topic. Rollback Changes to an Object Active Directory does not offer native ways to undo changes made to objects. Recovery for Active Directory can rollback object changes to any state captured within a backup. An example of when a change to an object may need to be rolled back is: Someone made a group membership change that impacted a user’s access Rolling back object changes can be accomplished through the following interface in the Recovery for Active Directory Console: Active Directory Page ◦ Locate the desired object ◦ Rollback changes to the object by following the steps in the Rollback Objects topic Rollback Attribute Changes A massive number of attributes changes in Active Directory can cause significant security and operational issues. Recovery for Active Directory can rollback attribute changes to any state captured within a backup. Some examples of when a change to an attribute may need to be rolled back are: Joe’s department attribute was changed and needs to be rolled back to what it was originally A user’s display name was changed and needs to be rolled back Rolling back attribute changes can be accomplished through the following interface within the Recovery for Active Directory Console: Active Directory Page v2.6 ◦ Locate the desired object ◦ Rollback changes to the object by following the steps in the Rollback Objects topic Remember to select the desired attribute for rollback Rollback Group Policy Object Changes Group Policy Objects (GPOs) control many aspects of operations, security, and software deployment. Recovery for Active Directory can rollback GPOs to any state captured within a backup. For this, Group Policy Management Console must be installed on the Recovery for Active Directory server. See Steps 9 and 10 in the Add a Domain topic for additional information. An example of when a GPO change may need to be rolled back is: A GPO change caused users to lose access to a server or application Rolling back GPO changes can be accomplished through the following interface in the Recovery for Active Directory Console: Active Directory Page ◦ Locate the desired object ◦ Rollback changes to the object by following the steps in the Rollback Objects topic Domain Controller Backup and Forest Restore from Backup Recovery for Active Directory can backup domain controllers to prevent data loss. The Forest Page allows administrators to configure and manage backups for a domain controller. You can then restore a domain controller backup using the backup file created by Recovery for Active Directory. To restore a forest, you can create a playbook to restore the domain controllers in a desired sequence. Some examples of when a server may need to be backed up or restored are: Stand up a duplicate of a domain controller, for example, stand up a duplicate in a lab environment for testing purposes Restore a domain controller to a specific state-in-time image Restore lost or deleted data Server backup and restore can be accomplished through the following interfaces: Forest Page v2.6 ◦ Configure backup settings for domain controllers ◦ Restore one or more domain controllers in a forest by following the steps in the Create a Recovery Playbook topic v2.6 Requirements This topic describes the recommended configuration of the servers needed to install Recovery for Active Directory in a production environment. RECOMMENDED: Review your environment and requirements with a Netwrixsupport engineer prior to deployment to ensure all exceptions are covered. Architecture Overview The following servers are required for installation of the application: Core Component v2.6) application is installed SQL Server for Recovery for Active Directory Database – As a data-intensive application, a well-provisioned, dedicated SQL Server is recommended RSAT Extension – Active Directory Users and Computers extension enabling Recovery for Active Directory features from within Microsoft management utilities See the following topics for server requirements: Application Server Requirements SQL Server Requirements RSAT Extension Requirements Target Domain Considerations The target domains include the Active Directory domains that can be added through the Domains Page. See the following topic for target domain considerations: Target Domains Table 1: Environment Large Medium Small Definition Greater than 100,000 objects Between 25,000 and 100,000 objects Less than 25,000 objects RAM 32 GB 16 GB 8 GB v2.6 Target Server Considerations Target servers include the servers and environments where you want to restore a domain controller or an entire forest. See the following topic for target server requirements: Target Server Considerations Application Server Requirements The Windows Server can be physical or virtual. The following Windows Server operating systems are supported: Windows Server 2022 Windows Server 2019 Windows Server 2016 Windows Server 2012 R2 Windows Server 2012 Additionally the server must meet these requirements: Domain-joined server 2.0 GHz or faster dual core 64-bit (x64) processor RAM and Disk Space These are dependent upon the total number of Active Directory objects. Environment Large Medium Small Greater than 100,000 Between 25,000 and Definition Less than 25,000 objects objects 100,000 objects RAM 32 GB 16 GB 8 GB Table 1: Environment Large Medium Small Disk Space 1 TB *SSD preferred 250 GB 100 GB v2.6 Environment Large Medium Small 1 TB Disk Space 250 GB 100 GB SSD preferred Additional Server Requirements The Recovery for Active Directory installer checks if .Net 8.06 is installed on the machine. If not, it is installed as part of the Recovery Application Server installation process. Install the msoledbsql.msi to enable the application server to connect to the SQL Server prior to starting installation NOTE: The latest msoledbsql.msi can be obtained from Microsoft's website. Netwrix does not redistribute this file. Group Policy Management Console (required to backup and to recover GPOs) Optional: SQL Server Management Studio installed on the application server Permissions for Installation The following permission is required to install the application: Membership in the local Administrators group Log on as a service right from the Local Security Policy (Local Policies > User Rights Assignment > Log on as a service policy) SQL Server permissions – Domain account needs to be granted SQL Server permissions. Recovery Configuration Utility – Must have Domain Admin rights to use all options in this utility Virtual Environment Recommendations While physical machines are always preferred, we fully support the use of virtual machines. Microsoft® Hyper-V® and VMWare® ESX®/ESXi™ are supported hyper visors. Table 1: Environment Large Medium Small Definition 15,000 - 1 million+ AD objects 2,000 - 15,000 AD objects Up to 2,000 AD objects RAM 64+ GB 32 GB 16 GB Cores 4+ CPU 4 CPU 2 CPU Disk Space 256 GB 64 GB 16 GB v2.6 SQL Server Requirements The Windows server can be physical or virtual. The following Windows server operating systems are supported: Windows Server 2022 Windows Server 2019 Windows Server 2016 Windows Server 2012 R2 Windows Server 2012 The server requirements for the SQL Server databases are: SQL Server 2022 SQL Server 2019 SQL Server 2017 SQL Server 2016 SQL Server 2014 SQL Server 2012 RAM, CPU, and Disk Space These depend on the size of the target environment. Environment Large Medium Small 15,000 - 1 million+ AD Definition 2,000 - 15,000 AD objects Up to 2,000 AD objects objects RAM 64+ GB 32 GB 16 GB Cores 4+ CPU 4 CPU 2 CPU Disk Space 256 GB 64 GB 16 GB v2.6 Additional Server Requirements The following are additional requirements for the SQL Server: All SQL Server databases configured to use ‘Simple Recovery Model’ Database Permissions The following permissions are required on the databases for the accounts used to run Recovery for Active Directory: Create a database Create Tables Read/Write Additional Considerations The following additional considerations are recommended for the SQL Server: Microsoft SQL Server supports TLS 1.2, which requires the Recovery for Active Directory server to have either SQL Server Native Client 11 or Microsoft Ole DB 18 installed. Optional: SQL Server Management Studio installed on the Recovery for Active Directory server RSAT Extension Requirements The following prerequisite is required to run the RSAT Extension: Remote Server Administration Tools (RSAT) must be installed Target Domains Target domains include the Active Directory domains that can be added through the Domains Page. You can rollback and recover objects in these domains through the Active Directory Page. Recovery for Active Directory can backup domains on servers with the Active Directory role on the following operating system versions: Windows Server 2022 Windows Server 2019 v2.6 Windows Server 2016 Windows Server 2012 R2 Windows Server 2012 Service Account Permissions The service account used to run backups, and perform rollback and recovery tasks for a domain is specified on the Domain page of the Add Domain Configuration wizard. This account must be: A member of the Domain Administrators group in the target domain There is a Least Privilege Access Model to provision an Active Directory security group with the permissions that are necessary to perform backups, rollbacks and recovery. Least Privilege Access Model It is strongly suggested that the Recovery for Active Directory service account be provided Domain Admin privileges; however, there are situations where security policies prevent an organization from providing Domain Admin privileges. In those situations, please contact your Netwrix service representative to work with you to develop a tailored Least Privilege Access model based on your environment. The privileges necessary to facilitate normal backup and recovery operations of an Active Directory environment, which are normally available to the Domain Administrators security group, include the following permissions: Membership in the Schema Admins group is necessary to facilitate backups of objects within the domain's Schema Container The following permissions on the domain's default naming context are necessary to facilitate backups and rollbacks of its Active Directory objects: ◦◦ ALLOW – Write Property right (SelfAndChildren) ◦◦ ALLOW – Create Child right (SelfAndChildren) ◦◦ ALLOW – Replicating Directory Changes extended right (SelfAndChildren) ◦◦ ALLOW – Reanimate Tombstones extended right (SelfAndChildren) v2.6 The following permissions on the domain's DomainDnsZones and ForestDnsZones partitions are necessary to facilitate backups and rollbacks of Active Directory DNS objects: ◦◦ ALLOW – Write Property right (SelfAndChildren) ◦◦ ALLOW – Create Child right (SelfAndChildren) ◦◦ ALLOW – Replicating Directory Changes extended right (SelfAndChildren) ◦◦ ALLOW – Reanimate Tombstones extended right (SelfAndChildren) The following permissions on the domain's Sites container are necessary to facilitate backups and rollbacks of Active Directory Sites and Services objects: ◦◦ ALLOW – Generic Read right (SelfAndChildren) ◦◦ ALLOW – Generic Write right (SelfAndChildren) ◦◦ ALLOW – Create Child right (SelfAndChildren) ◦◦ ALLOW – Replicating Directory Changes extended right (SelfAndChildren) ◦◦ ALLOW – Reanimate Tombstones extended right (SelfAndChildren) The following Group Policy access rights are necessary to facilitate backups and rollbacks of Group Policy Objects: ◦◦ READ ◦◦ WRITE ◦◦ CREATE CHILD OBJECT ◦◦ DELETE CHILD OBJECT ◦◦ DELETE ◦◦ MODIFY PERMISSIONS ◦◦ MODIFY OWNER CAUTION: Additional permissions may be necessary to allow RECOVERY FOR ACTIVE DIRECTORY to function properly in an organization’s environment. v2.6 Target Server Considerations This topic lists the requirements for the target servers where you want to restore the domain controllers for performing a forest recovery. See the Recover a Forest topic for additional information. Remember, target server refers to a server where you intent to restore a domain controller. Target Server and Operating System Requirements Consider the following when restoring domain controllers. The target servers must be isolated from the environment in such a way that they cannot name-resolve the domain that is restored. The process of restoring a domain will fail if the server is able to see that a domain of that name already exists. Typically, DNS in the target environment used for forest recovery should be configured in a way that allows each server in that environment to see each other. The target server must be a base installation of the Windows Server operating system (OS). The target server OS version should be the same version as the source domain controllers from which the backups were created. For example, a backup from a Windows Server 2022 domain controller would need to be restored to a Windows Server 2022 target server. While restoring a domain controller, things such as the ADDS role and configuration are done with the product, so there is no requirement to have those in place. When the Target Server is a Virtual Machine Following are some considerations when the target server is a virtual machine. Memory and storage configuration for the virtual machine should match the hardware configuration of the domain controller where the backup was performed. The virtual machine should be in an isolated environment (i.e., should not be able to contact the source forest or domains). Table 1: Communic ation Direction Protocol Ports Description Domain Controller to Application Server TCP 9001 Outbound Communication Application Server to Domain Controller TCP 9001 Inbound Communication v2.6 The virtual machines should allow File and Print Sharing through the firewall as well as Remote Management, if possible. Network Bandwidth Requirement for the Restore Operation Network bandwidth should be as fast as available but can operate efficiently with 100 Mbps. Slower bandwidth will result in a longer setup stage for the restore as the backup container has to be copied to the target server. Firewall Rules for Forest Server Backups The following firewall settings are required for communicating with Recovery for Active Directory and the domain controller when executing a domain controller backup. The fire wall rules must be configured on both the domain controller and the application server. Communic ation Protocol Ports Description Direction Domain Controller to TCP 9001 Outbound Communication Application Server Application Server to TCP 9001 Inbound Communication Domain Controller NOTE: 9001 is the default port. If a different port is specified on the Netwrix Recovery Server Configuration page of the Recovery for Active Directory Setup wizard while installing the application, then that specific port is applicable here. v2.6 Installation Recovery for Active Directory consists of the following components: Netwrix Recovery Server Netwrix Recovery Web Console – Installed on the Recovery Application Server and used to perform the operations the application offers RSAT Extension – Installed on the Recovery Application Server automatically. You can manually install it on a remote machine to add the object rollback and restore functions to the Active Directory Users and Computers console on that machine. Recovery Configuration Utility – Installed on the Recovery Application Server and used to register the RSAT Extension on the server. It also provides the option to update the SQL database password. The following services are also installed on the Recovery Application Server: Netwrix Recovery Server service Netwrix Recovery Web Console service To install the application, see the following topics: Install the Application Configuration Utility Install the RSAT Extension Prior to installing, ensure that all prerequisites have been met, as described in the Requirements topic. Licensing Recovery for Active Directory comes with a temporary 7-day license. Please contact the Netwrix sales representative for a license. See the Licensing Page topic to license the product. v2.6 Software Download Current customers can log in to the Netwrix Customer Portal to download software binaries and license keys for purchased products. See the Customer Portal Access topic for information on how to register for a Customer Portal account. Install the Application The following components are installed by the Recovery for Active Directory installation package: Netwrix Recovery Server Netwrix Recovery Web Console – Installed on the Recovery Application Server and used to perform the operations the application offers RSAT Extension – Installed on the Recovery Application Server automatically. You can manually install it on a remote machine to add the object rollback and restore functions to the Active Directory Users and Computers console on that machine. Recovery Configuration Utility – Installed on the Recovery Application Server and used to register the RSAT Extension on the server. It also provides the option to update the SQL database password. During a fresh installation, it is possible to modify both or either the application installation directory and the SQL Server database location. The application installation directory can be modified through the Destination Folder page in the Recovery for Active Directory Setup Wizard. NOTE: The msoledbsql.msi must be installed on the machine the Recovery Application Server will be installed on, prior to installing the Recovery Application Server. This allows the Recovery Application Server to connect with the SQL Server. If it is not installed, the installer fails on the SQL Server Configuration page. The Microsoft OLE DB Driver for SQL Server can be downloaded directly from Microsoft. Follow the steps to install Recovery for Active Directory. Step 1 – Run the NetwrixRecovery_Setup.exe executable as an administrator to launch the Recovery for Active Directory Setup wizard. v2.6 Step 2 – On the Netwrix Recovery for Active Directory page, read the End User License Agreement. Then check the I agree to the license terms and conditions checkbox and click Install. The Setup Progress page displays the setup progress bar and then the Welcome page is displayed. v2.6 Step 3 – On the Welcome page of the Recovery for Active Directory Setup wizard, click Next to begin the installation. v2.6 Step 4 – On the Destination Folder page, confirm the destination path where the wizard will install Recovery for Active Directory. The default installation location is: C:\Program Files\Netwrix\Recovery for Active Directory\ (Optional) Click Change… to change the installation location. The Change destination folder page opens. v2.6 Use the Look in field to select the desired installation folder. When the Folder name box is set as desired, click OK. The wizard returns to the Destination Folder page. Click Next to continue. v2.6 Step 5 – On the License File page, select the licensing option for your installation. Trial license – Use the 14-day license key that comes packaged with the Recovery for Active Directory installation License file – Map to a customer license key file by clicking Browse and selecting the license file with the name ending in .key Click Next. v2.6 Step 6 – On the SQL Server Configuration page, specify the SQL server and credentials to use for database communication. SQL Server – Enter the SQL Server fully-qualified DNS location name or IP address of the SQL Server machine. Choose between Windows Authentication or SQL Server Authentication credentials. If SQL Server Authentication is selected, provide the login credentials for the provisioned account. Ensure that this account has access to read and write to the tables with permissions to execute stored procedures. NOTE: Windows authentication will use the credentials of the account running the installer. Once the database is created, Windows authentication will use the credentials of the account used for the Recovery for Active Directory service., specified on the Netwrix Recovery Server Configuration page of the wizard. Click Next. v2.6 Step 7 – On the SQL Server Database page, specify the SQL Server database to use. Use the default database name or provide a unique, descriptive name in the box. Click Next to continue. v2.6 Step 8 – On the Netwrix Recovery Server Configuration page, enter the port and credentials to be used for running the application server. Port – The default port number for the Netwrix Recovery server is 9001. This port is used to communicate from the Netwrix Recovery server and the domain. Modify the port, if needed. Service Account – Enter the service account [DOMAIN\USERNAME] and password credentials used to start and run the Recovery Console service. Ensure that this service account has the Log On As A Service right in the Local Security Policies on the server where the console is installed. Click Next. v2.6 Step 9 – On the Administrator Role page, specify the administrator account to use. By default, this is set to the Domain Admins account from the domain the product is being installed into. Account – Enter a user account or group [DOMAIN\ACCOUNT] that will be the default Recovery for Active Directory administrator. Use the Browse option to search for a s pecific account. This account will be locked and cannot be modified after installation. The specified user or group will be responsible for configuring the applcation and managing users' access to the console. Click Next. v2.6 Step 10 – On the Web Host page, specify the web host configuration for the Recovery for Active Directory Console. Port – Use the default port number or provide a unique one. Use HTTPS – To enable HTTPS encryption, select the Use HTTPS checkbox. This displays the Certificate section on the page. Click Select certificate.... The Certificates window is displayed. v2.6 The Certificates window displays installed certificates on either the local machine or the current user. Select the desired certificate and click Use Selected Certificate. This automatically fills in the information for the Certificate section of the Web Host page. Click Next. Recovery for Active Directory is ready to install. v2.6 Step 11 – Click Install to begin the installation process. v2.6 Step 12 – The installation process begins and the Setup wizard displays the installation progress. Depending on the Active Directory size, installation may take time to complete. When installation is complete, click Finish to exit the wizard. The installer does not automatically open the Recovery Console web page after installation. The Recovery Console icon is located on the desktop. See the First Launch topic for the next step. Configuration Utility On installing Recovery for Active Directory, the Recovery Configuration Utility is installed on the same server. This utility is used to register the RSAT Extension on the Recovery Application Server. To launch the Recovery Configuration Utility, double-click the Recovery_Config.exe executable at the following location in the Recovery for Active Directory installation directory: ...Netwrix\Recovery for Active Directory\Recovery_Config.exe v2.6 The Recovery Configuration Utility window has options to: Register/unregister the RSAT Extension on the Recovery Application Server Update the Recovery for Active Directory database information View product licensing information Register/Unregister the RSAT Extension The RSAT Extension is an MMC snap-in that can be installed on domain joined machines. It extends the Active Directory Users and Computers (ADUC) console with Recovery for Active Directory specific right-click options for object rollback and recovery. Included in this extension is a Recycle Bin for restoring deleted objects. Consider the following: The RSAT Extension is automatically installed with the Recovery for Active Directory installation package on the Recovery Application Server. The local Extension must be registered on the server to enable the rollback and restore options in ADUC. The Extension can be manually installed on a remote server where ADUC is installed. The Extension connects to the Recovery Application Server using the server name or IP address you provide while installing the Extension on the remote machine. See the Install the RSAT Extension topic for additional information. v2.6 Register the RSAT Extension You must register the RSAT Extension on the Recovery Application Server to add the Rollback and Restore options to the ADUC console. Follow the steps to register the RSAT Extension. Step 1 – On the Recovery Configuration Utility window, click the Register button to register the RSAT Extension. On registration, the following message is displayed and the button changes to Unregister. Step 2 – Click OK. Unregister the RSAT Extension Unregistering the RSAT Extension will remove the Rollback and Restore options from the Active Directory Users and Computers console. Follow the steps to unregister the RSAT Extension. Step 1 – On the Recovery Configuration Utility window, click the Unregister button to unregister the RSAT Extension. The following message is displayed and the button changes to Register. v2.6 Step 2 – Click OK. View SQL Configurations The Recovery Configuration Utility window displays the following information for SQL configuration: SQL Server – The fully-qualified DNS location name or IP address of the SQL Server machine that hosts the Recovery for Active Directory database Database – The name of the Recovery for Active Directory database on the server Authentication – Choose between Windows Authentication or SQL Server Authentication credentials. If SQL Server Authentication is selected, provide the login credentials for the provisioned account in the Login and Password fields. Test – Click the Test button to verify the authentication connection Save – After making any changes, click the Save button to save the configuration To update the password for the SQL server service account, see the Update SQL Server Service Account Password topic. View License Information On the Recovery Configuration Utility window, click the License Information button to open the License Information window that displays the validity of the Recovery for Active Directory license, its type, and expiration date. First Launch To launch the Recovery Console, either: Click the desktop icon Type http:/localhost:3005 in a web browser and press Enter v2.6 First Login On the first login to the Recovery Console, use the credentials configured on the Administrator Role page during installation. This account has the Administrator role needed to manage the application. If a group is used, any account with membership to this group can login. Follow the steps to login to Recovery for Active Directory. Step 1 – Launch the Recovery Console. The Log in page is displayed. Step 2 – Log in with credentials configured on the Administrator Role page of the Recovery for Active Directory Setup wizard during installation. See the Install the Application topic for additional information on the administrator role. The username must be entered in the following format: Domain\Username v2.6 Step 3 – Click Log in. Once logged in, the first step is to configure a domain. See the Domain Backup Configura tion Page topic for additional information. The administrator must also add users who can access the application. Once these users have access, see the Log into the Recovery Console topic for information on accessing and signing into the Recovery Console. Log into the Recovery Console When Recovery for Active Directory is installed, the following icon is displayed on the desktop. Access the Recovery Console Locally Administrator and non-administrator users can access the Recovery Console on the Recovery for Active Directory server using either of the following methods: Click the desktop icon Type http:/localhost:3005 in a web browser and press Enter NOTE: If the port number and web protocol was changed from default during the installation process, use the port and protocol configured from the install. Access the Recovery Console Remotely To access the Recovery Console remotely, open a web browser. Enter the host name or IP address of the Recovery for Active Directory application server followed by web port number into the address bar. For example: http://[ServerName]:3005 v2.6 NOTE: If the port number and web protocol was changed from default during the installation process, use the port and protocol configured from the install. Sign In On First Launch of the Recovery Console, the administrator must add users who can sign into the application and use it. Follow the steps to sign into the Recovery Console. Step 1 – Launch the Recovery Console. NOTE: The URL may need to be added to the browser's list of trusted sites. Step 2 – Enter your credentials in the Username and Password fields. The username must be in the following format: v2.6 Domain\Username Step 3 – Click Log in. If you have enabled multi-factor authentication for your account, the following is displayed: Step 4 – Launch the Authenticator app on your phone to get the verification code generated for the Recovery application account. Step 5 – Enter the code in the Authentication code field and click Verify. The Recovery Console opens. Install the RSAT Extension The RSAT Extension is installed automatically on the machine where the Recovery Application Server and web console are installed. To use the RSAT Extension on a remote machine where Active Directory Users and Computers (ADUC) is installed, you have to manually install it using the RSAT installer. The installer is located in the following installation directory on the Recovery Application Server: ...Netwrix\Recovery for Active Directory\RSAT Extension\NetwrixRecovery_RSAT_Extension.msi Follow the steps to install the RSAT Extension. Step 1 – Copy the NetwrixRecovery_RSAT_Extension.msi file to the machine where you want to install it. v2.6 Step 2 – Run NetwrixRecovery_RSAT_Extension.msi . The RSAT Extension Setup wizard opens. Step 3 – On the Welcome page, click Next. v2.6 Step 4 – On the End-User License Agreement page, read the End User License Agreement and check the I accept the terms in the License Agreement box. Click Next. v2.6 Step 5 – On the Destination Folder page, specify the file path to install the RSAT Extension. The default path is: C:\Program Files\Netwrix\Recovery for Active Directory RSAT Extension\ Optionally, you can change the installation directory location for the RSAT Extension. Click Change to open the Change destination folder page. v2.6 Use the Look in field to select the desired installation folder. When the Folder name box is set as desired, click OK. The wizard returns to the Destination Folder page. Click Next to proceed. v2.6 Step 6 – In the Server name field, enter the name or IP address of the Recovery Application Server, so the RSAT Extension identifies it in the environment. NOTE: 9001 is the default port. If a different port is specified on the Netwrix Recovery Server Configuration page of the Recovery for Active Directory Setup wizard while installing the application, then that specific port is applicable here. Click Next. v2.6 Step 7 – Click Install to begin the installation process. v2.6 Step 8 – The installation process begins and the Setup Wizard displays the Setup Progress. When installation is complete, click Finish to exit the wizard. After installation has completed, open a new instance of ADUC and verify that the RSAT Extension has been successfully installed. Right-click on an object and ensure the Rollback option has been added to the right-click menu. Also, a Recycle Bin node should be added to the root tree view. Upgrade Procedure This topic describes the steps needed to upgrade Netwrix Recovery for Active Directory from v2.5 to v2.6. v2.6 v2.5 v2.6 Run the NetwrixRecovery_Setup.exe on the Netwrix Recovery for Active Directory server to upgrade to the newer version of the product. See the Install the Application topic for additional information. NOTE: The database does not change between versions, so the same can be used for the new version. Do not uninstall or remove the existing database. v2.5 has now been upgraded to v2.6. v2.6 Administration Netwrix Recovery for Active Directory enables administrators to manage Active Directory in the following ways: Perform Object-level Rollback and Recovery ◦◦ Add Domains – Add an Active Directory domain and configure a backup schedule for it ◦◦ Rollback Objects – Quickly revert entire AD objects or just a single attribute to a known good state from a backup ◦◦ Recover Objects – Restore tombstone objects to active state using the backup data. Recover object attributes, group membership, DNS entries, Group Policy objects (GPOs) and more, thus overcoming key limitations of the Recycle Bin. Perform Forest Backup and Recovery ◦◦ Add Forests – Add a forest and then configure a backup schedule for each of the domain controllers in it ◦◦ Recover a Forest – In the event of a disaster scenario (ransomware, complete hardware failure, etc.), leverage the backups with the automation capabilities in the product to restore the forest back to its fully functional state prior to the disaster View Audit Log – Track the actions performed by users in Recovery for Active Directory Integrate with Netwrix products – Fetch specific data from other Netwrix products, such as Threat Prevention, to display in Recovery for Active Directory DNS Records DNS records must be stored in Active Directory in order to backup, restore, and view DNS objects in Recovery for Active Directory. See the Microsoft Change the Zone Type article for additional information. Navigate the Console In the Recovery Console, navigation options are displayed in the: Application header Left navigation pane v2.6 Application Header The application header contains the following icons in the top right corner: Help Center – Click the ? icon to open the Netwrix Technical Knowledge Center for the Recovery for Active Directory documentation User Profile – On clicking the profile icon, the following options are displayed: ◦◦ Manage – Click it to open the MFA page, where you can set up multi-factor authentication for your Recovery for Active Directory account. See the Configure Multi-Factor Authentication topic for additional information. ◦◦ Log out – Click it to sign out of the Recovery Console Navigation Pane The navigation pane contains the following links: Active Directory Page – The Active Directory page lists the domains configured in Recovery for Active Directory. You can perform object rollback and recovery operations on this page. Forest Page – The Forest page displays your Active Directory forest with its domains and domain controllers. Administrators can set up backup configurations for domain controllers as well as recover the forest from those backups. Audit Logs Page – The Audit Logs page provides an audit trail of the actions performed by users in Recovery for Active Directory. v2.6 Configuration Interface – The Configuration interface provides access to configure the domains, users and roles, notifications, integrations, data retention policy, and licensing for Recovery for Active Directory. NOTE: Only users with Administrator rights have access to the Configuration interface. ◦◦ Domains Page – The Domains page provides a list of the domains backed up by Recovery for Active Directory. It displays the backup schedule settings for each added domain. You can also add and configure new domains. ◦◦ Users and Roles Page – The Users and Roles page displays the accounts with access to Recovery for Active Directory. ◦◦ Notifications Page – The Notifications page allows the configuration of n otifications, which is required for sending an email when a collection (backup) job is completed. ◦◦ Netwrix Integrations Page – The Netwrix Integrations page provides the ability to configure access to the data in other Netwrix products. At present, only Netwrix Threat Prevention is supported. ◦◦ Data Retention Policy Page – The Data Retention Policy page provides settings for deleting backup data that of domains and domain controllers has aged by X number of days, and for deleting backup data for tombstone objects that have been purged. ◦◦ Licensing Page – The Licensing page provides an overview of the organization's license status and the ability to import a license file. Configure Multi-Factor Authentication You can configure multi-factor authentication (MFA) for your Recovery for Active Directory account to add an additional layer of security when signing into the application. NOTE: At present, only authenticator apps are supported for MFA. As a prerequisite to enabling MFA, install an authenticator app, such as Google Authenticator or Microsoft Authenticator, on your phone. Enable Authenticator for MFA Follow the steps to enable the authenticator option for MFA. v2.6 Step 1 – In the Recovery Console, click your profile icon in the top right corner of the page and select Manage. The MFA page opens. Step 2 – Click the Add authenticator app button. The Configure authenticator app page is displayed, showing the instructions for setting up the app. v2.6 Step 3 – Open the authenticator app on your phone and scan the QR code with it. A new account is created in the app for the Recovery application and a verification code is displayed under the account name. Step 4 – Enter this code in the Verification Code field on the Configure authenticator app page and click Verify. A confirmation message is displayed on success. The authenticator app generates a new code every 30 seconds, with each code expiring after 30 seconds. Step 5 – Click Close. MFA has been enabled for your account. Now you must authenticate your account using the Authenticator app every time you sign into Recovery for Active Directory. See the Sign In topic for additional information. v2.6 Disable Authenticator for MFA Follow the steps to disable MFA for your Recovery for Active Directory account. Step 1 – In the Recovery Console, click your profile icon in the top right corner of the page and select Manage. The MFA page opens. Step 2 – Click Disable 2FA. A confirmation message is displayed. Click Disable 2FA to disable multi-factor authentication or Cancel to leave it enabled. On disabling MFA, the page displays a confirmation message and there is an option to enable it again. Domain Backup Configuration Page When you sign into the Recovery Console for the first time, the Domain Backup Configura tion interface is displayed. v2.6 You must add a domain and it's backup configurations before you can start using the product. Once this is configured, the Domain Backup Configuration interface is not displayed again. Click the here link to launch the Add Domain Configuration wizard. Then follow the steps in the Domains Page topic to add a domain and its backup configurations. Active Directory Page On the Active Directory page, you can access all the domains that you have configured through the Domains Page. Click Active Directory in the left pane to open the Active Directory page. v2.6 Select a domain from the drop-down menu and expand it to view the domain tree and container structure, which is exactly the same as you get in Active Directory Users and Computers. Objects in the domain are also available in the same hierarchical structure. The page displays the following information: Name – The display name of the object Distinguished Name – The unique name identifying the object in the directory Description – A description of the object Type – The object type, showing whether it is a container, organizational unit, computer, group, user, etc. Backup Time – The date and time of the last the backup You can perform the rollback and recover operations for objects. v2.6 Search for an Object There are several ways to find an object: Column Filters – Click a column header to organize the table alphabetically by the column header. An arrow appears by the column name. Use it to arrange the entries by ascending or descending order. Search box – Enter a text string in the search box to filter the table for results that contain the text. Rollback an Object Select and expand a domain in the left pane and locate the object you want to rollback. Rightclick this object and select Rollback on the menu. See the Rollback Objects topic for additional information. Recover Deleted Objects On expanding a domain in the left pane, you will notice that Recycle Bin is in blue, indicating that this is a virtual container specific to Recovery for Active Directory. Use the Recycle Bin to recover deleted objects in Active Directory. See the Recover Objects topic for additional information. Integration with Threat Prevention When you right-click an object in a domain on the Active Directory page, the right-click menu is displayed as: The Show audit history and Show activity options are enabled only when both the following conditions are met: Threat Prevention data is tied with Recovery for Active Directory data v2.6 The user is logged in with an account that is specified in the Account section of the Netwrix Integrations Page These options display data from Threat Prevention. View the Audit History for an Object You can view the changes made to an object by other users. On the Active Directory page, select and expand a domain in the left pane and locate the object you want to view the audit history for. Right-click this object and select Show audit history on the menu. The Audit History window is displayed. The following information is displayed for every action performed on the object: Who – The user who performed the action What – The action performed Success – Shows whether the action was successfully performed; True indicates success and False indicates failure v2.6 Where – The object the action was performed on When – The date and time of the action To view the details of an action, click the plus sign in the respective row to expand it. Information includes the object attribute that was affected, the type of change made, and the old and new values. View the Activity Perpetrated by an Object You can view the activity performed by an object in the environment. On the Active Directory page, select and expand a domain in the left pane and locate the object whose activity you want to view. Right-click this object and select Show activity on the menu. The Audit Activity window is displayed. The following information is displayed for the actions performed by the object: What – The action performed v2.6 Success – Shows whether the action was successfully performed; True indicates success and False indicates failure Where – The object the action was performed on When – The date and time of the action To view the details of an action, click the plus sign in the respective row to expand it. Information includes the object attribute that was affected, the type of change made, and the old and new values. NOTE: For objects in the Recycle Bin, the Show activity option is not available. Rollback Objects You can revert an Active Directory object to its previous state. Follow the steps to roll back an Active Directory object, including user accounts, groups, and organizational units. Step 1 – Click Active Directory in the left pane to open the Active Directory Page. Step 2 – Select and expand a domain in the left pane and locate the object you want to rollback. Step 3 – Do one of the following: Select the object to rollback and click the Rollback button. Right-click the object and select Rollback on the shortcut menu. The Object Rollback wizard opens. v2.6 Step 4 – In the Backup Date section, select a backup to use for the rollback operation. Then select the checkbox(es) for the attributes you want to roll back. Click Next. v2.6 Step 5 – Select a domain controller where the rollback changes will get affected. Options are: Use any writable domain controller – The system picks any writable domain controller in the domain for the rollback operation Use a specific domain controller – Select a domain controller from the drop-down menu for the rollback operation Step 6 – Click Next. v2.6 Step 7 – The account preforming the operation must have Domain Admin privileges to access the domain tree area where the object resides. On the Credentials page: If the account specified during domain configuration has Domain Admin privileges, click Next. If the domain account does not have Domain Admin privileges, select the Use alternate credentials to perform the object rollback checkbox and enter an account with Domain Admin privileges, then click Next. For a Least Privilege Access Model to provision an Active Directory security group with the permissions that are necessary to perform backups, rollbacks and recovery, see the Least Privilege Access Model topic. v2.6 Step 8 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. Step 9 – A completed message is displayed when the rollback is successful. Click OK. The object has been rolled back. v2.6 Recover Objects The Recycle Bin enables you to view the objects deleted in domains monitored by Recovery for Active Directory. You can recover these deleted Active Directory objects from the Recycle Bin. Click Active Directory in the left pane to open the Active Directory Page. Select and expand a domain in the left pane and click Recycle Bin to get a list of deleted objects in the domain. You can recover deleted objects. The page displays the following information: Name – The display name of the object Distinguished Name – The unique name identifying the object in the directory Last Known Parent – The path of the parent of the object Type – The object type, showing whether it is a container, organizational unit, computer, group, user, etc. Deleted On – The time and date when the object was deleted Time Left – The time remaining until the object is no longer recoverable v2.6 Search for an Object There are several ways to find an object: Column Filters – Click a column header to organize the table alphabetically by the column header. An arrow appears by the column name. Use it to arrange the entries by ascending or descending order. Search box – Enter a text string in the search box to filter the table for results that contain the text. Recover an Object Follow the steps to recover a deleted object. Step 1 – Click Active Directory in the left pane to open the Active Directory Page. Step 2 – Select and expand a domain in the left pane and click Recycle Bin. Step 3 – Do one of the following Select the object to restore and click the Restore button. Right-click the object and select Restore on the shortcut menu. The Object Restore wizard opens. v2.6 Step 4 – In the Backup Data section, select a backup date to restore from. Then click Next. v2.6 Step 5 – Select a domain controller where the restore operation will get affected. Options are: Use any writable domain controller – The system picks any writable domain controller in the domain for the restore operation Use a specific domain controller – Select a domain controller from the drop-down menu for the restore operation Step 6 – Click Next. v2.6 Step 7 – On the Recovery Options page, select the Container and Naming Conflict actions for the recovery process. Container – When a container is deleted in Active Directory, all child objects are also deleted. Select a container restore option from the drop-down menu: ◦◦ Only restore the container object – Restores the container object but no children ◦◦ Restore the container object and the immediate children – Restores the container object and its immediate children ◦◦ Restore the entire sub-tree – Restores the container object and all children NOTE: Selecting the Restore the container object and the immediate children or the Restore the entire sub-tree option enables the User Options page. Naming Conflict – A naming conflict can occur if an object was created post-deletion that has identical values to the original object. From the drop-down menu, select an option to implement if a naming conflict occurs: v2.6 ◦◦ Skip the object – If there is a conflict with naming, do not restore and skip the object ◦◦ Automatically use alternative values – If there is a conflict with naming, a numeric value will be appended to the name of the object being restored to create a unique name Step 8 – Click Next. Step 9 – The User Options page is displayed when user objects are being restored. When a user object is included as a child object being restored, this page is also displayed. Select the check boxes to configure the necessary options for the user. Enable user – Enables the user in Active Directory Clear 'User must change password' flag upon restoration – Restored users do not receive an alert to change their password upon first login after a recovery. Instead, their old password prior to deletion is still active. Set new password – Implement a new password upon recovery. Type the new password in the text box. v2.6 Remember, when a new password is created, the user needs it to login the first time. The password should be copied and given to the restored user. Step 10 – Click Next. Step 11 – The account preforming the operation must have Domain Admin privileges to access the domain tree area where the object resides. On the Credentials page: If the account specified during domain configuration has Domain Admin privileges, click Next. If the domain account does not have Domain Admin privileges, select the Use alternate credentials to perform the object restore checkbox and enter an account with Domain Admin privileges, then click Next. For a Least Privilege Access Model to provision an Active Directory security group with the permissions that are necessary to perform backups, rollbacks and recovery, see the Least Privilege Access Model topic. v2.6 Step 12 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. Step 13 – A completed message is displayed when the restore is successful. Click OK.d The deleted object has now been restored. v2.6 Forest Page The Forest page allows administrators to: Add forests Configure and manage backups for domain controllers in a forest. Carry out a forest recovery Once a forest is added, you can view the domain controllers in the forest, whether backups are enabled for the domain controllers, and the last backup time. You can also view the forest tree, which represents the structure of the forest and its domains. Click Forest in the left pane to open the Forest page. When no forest has been added, the Forest Configuration page is displayed. You must add a forest first. See the Add a Forest topic for additional information. Once a forest is added, the page is displayed as follows: v2.6 The domains in the configured forests are shown in a hierarchal tree. The domain controllers for the selected forest are shown in the adjacent pane, with information such as backup status and last backup times. Expand a forest to view the domains under it. On selecting a domain, the domain controllers in the domain are displayed in the adjacent pane. The following information is displayed for a domain controller: Name – Name of the domain controller Operating System – Operating system for the domain controller, for example, Windows Server 2019 Standard Version – Version of the operating system Backup – Use the toggle button to enable or disable the backup for the domain controller. By default, it is disabled. When you enable it, the Server backup Configuration wizard is displayed. See the Add Backup Configurations for a Domain Controller topic to configure backup settings for the domain controller. Last Backup Time – Date and time when the last backup occurred Actions – Displays the following icons: ◦◦ Start Backup – Starts a backup of the server on demand v2.6 ◦◦ Edit Configuration – Launches the Server Backup Configuration wizard, enabling you to modify the backup configurations for the domain controller ◦◦ Add Domain Controller to Restore Playbook – Adds the domain controller to the recovery playbook. See the Create a Recovery Playbook topic for additional information. This is the only action displayed for a domain controller that has not been backed up. Use the Add link to add another forest. Add a Forest You must add a forest in the system to perform backup and recovery operations for it. Follow the steps to add a forest. Step 1 – On the Forest Configuration page, click the here link. Or on the Forest page, click the Add link. The Add Forest window is displayed. Step 2 – In the Domain field, enter the name of the root domain in the forest [example.domain.com]. Step 3 – Enter the account username [DOMAIN\USERNAME] to be used to connect to the forest in the Account field. Ensure that the account has privileges to access the domain. v2.6 Step 4 – Enter the password for the account in the Password field. Step 5 – Click Save. The forest is added and displayed on the Forest page as a blue tab. Click it to view the domain controllers in the forest and configure backup settings for each domain controller. See the Add Backup Configurations for a Domain Controller topic for additional information. You can also expand a forest to view the domains under it. Add Backup Configurations for a Domain Controller When you configure backup settings for a domain controller, the system automatically installs the Netwrix Server Backup Configuration agent on that domain controller. NOTE: Ensure that the domain controller has the firewall rules configured before c onfiguring backup settings for it. See the Firewall Rules for Forest Server Backups topic for additional information. Follow the steps to specify backup settings for a domain controller. Step 1 – On the Forest page, select a forest to view the domain controllers in it. To locate a domain controller in a specific domain, expand the forest in the left pane and select a domain. The adjacent pane displays the domain controllers in that domain. Step 1 – Enable the Backup toggle button for a domain controller to launch the Server Backup Configuration wizard. v2.6 Step 2 – In the Server field, the domain controller to be backed up is displayed as read-only in the following format: server.domain.com. Step 3 – Specify an account to validate the server, install the Netwrix Server Backup Configuration agent there, and perform server backups. This account must have read and write access to a shared network location for storing the backups. (You will specify this network share location on the Options page of this wizard.) In the Account field, enter the username of an account to write the backup data of the domain controller to the network share of the destination server in the following format: domain\account. Enter the password for the account in the Password field. NOTE: The backup data is first stored locally on the server and copied to the storage location using this account. Step 4 – Click Next. v2.6 Step 5 – Select the days of the week in the Run the backup on section to indicate the days when backups will be run. Step 6 – Select a start time (UTC) in the Start the backup at field to begin the backup. The default time is 12:00 AM. Step 7 – Click Next. v2.6 Step 8 – In the Specify where you would like to store the backup data field, enter a path to a network share on the domain controller to store the backup data. NOTE: The path must be a network share. Do not provide the path to a local drive for storing the backup. Doing so will prevent the system from restoring the domain using the playbook mechanism. Step 9 – The file can be encrypted by selecting the Encrypt the generated backup data checkbox and entering a password. Step 10 – By default, backups are compressed. Clear the Compress the generated backup data checkbox to uncompress the generated backup file. Step 11 – Click Next. v2.6 Step 12 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. Step 13 – The Server backup configuration has been saved. Click OK. v2.6 The domain controller will now be backed up according to the configured schedule. A backup can also be initiated on demand from the Recovery Console. Backup Files The backup of a domain controller is stored on a network share in the environment and includes all essential data from the domain controller, ensuring that the entire forest can be restored in the event of a disaster. The backup includes: The Active Directory database (ntds.dit) Log files System hive of the registry The sysvol container Disable Server Backup for a Domain Controller If you do not want a domain controller to be backed up, simply disable the backup for it. Step 1 – On the Forest page, select a forest to view the domain controllers in it. To locate a domain controller in a specific domain, expand the forest in the left pane and select a domain. The adjacent pane displays the domain controllers in that domain. Step 2 – Disable the Backup toggle button for a domain controller to disable its backup. On disabling the backup for a domain controller, all backup configuration saved earlier are lost. However, any older backups are not deleted. To re-enable the backup for a domain controller, you have to perform all steps of the Server Backup Configuration wizard again. Domain Controller Backup History You can view the backup history for a domain controller, which includes information on all previous domain controller backups. v2.6 Follow the steps to view the backup history for a domain controller. Step 1 – On the Forest page, select a forest to view the domain controllers in it. To locate a domain controller in a specific domain, expand the forest in the left pane and select a domain. The adjacent pane displays the domain controllers in that domain. Step 2 – Click the arrow next to the name of a domain controller to expand it. On expanding a domain controller, you can view a list of backups for it. The following information is displayed for each backup: Backup Time – Date and time the backup was created Location – The network share path where the backup file is stored on the domain controller Size – The size of the backup file Status – Progress status of the backup; Queued, Running, or Finished Encrypted – Displays if the backup file is encrypted (True) or not encrypted (False) v2.6 Forest Recovery See the Recover a Forest topic for information on how to recover a forest. Recover a Forest You can recover a forest using the domain controller backups generated by Recovery for Active Directory. A restore playbook, also called a recovery playbook, is used to restore a forest. Once the desired domain controllers have been added to the restore playbook, the forest recovery process can be initiated and the forest will be restored using the automated process provided by Recovery for Active Directory. Use Cases for Restoring Domain Controller Backups Administrators may need to bring a forest backup created by Recovery for Active Directory online in the following scenarios: Stand up a duplicate of a domain controller, for example, stand up a duplicate in a lab environment for testing purposes Restore a server or domain controller to a specific state-in-time image Restore lost or deleted data Prerequisites To perform a forest recovery, the following prerequisites must be in place: Configure backups for one or more domain controllers in each domain in a forest. Next, ensure that backups run as scheduled. You can also force-run a backup. See the Forest Page topic for additional information. v2.6 Recover a Forest Follow the steps to recover a forest. Step 1 – Prepare an isolated environment to restore the forest to. See the Target Server Considerations topic to understand the requirements for a target environment and target servers for restoring domain controllers. Step 2 – Add the desired domain controllers to create a recovery playbook, also called a restore playbook. For example, if you have a forest with one root domain and four child domains, you can add one domain controller from the root domain and one from each of the child domains to the recovery playbook, and restore your forest. Step 3 – When your playbook is complete, use the "Start" command to start the forest recovery process. The following restore capabilities are supported: VM DC backup to VM VM DC backup to Physical Physical DC backup to VM Physical DC backup to Physical DC Create a Recovery Playbook A recovery playbook is a list of domains and domain controllers for those domains that you want to restore to an isolated environment. Ideally it should be a physical environment but a virtual environment can work too. For example, you can choose a Hyper-V or a VMware environment hosted in Azure or AWS, and isolated from the rest of the domain. Once the desired domain controllers have at least one backup to choose from, you can start the forest recovery playbook by adding the domain controllers to it. NOTE: You only need one backup of a domain controller for each domain in the forest. Any other domains can then be added via the playbook or you should handle them manually using the "add DC to the domain, let replication happen" model. Follow the steps to create a recovery playbook. v2.6 Step 1 – Click Forest in the left pane to open the Forest page. Step 2 – On the Forest page, select a forest to view the domain controllers in it. To locate a domain controller in a specific domain, expand the forest in the left pane and select a domain. The adjacent pane displays the domain controllers in that domain. Step 3 – Click the Add Domain Controller to Restore Playbook icon (+) for a domain controller to add it to the recovery playbook. The Add to Recovery Playbook wizard opens, where you can specify the restore settings for the domain controller. Step 4 – On the Domain Controller page, the Source Domain Controller section displays information for the domain controller that is being added to the playbook. It displays the domain it is deployed to, its name, operating system, and the date and time of the most recent backup. In the Target Server section: In the Server field, enter the IP address of the target server where you want to restore the domain controller from the backup. Provide the credentials of an account in the Account and Password fields. This must be an administrator account for the target server. v2.6 See the Target Server and Operating System Requirements topic for additional information. Step 5 – Click Next. Step 6 – From the Backup drop-down menu, select the backup to use for restoring the domain controller. The drop-down menu lists the backups available for the domain controller. NOTE: If you do not choose a backup for a domain controller, an attempt will be made to join the domain controller to the existing domain that was restored previously in the playbook using a backup of another domain controller. Step 7 – If the backup is encrypted, provide the password used for encryption in the Encryption Password field. This would allow the recovery process to decrypt the backup. Step 8 – From the Roles drop-down menu, select the FSMO role(s) the domain controller will acquire when it is restored. You can: Select the Acquire All Roles option to assign all FSMO roles to the domain controller. Select one or more FSMO roles to assign to the domain controller. All five FSMO roles are listed. v2.6 Select Restore original roles to retain the previously assigned roles that are defined in the backup. Select Do not assign any roles if you do not want to assign any role to the domain controller. This option is selected by default, because the first domain controller in your domain automatically acquires all the FSMO roles. Step 9 – In the DSRM Password field, set the Directory Services Restore Mode (DSRM) password for the to-be-restored domain controller. Step 10 – Click Next. Step 11 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. The playbook has been created with the domain controller added to it. Repeat this process for all the domain controllers you wish to restore in the target environment. When you add another domain controller, it appears as a new tab added to the playbook. Click the tab representing a domain controller to view its details. v2.6 The following information is displayed for a domain controller in the playbook: Original Server – The name of the server that you added to the playbook for restore Target Server – The server where the domain should be restored Domain – The domain the domain controller belongs to Operating System – The operating system of the original server (the domain controller to be restored) Version – The operating system of the original server (the domain controller to be restored) Roles – The FSMO role(s) the domain controller will acquire when restored Backup Time – the date and time of the backup that will be restored for the domain controller v2.6 Run the Recovery Playbook When your playbook is ready, click Start to initiate the forest recovery process. The machine will reboot once the recovery process is complete Your new forest is ready for you to log in using any Administrator credentials from the forest. Notice that the Forest page displays the operations performed during the restore process. From here, you can proceed to restore additional domain controllers or promote new ones to the forest. Configuration Interface The Configuration interface provides access to configure the domains, users and roles, notifications, integrations, data retention policy, and licensing for Recovery for Active Directory. NOTE: Only users with Administrator rights have access to the Configuration interface. v2.6 The Configuration interface contains the following pages: Domains Page – The Domains page provides a list of the domains backed up by Recovery for Active Directory. It displays the backup schedule settings for each added domain. You can also add and configure new domains. Users and Roles Page – The Users and Roles page displays the accounts with access to Recovery for Active Directory. Notifications Page – The Notifications page allows the configuration of notifications, which is required for sending an email when a collection (backup) job is completed. Netwrix Integrations Page – The Netwrix Integrations page provides the ability to configure access to the data in other Netwrix products. At present, only Netwrix Threat Prevention is supported. Data Retention Policy Page – The Data Retention Policy page provides settings for deleting backup data that of domains and domain controllers has aged by X number of days, and for deleting backup data for tombstone objects that have been purged. Licensing Page – The Licensing page provides an overview of the organization's license status and the ability to import a license file. Domains Page The Domains page provides a list of the domains backed up by Recovery for Active Directory. It displays the backup schedule settings for each added domain. You can also add and configure new domains. Click Configuration in the left pane. Then click the Domains tab on the Configuration page to open the Domains page. v2.6 The table displays the following information: Domain – Fully-qualified name of the domain Last Collection Time – The most recent time the collection (backup) occurred Duration – The time the collection took to complete Status – Collection state as idle, waiting, error, or success Details – Information about any errors that occurred when the last backup was performed Actions – Displays the icons used to collect, edit, and delete the respective domain ◦◦ Run backup – Click the Play icon to start a new collection (backup) on the respective domain if collection is needed outside of the configured schedule ◦◦ Edit configuration – Edit the settings of the domain. Click the Edit icon for a domain to open the Edit Domain Configuration wizard and edit the domain's settings. See the Edit Domain Configuration topic for additional information. ◦◦ Delete configuration – Click the Delete icon for a domain to delete it To add a domain, click the Add domain configuration button. See the Add a Domain topic for additional information. Add a Domain To add a domain, provide domain details and configure the backup schedule. For a list of the supported Windows Servers, see the Target Domains topic. v2.6 Follow the steps to add a domain. Step 1 – Click the Add domain configuration button on the Domains page to launch the Add Domain Configuration wizard. Step 2 – Enter a domain [example.domain.com] in the Domain field. Step 3 – Enter the account username [DOMAIN\USERNAME] to be used for backups, rollbacks, and recoveries in the Account field. Step 4 – Enter the password for the account in the Password field. NOTE: The account must have Domain Admin privileged access to read and write object data in order to back up, rollback, and restore objects in Active Directory. If the account has read rights only, it will be able to back up the domain but unable to rollback and restore objects. In this case, alternate credentials with read and write access to objects will have to be provided on the Credentials page of the Object Rollback and Object Restore wizards. See the Rollback Objects and Recover an Object topics for information on the wizards. v2.6 For a Least Privilege Access Model to provision an Active Directory security group with the permissions that are necessary to perform backups, rollbacks and recovery, see the Least Privilege Access Model topic. Step 5 – Click Next. Step 6 – Select the days of the week in the Run the backup on section to indicate the days when backups will be run. Step 7 – Select a start time (UTC) in the Start the backup at field to begin the backup. The default time is 12:00 AM. Step 8 – In the Repeat every field, enter a frequency, in minutes, to set the time between the start of each domain backup. Keep in mind the size of the environment when configuring this option. Click Next. NOTE: If the start time is changed from the default and a frequency is selected (in minutes), the backups will run at the desired frequency but will skip from midnight until the selected start time. v2.6 Step 9 – (Optional) Select the Collect GPOs checkbox to enable GPO rollback and recovery. This setting requires Group Policy Management Console (GMPC). If GPO collection is not desired, skip to Step 9. Step 10 – If the Collect GPOs checkbox is selected, the Store the Group Policy Object backups in the following location field is enabled. Specify the save location for the GPO backup here. NOTE: The path must be a network share. Do not provide the path to a local drive for storing the backup. Step 11 – Click Next. v2.6 Step 12 – To set notifications, select the Send email notifications check box and enter the email address of one or more users and/or groups to receive the job start and end notifications. Use a semicolon (;) to separate multiple recipients. See the Notifications Page topic for additional information. If notifications are not desired, skip this step. Step 13 – Click Next. v2.6 Step 14 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. A new domain is added and displayed on the Domains page. Backups will begin as scheduled. On the first scheduled instance, a complete backup of the domain is performed. Then, subsequent backups only include the incremental changes that occurred since the previous backup. Edit Domain Configuration Follow the steps to edit a domain. Step 1 – On the Domains page, click the Edit configuration icon for a domain. The Edit Domain Configuration wizard opens. v2.6 Step 2 – Modify the domain in the Domain field, as needed. Step 3 – Modify the account username [DOMAIN\USERNAME] to be used for backups, rollbacks, and recoveries in the Account field, as needed. Step 4 – Update the password for the account in the Password field, as needed. The new credentials will take effect on next domain backup. Step 5 – Click Next. v2.6 Step 6 – Modify the selection of the check boxes in the Run the backup on section to indicate the days when backups will be run, as needed. Step 7 – Modify the start time (UTC) in the Start the backup at field to begin the backup, as needed. Step 8 – In the Repeat every field, modify the frequency, in minutes, to set the time between the start of each domain backup. Keep in mind the size of the environment when c onfiguring this option. NOTE: If the start time is changed from the default and a frequency is selected (in minutes), the backups will run at the desired frequency but will skip from midnight until the selected start time. Step 9 – Click Next. v2.6 Step 10 – (Optional) Select or deselect the Collect GPOs checkbox to enable or disable GPO rollback and recovery. This setting requires Group Policy Management Console (GMPC). If GPO collection is not desired, skip to Step 12. Step 11 – If the Collect GPOs checkbox is selected, the Store the Group Policy Object backups in the following location field is enabled. Modify the save location for the GPO backup here, as needed. NOTE: The path must be a network share. Do not provide the path to a local drive for storing the backup. Step 12 – Click Next. v2.6 Step 13 – To set notifications, select the Send email notifications check box and enter the email address of one or more users and/or groups to receive the job start and end notifications. Use a semicolon (;) to separate multiple recipients. See the Notifications Page topic for additional information. If notifications are not desired, skip this step. v2.6 Step 14 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. The domain configuration is updated and backups will resume as scheduled. Users and Roles Page The Users and Roles page displays the accounts with access to Recovery for Active Directory. Click Configuration in the left pane. Then click the Users and Roles tab on the Configura tion page to open the Users and Roles page. v2.6 The table displays the following information: Account – Login username displayed in the [DOMAIN\USERNAME] format for Active Directory accounts Type – The type of account, an individual or group account Role – The role assigned to the account. ◦◦ Administrator – This role allows full control of Recovery for Active Directory, including adding domains, configuring notifications, and adding and removing users. It has access to the Configuration node in the left navigation pane of the application. ◦◦ Operator – This role allows access to the Active Directory and Forest nodes, and can perform rollback and recovery tasks for domains and forests through the Recovery Console. Action – Actions that can be performed on user accounts ◦◦ Remove – Click Remove to remove the respective user or group from console access. See the Remove a User or Group topic for additional information. Add a User or Group Follow the steps to add a user or group that can log into the Recovery Console. If a group is added. all its members can log in. Step 1 – Click the Add Account Role button on the Users and Roles page. The Add Account Role wizard opens. v2.6 Step 2 – Enter a user's first or last name, display name, sAMAccountName, or group name in the Search field. As you type, the system will find matches in Active Directory and display the results. Step 3 – Select the desired user and click Next. v2.6 Step 4 – Select the Administrator or Operator role for the account from the Role drop-down menu. Administrator – This role allows full control of Recovery for Active Directory, including adding domains, configuring notifications, and adding and removing users. It has access to the Configuration node in the left navigation pane of the application. Operator – This role allows access to the Active Directory and Forest nodes, and can perform rollback and recovery tasks for domains and forests through the Recovery Console. Step 5 – Click Next. v2.6 Step 6 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. The selected user or group is now added to the table with the specified role. Change the Role Assigned to an Account Follow the steps to change the role assigned to an account. NOTE: This action is only available for manually added accounts and not for the default account. Step 1 – On the Users and Roles page, click the row for an account to make it editable. Step 2 – Then use the drop-down menu in the Role column to select a different role for the account. v2.6 Remove a User or Group Follow the steps below to remove a user's or group's access to the Recovery Console. NOTE: This action is only available for manually added accounts and not for the default account. Step 1 – On the Users and Roles page, locate the user or group for whom to remove access. Step 2 – Click the Remove button to remove that user or group from the table. Step 3 – Click OK to confirm the action. The user's or group's access to Recovery for Active Directory is removed. Notifications Page The Notifications page allows the configuration of notifications, which is required for sending an email when a collection (backup) job is completed. Only a user with the administrator role can configure notifications. Click Configuration in the left pane. Then click the Notification tab on the Configuration page to open the Notification page. v2.6 Follow the steps to configure notifications. Step 1 – Select the Enable check box to configure email notifications. Step 2 – In the SMTP Settings section, configure the SMTP server. If the SMTP server does not require authentication, the Account name and Account password fields can be left blank. SMTP Server – The server and port information Account Name – Name of the account to use for accessing the mail server Account Password – Password for the account Step 3 – Select an encryption protocol to encode the email notifications from the Encryption method drop-down menu. Step 4 – In the Send Email As section, configure the email address and display name to use for sending email notifications. Email address – Create an email address to be used, for example: noreply@companyname.com Display name – Name to be displayed on the email notifications v2.6 Step 5 – Click the Test button to verify the notifications are configured correctly. Step 6 – Click the Save button to save the configurations. Notifications have been configured in the system. NOTE: The recipients of the notification can be added from the Domains page. See the Add a Domain topic for additional information. Netwrix Integrations Page The Netwrix Integrations page provides the ability to configure access to the data in other Netwrix products. At present, only Netwrix Threat Prevention is supported. This enables Recovery for Active Directory to pull object data from the integrated product and tie it with that same object's data in Recovery for Active Directory. Users can then view the audit history and activity data coming from Threat Prevention for objects on the Active Directory Page. Click Configuration in the left pane. Then click the Netwrix Integrations tab on the Configuration page to open the Netwrix Integrations page. Follow the steps to configure access to the data of a Netwrix product. Step 1 – On the Netwrix Integrations page, use the Auditing Product Integration drop-down menu to select a product for integration. The menu displays the supported Netwrix products, namely Netwrix Threat Prevention. Step 2 – In the SQL Server field, enter the IP address or the server name of the SQL server where the Threat Prevention database resides. v2.6 Step 3 – Select the option button for Windows authentication or SQL authentication to set the authentication mode. Windows authentication uses the credentials provided on the Netwrix Recovery Server Configuration page of the Recovery for Active Directory Setup wizard. See the Install the Application topic for additional information. For SQL Server authentication, provide SQL credentials in the Account and Password fields. The account requires Read permissions on the Threat Prevention database. Step 4 – Click Test to test the connection. A message is displayed to indicate if the test succeeded or failed. Step 5 – Recovery for Active Directory users do not have access to audit data in Threat Prevention; hence they cannot view it in Recovery for Active Directory. For this reason, you must specify the account(s) that have access to Threat Prevention. Only the users that log into Recovery for Active Directory with any of the specified accounts will be able to fetch and view audit and activity data from Threat Prevention for domain objects. Click the Add account access button to add an account. The Add Account Access wizard is displayed. v2.6 Enter a user's first or last name, display name, sAMAccountName, or group name in the Search field. As you type, the system will find matches in Active Directory and display the results. Select the desired user and click Next. The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. The added account is displayed under Account on the Netwrix Integrations page. See the Integration with Threat Prevention topic for additional information. Step 6 – Click Save. Integration settings with a Netwrix product are now configured. Data Retention Policy Page The Data Retention Policy page provides settings for deleting backup data that of domains and domain controllers has aged by X number of days, and for deleting backup data for tombstone objects that have been purged. v2.6 Click Configuration in the left pane. Then click the Data Retention Policy tab on the Configuration page to open the Data Retention Policy page. Follow the steps to specify a data retention policy. Step 1 – On the Data Retention Policy page, select the Enable data retention policy checkbox to enable policy settings. Step 2 – Select the Delete object backup data older than X days checkbox to delete backup data that is older than X number of days from the database. You can specify any number of days; default is 60 days. Step 3 – Select the Delete backup data for objects that have been purged from the deleted objects container checkbox to delete data from the database for tombstone objects that have been purged. NOTE: The 'deleted objects container' is represented by the Recycle Bin in Recovery for Active Directory. When an object is deleted in Active Directory, it has tombstone as its state. The object is not physically deleted but is stripped off most of its attributes and is flagged as deleted. The object remains in tombstone state for 180 days by default, after which it is permanently deleted from Active Directory. Selecting the Delete backup data for objects that have been purged from the deleted objects container checkbox deletes data for permanently deleted objects from Recovery for Active Directory. RECOMMENDED: As permanently deleted objects cannot be rolled back or recovered using Recovery for Active Directory, it is recommended to enable this setting. Step 4 – Click Save. A data retention policy has been defined in the system. v2.6 Licensing Page The Licensing page provides an overview of the organization's license status and the ability to import a license file. Click Configuration in the left pane. Then click the Licensing tab on the Configuration page to open the Licensing page. You can view whether the license is valid and when it will expire. Import a License Key Recovery for Active Directory comes with a temporary 14-day trial license. Follow the steps to import a license key file to continue using the product. NOTE: Only accounts with administrator role can add a license key. Step 1 – Contact your Netwrix Sales Representative to obtain a license key. Step 2 – On the Licensing page, click the Select license file... button to open the file explorer. Step 3 – Locate the license key file for Recovery for Active Directory in the file explorer and click Open. The file explorer closes and you return to the console. The license key has been successfully imported. The organization’s license information is displayed on the Licensing page. v2.6 Audit Logs Page The Audit Logs page provides an audit trail of the actions performed by users in Recovery for Active Directory. Click Audit Logs in the left pane to open the Audit Logs page. The following information is displayed for an event: Action – The action perpetrated by the account Object – The name of the object affected by the change Account – The account that made the change Event Time – The time the action was perpetrated To view the details of an event, click the arrow next to it to expand it. v2.6 v2.6 RSAT Extension The RSAT Extension is an MMC snap-in that can be installed on domain joined machines. It extends the Active Directory Users and Computers (ADUC) console with Recovery for Active Directory specific right-click options for object rollback and recovery. Included in this extension is a Recycle Bin for restoring deleted objects. Consider the following: The RSAT Extension is automatically installed with the Recovery for Active Directory installation package on the Recovery Application Server. The local Extension must be registered on the server to enable the rollback and restore options in ADUC. The Extension can be manually installed on a remote server where ADUC is installed. The Extension connects to the Recovery Application Server using the server name or IP address you provide while installing the Extension on the remote machine. See the Install the RSAT Extension topic for additional information. You must register the RSAT Extension on the Recovery Application Server to add the Rollback and Restore options to the ADUC console. Object Rollback The Rollback feature in the Active Directory Users and Computers (ADUC) console allows you to revert an Active Directory object to a previous state of a Recovery for Active Directory backup. Prerequisites The following prerequisites must be met before you can rollback or recover an object using ADUC: You must register the RSAT Extension on the Recovery Application Server to add the Rollback and Restore options to the ADUC console. See the Register/Unregister the RSAT Extension topic for additional information. At least one backup of the domain must be available in the Recovery for Active Directory Console. See the Domains Page topic for additional information. v2.6 Rollback an Object Using ADUC Follow the steps to roll back an Active Directory object, including user accounts, groups, and organizational units. NOTE: Repeat these steps as needed after a multi-select for rolling back multiple objects. Step 1 – Open ADUC and select one or more objects to rollback. Right-click on the object(s) and select Rollback on the menu. The Object Rollback wizard opens. v2.6 Step 2 – On the Object Backups page, select a backup date and then select the object and attribute(s) to rollback. This page consists of two sections: Objects – Lists the objects selected for rollback Backups – Lists the backup(s) with their respective details ◦◦ Backup Date – Select the desired date timestamp to identify the backup for rollback. Multiple backups may be available for a single day depending on the configure d schedule. ◦◦ Attribute List – Select the attribute(s) to rollback. The table displays the current value and backup value. Attributes where these two values are different are highlighted in blue. ◦◦ Only show attributes that have changed – Select this option to display only blue highlighted attributes that were changed when the selected backup was performed v2.6 You can click on different backup dates to see attribute values for each of those points in time. However, only one backup date can be selected in order to select attributes for rollback. Click Next. Step 3 – On the Domain Controller page, select the Domain Controller to run the rollback action. This page consists of two sections: Domain Controller ◦◦ Use the current domain controller ◦◦ Use any writable domain controller ◦◦ Use the selected domain controller – Select a domain controller from the drop-down menu v2.6 Details – Provides information about the selected domain controller Click Next. Step 4 – The account preforming the operation must have Domain Admin privileges to access the domain tree area where the object resides. On the Alternate Credentials page: If the account specified during domain configuration has Domain Admin privileges, click Next. If the domain account does not have Domain Admin privileges, select the Use alternate credentials for the rollback operation checkbox and enter an account with Domain Admin privileges, then click Next. For a Least Privilege Access Model to provision an Active Directory security group with the permissions that are necessary to perform backups, rollbacks and recovery, see the Least Privilege Access Model topic. v2.6 Step 5 – On the Confirm page, review the object information, changes, and the domain controller selection. Click Finish to rollback the object. Step 6 – The Rollback window displays the action status. Click Close to exit. v2.6 The ADUC object has been successfully rolled back to a previous state. Restore an Object The Restore feature recovers deleted objects (users, computers, groups, OUs, etc.) from the Recycle Bin in Active Directory Users and Computers (ADUC). Prerequisites The following prerequisites must be met before you can rollback or recover an object using ADUC: You must register the RSAT Extension on the Recovery Application Server to add the Rollback and Restore options to the ADUC console. See the Register/Unregister the RSAT Extension topic for additional information. At least one backup of the domain must be available in the Recovery for Active Directory Console. See the Domains Page topic for additional information. Restore an Object Using ADUC Follow the steps to restore a deleted object. Step 1 – Open ADUC and select the Recycle Bin. v2.6 Step 2 – In the Recycle Bin, right-click on the object to be restored and select Restore on the menu. The Object Recovery wizard opens. v2.6 Step 3 – On the Object Backups page, select the desired date timestamp to identify the backup for recovery. Multiple backups may be available for a single day depending on the configure d schedule. Click Next to continue. v2.6 Step 4 – On the Recovery Options page, select the Container and Naming Conflict actions for the recovery process. Container – When a container is deleted in Active Directory, all child objects are also deleted. Select a container restore option from the drop-down menu: ◦◦ Only restore the container object – Restores the container object but no children ◦◦ Restore the container object and the immediate children – Restores the container object and its immediate children ◦◦ Restore the entire sub-tree – Restores the container object and all children NOTE: Selecting the Restore the container object and the immediate children or the Restore the entire sub-tree option enables the User Options page. v2.6 Naming Conflict – A naming conflict can occur if an object was created post-deletion that has identical values to the original object. From the drop-down menu, select an option to implement if a naming conflict occurs: ◦◦ Skip the object – If there is a conflict with naming, do not restore and skip the object ◦◦ Automatically use alternative values – If there is a conflict with naming, a numeric value will be appended to the name of the object being restored to create a unique name Click Next. Step 5 – The User Options page is displayed when user objects are being restored. When a user object is included as a child object being restored, this page is also displayed. Consider the following configurations in ADUC before choosing the options for deleted user objects: v2.6 Passwords are not persisted – User account is disabled and will have no password, and be disabled after restoration Passwords are persisted – User password is restored and ADUC automatically sets the User must change password at next logon flag Select the desired checkboxes relating to the state of a user password upon restoration: Enable user – Enables the user in Active Directory Clear 'User must change password' flag upon restoration – Restored users do not receive an alert to change their password upon first login after a recovery. Instead, their old password prior to deletion is still active. Set new password – Implement a new password upon recovery. Type the new password in the text box. Remember, when a new password is created, the user needs it to login the first time. The password should be copied and given to the restored user. Click Next. v2.6 Step 6 – On the Domain Controller page, select the Domain Controller to run the restoration action. This page consists of two sections: Domain Controller ◦◦ Use the current domain controller ◦◦ Use any writable domain controller ◦◦ Use the selected domain controller – Select a domain controller from the drop-down menu Details – Provides information about the selected domain controller Click Next. v2.6 Step 7 – The account preforming the operation must have Domain Admin privileges to access the domain tree area where the object resides. On the Alternate Credentials page: If the account specified during domain configuration has Domain Admin privileges, click Next. If the domain account does not have Domain Admin privileges, select the Use alternate credentials for the recovery operation checkbox and enter an account with Domain Admin privileges, then click Next. For a Least Privilege Access Model to provision an Active Directory security group with the permissions that are necessary to perform backups, rollbacks and recovery, see the Least Privilege Access Model topic. v2.6 Step 8 – On the Confirm page, review the summarized object restore settings. Click Finish to start the recovery. Step 9 – The Recovery window displays the action status. Click Close to exit. v2.6 The ADUC object has been successfully recovered from the Recycle Bin. v2.6 Troubleshooting This topic provides steps for troubleshooting common issues for the following Recovery for Active Directory components: RSAT Extension Recovery Diagnostics RSAT Extension Rollback Diagnostics RSAT Extension Registration Diagnostics Recovery Application Server Diagnostics RSAT Extension Recovery The RSAT Extension Recovery Diagnostics flow chart helps diagnose issues when the Recycle Bin is missing or empty in Active Directory Users and Computers (ADUC). v2.6 RSAT Extension Rollback The RSAT Extension Rollback Diagnostics flow chart helps diagnose issues when the rollback right-click menu option is missing in ADUC. RSAT Extension Registration Validation In the Recovery Configuration Utility, the RSAT Extension Register/Unregister button is used to activate the new right-click menu options in ADUC. This is done once per domain. The registration status is displayed as either Registered or Unregistered. Follow the steps to validate the registration status of the RSAT Extension by finding the presence of a specific GUID in ADSI Edit. Step 1 – On the domain joined machine or domain controller, ensure the user is logged in as a Domain Administrator. Step 2 – Open ADSI (Active Directory Services Interfaces Editor) by navigating to C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Administrative Tools. The ADSI Edit window opens. v2.6 Step 3 – If the Configuration naming context does not display automatically, navigate to Action > Connect to... and the Connection Settings window opens. Step 4 – On the Connection Settings window, select Configuration under the Select a well known Naming Context radio button. Click OK. The Connection Settings window closes and the AD Configuration Partition (also called naming context) opens on the left hand pane. Step 5 – Navigate from the AD Configuration Partition folder until CN=DisplaySpecifiers is selected. In this folder, select either CN=409 which is the code for US English or another code for the active locale of the operating system if not using US English. Step 6 – Double-click on the proper locale (such as CN=409). A list is displayed in the middle pane. Right click on any of the Display Specifiers and select Properties from the menu. The Properties window is displayed. Select the adminContextMenu attribute or click Edit to show the Multi-valued String Editor listing known GUIDs. In the list, the RSAT Extension GUID entry is: {50fb3a3c-5700-4232-ae3b-c6d49a6a97ab} NOTE: The adminContextMenu attribute of every object in the active locale (i.e. CN=409 for US English), should have the GUID above. Step 7 – Verify the GUID. If the GUID matches the number above, the RSAT Extension is successfully registered. Recovery Application Server The Recovery Application Server Diagnostics flow chart helps diagnose issues when the Netwrix Recovery Server service is not running. v2.6 Log Files Log files are available at the following locations: On the Recovery for Active Directory server ...\Netwrix\Recovery for Active Directory\Logs ...\Netwrix\Recovery for Active Directory\ModuleEngine.exe.log ...\Netwrix\Recovery for Active Directory\TaskServer.exe.log On the domain controllers for backups ...\Netwrix\Recovery for Active Directory\Logs Update Account Passwords Account passwords occasionally need to be updated due to various reasons, such as security policies that require passwords to be reset on a regular basis. The following types of credentials may be impacted by password changes or security policies: SQL Server Service Account Recovry Service Account v2.6 Domain Controller Backup Service Account SQL Server Service Account The SQL Server service account grants access to the SQL Server database. It can be updated through the Recovery for Active Directory Configuration Utility. See the Update SQL Server Service Account Password topic for additional information. Recovry Service Account The Recovery service account is used to run the Recovery Console service and preform the domain backups. It can be updated on the Domains page in the Recovery Console. See the Edit Domain Configuration topic for additional information. Domain Controller Backup Service Account The backup service account for a domain controller is used to write the backup file of the domain controller to a network share of the destination server. It can be updated on the Forest page in the Recovery Console. See the Update Domain Controller Backup Account Password topic for additional information. Update Domain Controller Backup Account Password While adding backup configurations for a domain controller on the Forest page, an account is provided for performing domain controller backups. You can update the password for this account or even specify a different account. Follow the steps to update the backup account password for a domain controller. Step 1 – Click Forest in the left pane to open the Forest page. v2.6 Step 2 – On the Forest page, select a forest to view the domain controllers in it. To locate a domain controller in a specific domain, expand the forest in the left pane and select a domain. The adjacent pane displays the domain controllers in that domain. Step 3 – Click the Edit button for a domain controller, which is available in the far right of the domain controller row. The Server Backup Configuration wizard opens. v2.6 Step 4 – On the Server page, the fields are populated with the information you provided when configuring the domain controller backup. See the Add Backup Configurations for a Domain Controller topic for additional information. Enter the new password in the Password field and click Next. The next server backup will take into account the new password. v2.6 Step 5 – Modify the schedule if needed, then click Next. v2.6 Step 6 – Modify the options if needed, then click Next. v2.6 Step 7 – The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click Complete to finish the wizard. Step 8 – Click OK. v2.6 The backup account password for the domain controller has been updated and saved. Update SQL Server Service Account Password Follow the steps to update the password for the SQL Server service account. Step 1 – To launch the Recovery Configuration Utility, double-click the Recovery_Config.ex e executable at the following location in the Recovery for Active Directory installation directory: ...Netwrix\Recovery for Active Directory\Recovery_Config.exe Step 2 – Update the account password for SQL Server Authentication in the Login and Password fields. Step 3 – Click the Test button to validate the connection. On success, the following message is displayed: v2.6 Step 4 – Click OK. Step 5 – Once the connection has been established, click Save to update the account. Step 6 – Click OK. The SQL Server service account password has been updated and saved.