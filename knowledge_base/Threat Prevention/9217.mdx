---
title: How to Manage SQL Database Size
article_number: 9217
id: ka0Qk000000DAUbIAO
products: ['threat_prevention']
tags: []
categories: []
last_updated: 2025-05-24
articlecaseattachcount: 1
articlecreatedbyid: 005Qk0000017MRRIA2
articlecreateddate: 2024-07-15T16:00:57.000Z
article_drafts_folder__c: https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA0Qk0000001HDJKA2
change_log__c: JM 04/09/25: Modified to comply with style guide
<br>JM 07/15/24: Created at the request of Jon Obst
confidence_level__c: Not Validated
createdbyid: 005Qk0000017MRRIA2
createddate: 2025-04-09T19:49:54.000Z
firstpublisheddate: 2024-07-15T16:01:02.000Z
islatestversion: True
knowledgearticleid: kA0Qk0000001HDJKA2
knowledge_article_id__c: kA0Qk0000001HDJKA2
lastmodifiedbyid: 005Qk0000017MRRIA2
lastmodifieddate: 2025-04-09T20:12:14.000Z
lastpublisheddate: 2025-04-09T20:12:14.000Z
meta_description__c: StealthINTERCEPT Database Best Practices
meta_title__c: StealthINTERCEPT Database Best Practices
ownerid: 005Qk0000017MRRIA2
publishstatus: Online
recordtypeid: 0124u000000UUgLAAW
urlname: 9217
versionnumber: 2
website_url__c: <a href="https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000001HDJKA2.html" target="_blank">Open in a new window</a>
---

## Overview

It is important to monitor the size of the NVMonitorData SQL database (DB) used by Netwrix Threat Prevention to store collected event data. In production environments, the event dataset can grow significantly over time. Unchecked DB growth leads to excessive disk space usage and decreased performance during data insertion. Members can also experience slower performance when reporting data via the Console or the Web Reporting modules of Netwrix Threat Prevention.

Netwrix Threat Prevention includes a DB maintenance system for managing the data stored in the SQL DB. It supports a two-tier storage model. Tier 1, also called the Production DB, is the SQL DB specified upon installation. All real-time data is reported here for __Investigate__, __Recent Events__, and __Web Reports__. An optional Tier-2 DB, also called the Archive DB, can be set up in the __Database Maintenance__ dialog's __Archive DB__ tab. The __Investigate__ panel of the Console allows users to toggle between __Production__ and __Archive__ databases when searching event data.

The __Database Maintenance__ dialog is accessed through __Configuration | Database | Maintenance__ menu in the Console. It is a GUI front-end that configures a SQL Server job via the SQL Server Agent to run a series of stored procedures. These procedures delete or move event records based on their age and are scheduled to run daily, weekly, or monthly.

## Instructions

* Start using DB Maintenance soon after deploying the product to control DB size.
  * Configure the Archive DB tab first, as it influences options for both 'move' and 'delete'. For Archive DB configurations, we recommend moving events to Archive DB based on age so they are not accessed via the __Recent Events__ panel. They remain accessible via the __Investigate__ panel by selecting the __Archive__ option.

Use the __Schedule__ tab to run the maintenance __Daily__ during off-peak hours. Daily runs move or delete only one day’s older event data, ensuring timely completion before the following day's activity. In some situations, __Weekly__ runs might be preferred, but make sure these runs begin early enough to finish before the next workweek begins.

Reference DB maintenance alerts in the Threat Prevention Console's __Alerts__ panel, which provides details regarding start and stop times of maintenance and the type of events moved or deleted. Use these timestamps to calculate the required time for each policy type's processing. Check regularly as policy changes can impact collected event volume and removal schedules.

#### Policy vs. Event Type Tab

The __Policy__ tab allows for detailed data retention times on a per-policy basis. Set retention times to meet organizational needs for data retrieval, utilizing the Archive DB for long-term storage. For frequently changing or low-value events, keep shorter retention times after evaluating them. Note that sorting the “Event Count” column aids retention time decisions.

The __Event Type__ acts as a fallback to policy tab settings with longer retention times, ensuring old data removal even for policies not picked or updated in these settings. Both tabs work independently, so configure retention times accordingly.

Separate tables store analytics event data from policies, operating independently of __Event Type__ and __Policy__ tab settings.

#### Archive DB Management

Archive DB management is the customer’s responsibility for controlling size. Delete events with SQL queries based on a specified date. Alternatively, update the DB Maintenance to a new Archive DB annually, keeping the older Archive DB offline. Retrieve old data via:

* Update the Archive DB tab on the DB Maintenance panel to point to the 'old' DB. Use the Console’s __Investigate__ panel with __Archive__ selected. Do not leave at this setting if a scheduled maintenance job needs to run.
  * Install a standalone machine with Threat Prevention Server + Console without deploying from or pointing agents to it. Set the __DB Maintenance__ Archive Tab for the 'old' archive DB without configuring the __DB Maintenance Schedule__ tab. Use the Console's __Investigate__ panel to query indefinitely.

* Retrieve event data using your SQL queries from any Threat Prevention Event DB.

#### Troubleshooting Unused DB Maintenance and Large DBs

If the production DB becomes extensive quickly from lack of maintenance (such as many TB), moving or deleting events could face challenges or never complete. Configure the __Type__ tab by prioritizing events: retain first for only a few days less than the oldest event. Check DB Maintenance alerts, so future runs do not exceed operational thresholds and finish within 6 hours.