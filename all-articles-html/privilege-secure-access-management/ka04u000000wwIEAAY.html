<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Active Directory Federation Services (AD FS) as an Authentication Connector (SAML)</title>
    <meta name="article-id" content="ka04u000000wwIEAAY">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0050g000006ati4AAA">
    <meta name="articlecreateddate" content="2021-10-12T12:56:22.000Z">
    <meta name="articlenumber" content="000005909">
    <meta name="createdbyid" content="0050g000006ati4AAA">
    <meta name="createddate" content="2023-11-30T13:55:39.000Z">
    <meta name="firstpublisheddate" content="2021-10-12T13:38:36.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000HR7CAM">
    <meta name="knowledge-article-id" content="kA04u0000000HR7CAM">
    <meta name="lastmodifiedbyid" content="0054u000006gpnvAAA">
    <meta name="lastmodifieddate" content="2023-11-30T13:55:56.000Z">
    <meta name="lastpublisheddate" content="2021-10-12T13:38:36.000Z">
    <meta name="meta-description" content="Add Active Directory Federation Services (AD FS) as an Authentication Connector (SAML)">
    <meta name="meta-title" content="Add Active Directory Federation Services (AD FS) as an Authentication Connector (SAML)">
    <meta name="ownerid" content="0050g000006ati4AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="5909">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000HR7CAM.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Add Active Directory Federation Services (AD FS) as an Authentication Connector (SAML)</h1>
    <h1>Summary</h1>

<p>This article outlines the process of adding Active Directory Federation Services (AD FS) to SbPAM as an Authentication Connector via SAML. The article is split into two sections, <i><b>Steps for AD FS</b></i> and <i><b>Steps for SbPAM</b></i><em>.�</em>The AD FS section must be completed first.</p>

<h1>Instructions</h1>

<h3>Steps for Active Directory Federation Services (AD FS)</h3>

<ol><li>Launch�<strong>AD FS Management</strong> on the AD FS server:<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUhA"></img><br>	�</li><li>Right-click on <strong>Application Groups</strong> and select <strong>Add Application Group�<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUhK"></img></strong><br>	�</li><li>Select<strong> Native application accessing a web API </strong>and enter &quot;SbPAM (SAML)&quot; as the�<strong>Name</strong>, then click�<strong>Next</strong>.<br>	<br>	<br>	<strong><img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUhP"></img></strong><br>	�</li><li>Copy the <strong>Client Identifier</strong> value; you will need that when configuring SbPAM.<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUhU"></img><br>	�</li><li>For the�<strong>Redirect URI</strong>, use the following URI with the hostname of the SbPAM server customized to match your environment. For example: <strong>https://&lt;sbpam-server&gt;:6500/samlSigninCallback</strong>. Click�<strong>Add</strong>, then�<strong>Next</strong>.<br>	<br>	<strong><img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUhZ"></img></strong><br>	�</li><li>For the�<strong>Identifier�</strong>of the Web API, enter�<strong>sbpamsaml.stealthbits.com</strong>, click�<strong>Add</strong>, then click�<strong>Next</strong>.<br>	<br>	<strong><img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUiD"></img></strong><br>	�</li><li>For <strong>Apply Access Control Policy</strong>, leave all defaults and then click�<strong>Next</strong>.<br>	<br>	<img alt="User-added image" height="356" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUiI" width="500"></img><br>	�</li><li>For�<strong>Configure Application Permissions</strong>, enable the following and then click�<strong>Next</strong>.<br>	<br>	��allatclaims<br>	��email<br>	��openid<br>	��profile<br>	<br>	<strong><img alt="User-added image" height="305" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUi8" width="500"></img></strong><br>	�</li><li>Click <strong>Next�</strong>on the remaining pages until the wizard completes.<br>	�</li><li>In the left sidebar of�<strong>AD FS</strong>, click on the�<strong>Relying Party Trusts</strong> folder. In the right sidebar, click <strong>Add Relying Party Trust...</strong><br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUho"></img></li><li>Select�<strong>Claims aware</strong> and click�<strong>Next</strong>.<br>	<br>	<img alt="User-added image" height="120" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUhy" width="500"></img><br>	�</li><li>For�<strong>Select Data Source</strong>, select <strong>Enter data about the relying party manually</strong> and click�<strong>Next</strong>.<br>	�</li><li>For�<strong>Specify Display Name</strong>, enter &quot;SbPAM (SAML)&quot; and click�<strong>Next</strong>.<br>	�</li><li>For�<strong>Configure Certificate</strong>, leave the default values and click�<strong>Next</strong>.<br>	�</li><li>For�<strong>Configure URL</strong>, check�<strong>Enable support for the SAML 2.0 WebSSO protocol</strong> and enter your AD FS server&#39;s FQDN followed by &quot;/adfs/ls&quot;. For example:�<strong>https://adfs-server.domain.com/adfs/ls</strong>. Click�<strong>Next</strong>.<br>	<br>	<img alt="User-added image" height="235" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUiN" width="500"></img><br>	�</li><li>For�<strong>Configure Identifiers</strong>, use the value�<strong>sbpamsaml.stealthbits.com</strong>, click�<strong>Add</strong>, then click�<strong>Next</strong>.<br>	<br>	<img alt="User-added image" height="138" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUiS" width="500"></img><br>	�</li><li>Leave <strong>Choose Access Control Policy</strong> as default values and click�<strong>Next,�</strong>then click�<strong>Next</strong> through the remaining pages to finish the wizard.<br>	�</li><li>When the wizard closes, it a window for�<strong>Issuance Transform Rules</strong> will automatically open. Click�<strong>Add Rule...</strong><br>	�</li><li>Select�<strong>Send LDAP Attributes as Claims</strong>, and click�<strong>Next</strong>.<br>	<br>	<img alt="User-added image" height="71" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUiX" width="500"></img><br>	�</li><li>Name the rule &quot;Send attributes&quot;, select &quot;Active Directory&quot; as the�<strong>Attribute store</strong>, map the following <strong>LDAP Attributes</strong> to�<strong>Outgoing Claim Types</strong>, click�<strong>Finish</strong>, then click�<strong>Apply�</strong>and�<strong>OK</strong>.<br>	<br>	� SAM-Account-Name &gt; Name<br>	� User-Principal-Name &gt; UPN<br>	� E-Mail-Addresses &gt; E-Mail Address<br>	<br>	<img alt="User-added image" height="224" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUic" width="500"></img></li><li>Double-click on the�<strong>Relying Party Trust</strong> created in the previous steps (named &quot;SbPAM (SAML)&quot;), and navigate to the�<strong>Endpoints</strong> tab.<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUih"></img><br>	<br>	Add the following endpoints (click�<strong>Add SAML...</strong>):<br>	<br>	<strong>Endpoint type:�</strong>SAML Assertion Consumer<br>	<strong>Binding:�</strong>POST<br>	<strong>Index:�</strong>0<br>	<strong>Trusted URL:�</strong>https://&lt;sbpam-server&gt;:6500/samlSigninCallback<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUim"></img><br>	<br>	<strong>Endpoint type:�</strong>SAML Logout<br>	<strong>Binding:�</strong>POST<br>	<strong>Index:�</strong>0<br>	<strong>Trusted URL:�</strong>https://&lt;adfs-server&gt;.domain.com/adfs/ls/?wa=wsignout1.0&amp;wreply=https://&lt;sbpam-server&gt;:6500<br>	<strong>Response URL: </strong>https://&lt;sbpam-server&gt;:6500/login<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUir"></img><br>	<br>	Click�<strong>OK</strong>,�<strong>Apply</strong>, then�<strong>OK</strong>.<br>	�</li><li>This completes the AD FS configuration portion of the guide.</li></ol>

<h3>Steps for SbPAM</h3>

<p>Once the <i><b>Steps for AD FS</b></i>�have been completed, take the following steps in SbPAM to add AD FS as an Authentication Connector via SAML.</p>

<ol><li>As an SbPAM Admin, navigate in SbPAM to�<strong>Configuration &gt; Authentication</strong>, and click the green�<strong>&quot;+&quot;�</strong>button to add a new Authentication Connector.<br>	�</li><li>Give the new connector a name, description (optional), and a Connector Type of &quot;SAML&quot;.<br>	<br>	<img alt="User-added image" height="132" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUiw" width="500"></img><br>	�</li><li>Click on�<strong>Configuration Wizard</strong>.<br>	�</li><li>On the wizard&#39;s�<strong>Configure Client</strong> page, enter the following values:<br>	<br>	<strong>Signin URI:�</strong>https://&lt;adfs-server&gt;.domain.com/adfs/ls<br>	<strong>Callback Address:�</strong>https://&lt;sbpam-server&gt;:6500/samlSigninCallback<br>	<strong>CORS:�</strong>https://&lt;sbpam-server&gt;:6500<br>	<br>	<img alt="User-added image" height="234" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUj1" width="500"></img><br>	<br>	Click�<strong>Test Connection</strong>. If brought to a log-in page, click�<strong>Back</strong> in your web browser and then�<strong>Next</strong> in the SbPAM wizard. If the page refreshes and brings you back to the SbPAM wizard, you should also click�<strong>Next</strong> to proceed.<br>	�</li><li>Select &quot;Unspecified&quot; for the�<strong>Name ID Policy</strong>, and add a certificate if required. Then, click�<strong>Login�</strong>and sign-in to AD FS using Active Directory credentials.<br>	<br>	<img alt="User-added image" height="231" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUj6" width="500"></img><br>	<br>	When redirected back to this page after signing-in to AD FS, if the message at the bottom reads &quot;Login was successful&quot; then click�<strong>Next</strong>.<br>	�</li><li>Locate a mapping you would like to use when users sign-in to SbPAM using AD FS, such as an email address or UPN.<br>	<br>	<img alt="User-added image" height="117" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUjB" width="500"></img><br>	<br>	Click on the mapping, click <strong>Select</strong>, select the matching Active Directory mapping from the displayed dropdown, then click <strong>Next</strong>.<br>	<br>	<img alt="User-added image" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUjG"></img><br>	�</li><li>For the�<strong>Signout URI�</strong>and�<strong>Signout Callback URI</strong>, use the following values:<br>	<br>	<strong>Signout URI:�</strong>https://&lt;adfs-server&gt;.domain.com/adfs/ls/?wa=wsignout1.0&amp;wreply=<br>	<strong>Signout Callback URI:</strong> https://&lt;sbpam-server&gt;:6500<br>	<br>	<br>	<img alt="User-added image" height="303" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUjL" width="500"></img><br>	<br>	Click�<strong>Test Log Out</strong>, then�<strong>Finish</strong> to complete the wizard. AD FS has now been added to SbPAM (via SAML) as an Authentication Connector.<br>	�</li><li>The last step is to navigate to specific users in SbPAM&#39;s�<strong>Users &amp; Groups�</strong>menu, and assign the AD FS SAML authenticator.<br>	<br>	<img alt="User-added image" height="235" src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000wwIE&amp;feoid=00N0g000004CA0p&amp;refid=0EM4u000004bUjQ" width="500"></img></li></ol>

<p>When using the SAML log-in option, the user will be redirected to sign-in to AD FS. Upon successful authentication, the user will be redirected to the SbPAM UI as their now signed-in user.</p>
</body>
</html>