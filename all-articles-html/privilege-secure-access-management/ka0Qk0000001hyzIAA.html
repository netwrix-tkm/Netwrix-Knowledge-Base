<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exporting and Importing the Database to a New Server</title>
    <meta name="article-id" content="ka0Qk0000001hyzIAA">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006gpnvAAA">
    <meta name="articlecreateddate" content="2024-02-06T14:02:33.000Z">
    <meta name="articlenumber" content="000009044">
    <meta name="createdbyid" content="0054u000006gpnvAAA">
    <meta name="createddate" content="2024-02-06T14:02:33.000Z">
    <meta name="firstpublisheddate" content="2024-02-06T14:18:03.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA0Qk0000000RBVKA2">
    <meta name="knowledge-article-id" content="kA0Qk0000000RBVKA2">
    <meta name="lastmodifiedbyid" content="0054u000006gpnvAAA">
    <meta name="lastmodifieddate" content="2024-02-06T14:18:03.000Z">
    <meta name="lastpublisheddate" content="2024-02-06T14:18:03.000Z">
    <meta name="meta-description" content="Exporting and Importing the Database to a New Server">
    <meta name="meta-title" content="Exporting and Importing the Database to a New Server">
    <meta name="ownerid" content="0054u000006gpnvAAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="9044">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000000RBVKA2.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Exporting and Importing the Database to a New Server</h1>
    <h1>Overview</h1>
This article outlines the process of exporting your Netwrix Privilege Secure database, and importing it to a new Privilege Secure server.

<p>The data transferred includes:</p>

<ol><li>PostgreSQL Database</li><li>RDP/SSH Recordings</li><li>Configuration files</li><li>Encryption keys</li></ol>

<h1>Instructions</h1>

<h3>On the new server</h3>
� � 1. Install Netwrix Privilege Secure on the new server.

<h3 id="user-content-on-existing-server">On the existing server</h3>

<ol><li>Stop the following�services on the�server by running the indicated PowerShell commands:
	<pre>
<code>Stop-Service SbPAM* -Force
Stop-Service W3SVC
Stop-Service postgresql-x64-12
</code></pre>
	</li><li>Create an archive of PostgreSQL database by running the indicated command:<br>	<code>Compress-Archive -Path C:\ProgramData\Stealthbits\Postgres12 -DestinationPath C:\Temp\pg_data.zip -CompressionLevel Optimal</code></li><li>Export the NPS encryption keys, and capture the password generated by the export <em><strong>(note: the keys.exp file created in this step is sensitive and should be deleted after the import is complete)</strong></em>:<br>	<code>&quot;C:\Program Files\Stealthbits\PAM\KeyTools\SbPAM.RotateKey.exe&quot; export -n c:\temp\keys.exp</code></li><li>Create an archive of the�NPS configuration files:<br>	<code>Compress-Archive -Path C:\ProgramData\Stealthbits\PAM -DestinationPath C:\Temp\nps_config.zip -CompressionLevel Optimal</code></li><li>Copy�<code>pg_data.zip</code>,�<code>keys.exp</code>, and�<code>nps_config.zip</code>�to the new server.</li></ol>

<h2 id="user-content-on-new-server">On new server</h2>

<ol><li>Stop the following�services on the�server by running the indicated PowerShell commands:
	<pre>
<code>Stop-Service SbPAM* -Force
Stop-Service W3SVC
Stop-Service postgresql-x64-12
</code></pre>
	</li><li>Decompress the configuration files from the original�server:<br>	<code>Expand-Archive -Path c:\temp\nps_config.zip -DestinationPath c:\ProgramData\Stealthbits -Force</code></li><li>Decompress the PostgreSQL files from the original�server:<br>	<code>Expand-Archive -Path C:\temp\pg_data.zip -DestinationPath c:\ProgramData\Stealthbits -Force</code></li><li>Import the key files from the original server <em><strong>(note: the keys.exp file is sensitive and should�be deleted after the import is complete)</strong></em>:<br>	<code>&quot;C:\Program Files\Stealthbits\PAM\KeyTools\SbPAM.RotateKey.exe&quot; import -f -n c:\temp\keys.exp</code></li><li>Start�the following�services on the�server by running the indicatedPowerShell commands:
	<pre>
<code>Start-Service postgresql-x64-12
Start-Service W3SVC
Start-Service SbPAM* -Force</code></pre>
	</li></ol>
</body>
</html>