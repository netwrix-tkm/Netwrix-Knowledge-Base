<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update a collection from a database table</title>
    <meta name="article-id" content="ka04u000000HcxLAAS">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:36:40.000Z">
    <meta name="articlenumber" content="000007247">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2023-05-08T10:12:06.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:36:40.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000IrfCAE">
    <meta name="knowledge-article-id" content="kA04u0000000IrfCAE">
    <meta name="lastmodifiedbyid" content="0054u000006gSmgAAE">
    <meta name="lastmodifieddate" content="2023-05-08T10:12:06.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:36:40.000Z">
    <meta name="meta-description" content="360008304132">
    <meta name="meta-title" content="Update a collection from a database table">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="7247">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IrfCAE.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Update a collection from a database table</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> How to update a collection from a database table in StealthINTERCEPT</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">We have a feature in StealthINTERCEPT that allows you to update a collection from a database table. It is rather simple code but a working example you can leverage in your lab. I had a customer that needed to update a collection from a list of email addresses.� The first part of the email address is the logon name.� So the sample script allows them to update a dynamic collection in SI by reading their input file.</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">It is nothing magical but feel free to modify or use in any examples as I have heard this request a number of times.� I tried to comment the code so it is easy to read.</span></span></span><br>�</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Called out a couple variables you can edit at the top of the file</span></span></span><br><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000Lcadl&amp;d=%2Fa%2F4u000000LyDq%2F0.P3_nFMlyg2R5olHJRgz4UJRQ7zL30Sj3CjiRA8wls&amp;asPdf=false" alt="mceclip2.png"></img><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">The file with email addresses looks like </span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;"><a style="text-decoration: underline;color: #0563c1;" href="mailto:email@address.com" target="_blank">email@address.com</a></span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;"><a style="text-decoration: underline;color: #0563c1;" href="mailto:email2@address.com" target="_blank">email2@address.com</a></span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">The just input your server, database name should be the same and table name you can get from SQL or SI</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Configuration | Collections | Perpetrators</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Click Manage</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Choose or add a new collection click edit or add</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Ensure the collection has the option I want a list to come from a database table</span></span></span><br><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LcaBK&amp;d=%2Fa%2F4u000000Lywz%2FbaqzOVx_rewcUBAT3TzyBwoJuIk_4g65ioXBFJJttaY&amp;asPdf=false" alt="mceclip0.png"></img><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">The dynamic collection table can be automatically created and must have a couple fields</span></span></span></p>
<ol><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Distinguished Name</span></span></span></li><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Object SID</span></span></span></li><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Account Type</span></span></span></li><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Subtree</span></span></span></li></ol>
<p><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000Lca7R&amp;d=%2Fa%2F4u000000LylT%2Fg02wCim4UIT0oZwPoMp4T7aKhnr9m9Mbm1DwP1NFu1c&amp;asPdf=false" alt="mceclip3.png"></img><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">I put together a sample script for a customer that would </span></span></span><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span></p>
<ol><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Based on a list of email addresses it parses the string and uses everything before the @ symbol to look up the user by SAMAccount Name.</span></span></span></li><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">If the user is found it checks the DB Table to see if the users is already in the collection</span></span></span></li><li><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">If the user is not in the collection they are added</span></span></span></li></ol>
<p><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">It does log if the user is not found in AD</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">It does log if the user if the user is already in the collection</span></span></span><br><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LcXUC&amp;d=%2Fa%2F4u000000LytM%2FB53m7WslixdsREpSunTBialnsL6ms_7wqvHc1qFO6Nw&amp;asPdf=false" alt="mceclip4.png"></img><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Above is an example shows updating the db where only one user in the file was not found in AD</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Below shows adding 2 items</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">Detecting 3 existing items</span></span></span><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11pt;">1 item was not found on the AD lookup</span></span></span><br><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000Lcadq&amp;d=%2Fa%2F4u000000LyzJ%2F5p95lIyvWQQd6OdFrNoWowrK0m2RkbJTD5JlLVQK4Qs&amp;asPdf=false" alt="mceclip6.png"></img><br><span style="font-size: 12pt;"><span style="font-family: Calibri,sans-serif;">�</span></span><br><a href="http://downloads.stealthbits.com/access/files/Utilities/StealthINTERCEPT/DB%20Collection%20Update.ps1.zip" target="_blank">http://downloads.stealthbits.com/access/files/Utilities/StealthINTERCEPT/DB%20Collection%20Update.ps1.zip</a></p>
<p>�</p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthINTERCEPT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SI - Admin Console;SI - Enterprise Manager<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2458</p>
</body>
</html>