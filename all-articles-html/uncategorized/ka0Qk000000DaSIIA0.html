<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to identify Threat Prevention Events with known long string values that could be causing unexpected database growth.</title>
    <meta name="article-id" content="ka0Qk000000DaSIIA0">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:42:52.000Z">
    <meta name="articlenumber" content="000007341">
    <meta name="article-drafts-folder" content="https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA04u0000000Iw6CAE">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2025-05-05T11:31:16.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:42:52.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000Iw6CAE">
    <meta name="knowledge-article-id" content="kA04u0000000Iw6CAE">
    <meta name="lastmodifiedbyid" content="0054u0000093LZ4AAM">
    <meta name="lastmodifieddate" content="2025-05-05T11:39:16.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:42:52.000Z">
    <meta name="meta-description" content="360008304132">
    <meta name="meta-title" content="How to identify Threat Prevention Events with known long string values that could be causing unexpected database growth.">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="7341">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000Iw6CAE.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>How to identify Threat Prevention Events with known long string values that could be causing unexpected database growth.</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> There are a few known attributes that generate very long string values. These can cause the Threat Prevention database to grow very large and these events might not be needed\useful.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span style="font-size: 11pt;">Unexpected SI DB Growth\Size due to NVMonitorData.dbo.AttributeValue growing very large.</span></p>
<pre><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>:� </strong>If the NVMonitorData.dbo.AttributeValue is experiencing a lot of growth run the Sql script below to identify the attributes with known long strings values and which policies are responsible for collecting this information.� You can put �Attributes exclusions in these policies to stop Threat Prevention from collecting these events.� This will stop us from collecting these events moving forward.� Threat Prevention Maintenance should remove these events once the data retention period is reached.</span></span><br><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">SELECT</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> Top 1000 </span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">A</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[eventId]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[attributeId]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[attributeName]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[formattedAttributeName]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">�����<span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[operation]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[isOld]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[valueSyntax]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: fuchsia;">DATALENGTH</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">(</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">formattedStringValue</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">)</span></span></span> <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;String Length&#39;</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������<span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">p</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[name] </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;Policy Name&#39;</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[stringValue]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[formattedStringValue]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[numericValue]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[formattedNumericValue]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[dateTimeValue]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">����� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">A</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[utcTimeLogged]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">FROM</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> [NVMonitorData]</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[dbo]</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[AttributeValue] A</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">join</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> [NVMonitorData]</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[dbo]</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[EventPolicy] E</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">on</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> A</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">eventId </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">=</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> E</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">eventId</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">join</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">� [NVMonitorConfig]</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[dbo]</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[Policy] p</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">on</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> p</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[policyId] </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">=</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> E</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">.</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">[policyId]</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">--This script looks for attributes with known long string values.� The Section below can be commented out to look for all attribute lengths.</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">� <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">Where</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> [attributeName] </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">in</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">(</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;mSMQSignCertificates&#39;</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;mSMQDigests&#39;</span></span></span>������</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;msExchMailboxSecurityDescriptor&#39;</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;userCertificate&#39;</span></span></span>��</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;msExchSafeSendersHash&#39;</span></span></span>��</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;ProxyOverride (id: ProxyOverride)&#39;</span></span></span>����</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;msExchBlockedSendersHash&#39;</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;msDS-BridgeHeadServersUsed&#39;</span></span></span>����</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;Settings Page Visibility&#39;</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">������������������������������������������������������ <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">,</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: red;">&#39;gPLink&#39;</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">)</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: gray;">--</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">Comment out to here to look at all length name of all attributes</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">Order</span></span></span> <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">by</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> [String Length] </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">desc</span></span></span></span></span><br>�</pre>
<p>�</p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> Threat Prevention<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SI - Admin Console;SI - Alerts;SI - Enterprise Manager;SI - Exchange Agent;SI - File System Agent;SI - Installer;SI - Policy;SI - SIEM Integration;SI - Web Reporting<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 6.0, 6.1, 7.0, 7.1<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2419</p>
</body>
</html>