<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gather Folder Count and Maximum Folder Depth Outside of Access Analyzer</title>
    <meta name="article-id" content="ka0Qk000000DaqTIAS">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:31:41.000Z">
    <meta name="articlenumber" content="000007160">
    <meta name="article-drafts-folder" content="https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA04u0000000IobCAE">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2025-05-05T11:28:14.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:31:41.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000IobCAE">
    <meta name="knowledge-article-id" content="kA04u0000000IobCAE">
    <meta name="lastmodifiedbyid" content="0054u0000093LZ4AAM">
    <meta name="lastmodifieddate" content="2025-05-05T11:40:24.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:31:41.000Z">
    <meta name="meta-description" content="360008408371">
    <meta name="meta-title" content="Gather Folder Count and Maximum Folder Depth Outside of Access Analyzer">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="7160">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IobCAE.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Gather Folder Count and Maximum Folder Depth Outside of Access Analyzer</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Uses custom PowerShell script to enumerate all folders on target share, leveraging Robocopy for backup privilege capabilities and long file path support (similar to how FSAA works).</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Customers sometimes ask for data validation to be performed, and one of the asks for a POC was to &quot;prove&quot; that our data for folder depth (relative to share root, available in the SA_FSAA_SharesTraversalView) matches that collected via an independent routine<br><br>Note: This really shouldn&#39;t be our responsibility.� It&#39;s the customers responsibility to validate their data against whatever they want, and understand the differences.� However, if you&#39;re going to do it, anyway, here&#39;s some help.��<br><br>This script works for local and remote shares. It does not work for local paths. Simply update the path to include a valid share to be analyzed in the $SourcePath parameter, and enter a valid local path to act as the destination folder for the robocopy command. No data will actually be copied. Finally, enter a valid path where the log file will be created.<br>�<br>The script works by listing the empty folder structure (&quot;L&quot; parameter) that would be created locally and then parsing the log file created by Robocopy to understand depth by measuring the length of the path and subtracting the length of the path with no backslashes.<br>�<br>Results include the following:�</p>
<table style="width: 444px;margin-left: -0.15pt;" border="0" width="444" cellspacing="0" cellpadding="0"><tbody><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><strong><span style="color: white;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">Property</span></span></span></strong></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><strong><span style="color: white;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">Value</span></span></span></strong></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">SourceRoot</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;"><a target="_blank">\\localhost\Data</a></span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">DestRoot</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">H:\Copy Of Desktop</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">SourceRootDepth</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">0</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">DestRootDepth</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">1</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">DepthDiff</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">-1</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">ShareRootDepth</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">1</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">ShareRootFolder</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">H:\Data</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">MaxDepth</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">0</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">MaxDepthFromVolRoot</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">1</span></span></span></td></tr><tr style="height: 18px;"><td colspan="1" rowspan="1" style="height: 18px;width: 154px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">DeepestFolderSample</span></span></span></td><td colspan="1" rowspan="1" style="height: 18px;width: 290px;"><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 10pt;">� New Dir��������� 2 <a target="_blank">\\localhost\Data\</a></span></span></span></td></tr></tbody></table>
<p>�<br><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> �<br>Note: Must run as an administrator!<br>�<br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$SourcePath</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: darkred;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">&#39;\\sbitsinc.com\Public\Professional Services\Customers&#39;</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$SourcePath</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: darkred;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">&#39;\\localhost\Data&#39;</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$DestPath</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: darkred;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">&#39;H:\Copy Of Desktop&#39;</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$LogPath</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: darkred;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">&quot;H:\RoboLog.txt&quot;</span></span></span><br><span style="color: darkgreen;"><span style="font-family: lucida console;"><span style="font-size: 9pt;"></span></span><br>�<br><span style="color: darkgreen;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">potential options....</span></span></span><br><span style="color: darkgreen;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">/XJ :: eXclude Junction points. (normally included by default).</span></span></span><br><span style="color: darkgreen;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">/SL :: copy symbolic links versus the target</span></span></span><br>�<br><span style="color: darkgreen;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">#&gt;</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$logoutput</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: blue;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">robocopy</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;"> <span style="color: orangered;">$SourcePath</span> <span style="color: orangered;">$DestPath</span> <span style="color: blueviolet;">*.*</span> <span style="color: blueviolet;">/E</span> <span style="color: blueviolet;">/B</span> <span style="color: blueviolet;">/MIR</span> <span style="color: blueviolet;">/UNILOG:</span><span style="color: orangered;">$LogPath</span> <span style="color: blueviolet;">/NFL</span> <span style="color: blueviolet;">/L</span> <span style="color: blueviolet;">/NP</span> <span style="color: blueviolet;">/V</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$IsSourceShare</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: darkblue;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">if</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">(<span style="color: orangered;">$SourcePath</span><span style="color: darkgray;">[</span><span style="color: purple;">0</span><span style="color: darkgray;">]</span> <span style="color: darkgray;">-eq</span> <span style="color: darkred;">&#39;\&#39;</span>){<span style="color: orangered;">$True</span>} <span style="color: darkblue;">else</span> {<span style="color: orangered;">$False</span>}</span></span><br><span style="color: darkblue;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">if</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">(<span style="color: orangered;">$IsSourceShare</span>){</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$TgtHost</span><span style="color: darkgray;">=</span><span style="color: orangered;">$SourcePath</span><span style="color: darkgray;">[</span><span style="color: purple;">2</span><span style="color: darkgray;">..</span>((<span style="color: orangered;">$SourcePath</span><span style="color: darkgray;">[</span><span style="color: purple;">2</span><span style="color: darkgray;">..</span><span style="color: orangered;">$SourcePath</span><span style="color: darkgray;">.</span>length<span style="color: darkgray;">]-join</span>(<span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>IndexOf(<span style="color: darkred;">&#39;\&#39;</span>)<span style="color: darkgray;">+</span><span style="color: purple;">1</span>)<span style="color: darkgray;">]</span> <span style="color: darkgray;">-join</span>(<span style="color: darkred;">&#39;&#39;</span>)</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$TgtShare</span><span style="color: darkgray;">=</span>(<span style="color: orangered;">$SourcePath</span><span style="color: darkgray;">[</span>(<span style="color: purple;">3</span><span style="color: darkgray;">+</span><span style="color: orangered;">$TgtHost</span><span style="color: darkgray;">.</span>Length)<span style="color: darkgray;">..</span>(<span style="color: orangered;">$SourcePath</span><span style="color: darkgray;">.</span>Length)<span style="color: darkgray;">]</span> <span style="color: darkgray;">-join</span>(<span style="color: darkred;">&#39;&#39;</span>))</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: darkblue;">if</span>(<span style="color: orangered;">$TgtShare</span> <span style="color: darkgray;">-like</span> <span style="color: darkred;">&#39;*\*&#39;</span>){</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">������� <span style="color: orangered;">$TgtShare</span><span style="color: darkgray;">=</span><span style="color: orangered;">$TgtShare</span><span style="color: darkgray;">[</span><span style="color: purple;">0</span><span style="color: darkgray;">..</span>(<span style="color: orangered;">$TgtShare</span><span style="color: darkgray;">.</span>IndexOf(<span style="color: darkred;">&#39;\&#39;</span>)<span style="color: darkgray;">-</span><span style="color: purple;">1</span>)<span style="color: darkgray;">]</span> <span style="color: darkgray;">-join</span>(<span style="color: darkred;">&#39;&#39;</span>)</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� }</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$Filter</span><span style="color: darkgray;">=</span><span style="color: darkred;">&quot;Name=&quot;&quot;</span><span style="color: orangered;">$TgtShare</span><span style="color: darkred;">&quot;&quot;&quot;</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$ShareObj</span><span style="color: darkgray;">=</span><span style="color: blue;">gwmi</span> <span style="color: blueviolet;">win32_share</span> <span style="color: navy;">-ComputerName</span> <span style="color: orangered;">$TgtHost</span> <span style="color: navy;">-Filter</span> <span style="color: orangered;">$Filter</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$ShareRootFolder</span><span style="color: darkgray;">=</span><span style="color: orangered;">$ShareObj</span><span style="color: darkgray;">.</span>Path</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$ShareRootDepth</span><span style="color: darkgray;">=</span><span style="color: orangered;">$ShareRootFolder</span><span style="color: darkgray;">.</span>length <span style="color: darkgray;">-</span> (<span style="color: orangered;">$ShareRootFolder</span> <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&#39;\\&#39;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>) <span style="color: darkgray;">-join</span>(<span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length</span></span><br>���<br>�<br><span style="font-family: lucida console;"><span style="font-size: 9pt;">}</span></span><br><span style="color: darkblue;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">if</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">(<span style="color: orangered;">$IsSourceShare</span> <span style="color: darkgray;">-eq</span> <span style="color: orangered;">$False</span>){</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$SourceRootDepth</span><span style="color: darkgray;">=</span><span style="color: blue;">Select-String</span> <span style="color: navy;">-path</span> <span style="color: orangered;">$LogPath</span> <span style="color: navy;">-Pattern</span> <span style="color: darkred;">&quot;Source&quot;</span> <span style="color: navy;">-List</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> @{Name<span style="color: darkgray;">=</span><span style="color: darkred;">&quot;SourceDepth&quot;</span>;Expression<span style="color: darkgray;">=</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span>(<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&quot;\\&quot;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span><span style="color: purple;">1</span>}} <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: navy;">-ExpandProperty</span> <span style="color: blueviolet;">SourceDepth</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$DestRootDepth</span><span style="color: darkgray;">=</span><span style="color: blue;">Select-String</span> <span style="color: navy;">-path</span> <span style="color: orangered;">$LogPath</span> <span style="color: navy;">-Pattern</span> <span style="color: darkred;">&quot;Dest&quot;</span> <span style="color: navy;">-List</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> @{Name<span style="color: darkgray;">=</span><span style="color: darkred;">&quot;DestDepth&quot;</span>;Expression<span style="color: darkgray;">=</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span>(<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&quot;\\&quot;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span><span style="color: purple;">1</span>}} <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: navy;">-ExpandProperty</span> <span style="color: blueviolet;">DestDepth</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$DepthDiff</span><span style="color: darkgray;">=</span><span style="color: orangered;">$SourceRootDepth</span> <span style="color: darkgray;">-</span> <span style="color: orangered;">$DestRootDepth</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$ShareRootDepth</span><span style="color: darkgray;">=</span><span style="color: purple;">0</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$Folders</span><span style="color: darkgray;">=</span>@()</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$Folders</span><span style="color: darkgray;">+=</span><span style="color: blue;">Select-String</span> <span style="color: navy;">-path</span> <span style="color: orangered;">$LogPath</span> <span style="color: navy;">-Pattern</span> <span style="color: darkred;">&quot;New Dir&quot;</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: blueviolet;">Line</span><span style="color: darkgray;">,</span> @{Name<span style="color: darkgray;">=</span><span style="color: darkred;">&quot;DestDepth&quot;</span>;Expression<span style="color: darkgray;">=</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span>(<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&quot;\\&quot;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span><span style="color: purple;">1</span>}}</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">}</span></span><br><span style="color: darkblue;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">else</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">{</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$SourceRootDepth</span><span style="color: darkgray;">=</span><span style="color: blue;">Select-String</span> <span style="color: navy;">-path</span> <span style="color: orangered;">$LogPath</span> <span style="color: navy;">-Pattern</span> <span style="color: darkred;">&quot;Source&quot;</span> <span style="color: navy;">-List</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> @{Name<span style="color: darkgray;">=</span><span style="color: darkred;">&quot;SourceDepth&quot;</span>;Expression<span style="color: darkgray;">=</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span>(<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&quot;\\&quot;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span><span style="color: purple;">4</span>}} <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: navy;">-ExpandProperty</span> <span style="color: blueviolet;">SourceDepth</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$DestRootDepth</span><span style="color: darkgray;">=</span><span style="color: blue;">Select-String</span> <span style="color: navy;">-path</span> <span style="color: orangered;">$LogPath</span> <span style="color: navy;">-Pattern</span> <span style="color: darkred;">&quot;Dest&quot;</span> <span style="color: navy;">-List</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> @{Name<span style="color: darkgray;">=</span><span style="color: darkred;">&quot;DestDepth&quot;</span>;Expression<span style="color: darkgray;">=</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span>(<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&quot;\\&quot;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span><span style="color: purple;">1</span>}} <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: navy;">-ExpandProperty</span> <span style="color: blueviolet;">DestDepth</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$DepthDiff</span><span style="color: darkgray;">=</span><span style="color: orangered;">$SourceRootDepth</span> <span style="color: darkgray;">-</span> <span style="color: orangered;">$DestRootDepth</span></span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$Folders</span><span style="color: darkgray;">=</span>@()</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">��� <span style="color: orangered;">$Folders</span><span style="color: darkgray;">+=</span><span style="color: blue;">Select-String</span> <span style="color: navy;">-path</span> <span style="color: orangered;">$LogPath</span> <span style="color: navy;">-Pattern</span> <span style="color: darkred;">&quot;New Dir&quot;</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: blueviolet;">Line</span><span style="color: darkgray;">,</span> @{Name<span style="color: darkgray;">=</span><span style="color: darkred;">&quot;SourceDepth&quot;</span>;Expression<span style="color: darkgray;">=</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span>(<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>Line <span style="color: darkgray;">-replace</span>(<span style="color: darkred;">&quot;\\&quot;</span><span style="color: darkgray;">,</span><span style="color: darkred;">&#39;&#39;</span>))<span style="color: darkgray;">.</span>Length<span style="color: darkgray;">-</span><span style="color: purple;">4</span>}}</span></span><br><span style="font-family: lucida console;"><span style="font-size: 9pt;">}</span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$MaxDepth</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Folders</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;"> <span style="color: darkgray;">|</span> <span style="color: blue;">Measure-Object</span> <span style="color: navy;">-Property</span> <span style="color: blueviolet;">SourceDepth</span> <span style="color: navy;">-Maximum</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: navy;">-ExpandProperty</span> <span style="color: blueviolet;">Maximum</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$FolderCount</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Folders</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;"> <span style="color: darkgray;">|</span> <span style="color: blue;">Measure-Object</span> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: navy;">-ExpandProperty</span> <span style="color: blueviolet;">Count</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$DeepestFolders</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Folders</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;"> <span style="color: darkgray;">|</span> <span style="color: blue;">?</span>{<span style="color: orangered;">$_</span><span style="color: darkgray;">.</span>SourceDepth <span style="color: darkgray;">-eq</span> <span style="color: orangered;">$MaxDepth</span>}</span></span><br>�<br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">=</span></span></span><span style="color: darkred;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">&#39;&#39;</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;"> <span style="color: darkgray;">|</span> <span style="color: blue;">select</span> <span style="color: blueviolet;">SourceRoot</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">DestRoot</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">SourceRootDepth</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">DestRootDepth</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">DepthDiff</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">ShareRootDepth</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">ShareRootFolder</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">MaxDepth</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">MaxDepthFromVolRoot</span><span style="color: darkgray;">,</span> <span style="color: blueviolet;">DeepestFolderSample</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">SourceRoot<span style="color: darkgray;">=</span><span style="color: orangered;">$SourcePath</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">DestRoot<span style="color: darkgray;">=</span><span style="color: orangered;">$DestPath</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">SourceRootDepth<span style="color: darkgray;">=</span><span style="color: orangered;">$SourceRootDepth</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">DestRootDepth<span style="color: darkgray;">=</span><span style="color: orangered;">$DestRootDepth</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">DepthDiff<span style="color: darkgray;">=</span><span style="color: orangered;">$DepthDiff</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">ShareRootFolder<span style="color: darkgray;">=</span><span style="color: orangered;">$ShareRootFolder</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">ShareRootDepth<span style="color: darkgray;">=</span><span style="color: orangered;">$ShareRootDepth</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">MaxDepth<span style="color: darkgray;">=</span><span style="color: orangered;">$MaxDepth</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">MaxDepthFromVolRoot<span style="color: darkgray;">=</span><span style="color: orangered;">$MaxDepth</span><span style="color: darkgray;">+</span><span style="color: orangered;">$ShareRootDepth</span></span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res</span></span></span><span style="color: darkgray;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">.</span></span></span><span style="font-family: lucida console;"><span style="font-size: 9pt;">DeepestFolderSample<span style="color: darkgray;">=</span><span style="color: orangered;">$DeepestFolders</span><span style="color: darkgray;">[</span><span style="color: purple;">0</span><span style="color: darkgray;">].</span>Line</span></span><br><span style="color: orangered;"><span style="font-family: lucida console;"><span style="font-size: 9pt;">$Res </span></span></span><br>�<br>�</span></p>
<p><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1883</p>
</body>
</html>