<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StealthAUDIT, StealthINTERCEPT, SQL Native Client, and TLS</title>
    <meta name="article-id" content="ka04u000000HcwNAAS">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:31:39.000Z">
    <meta name="articlenumber" content="000007159">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2023-05-08T10:11:44.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:31:40.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000IoWCAU">
    <meta name="knowledge-article-id" content="kA04u0000000IoWCAU">
    <meta name="lastmodifiedbyid" content="0054u000006gSmgAAE">
    <meta name="lastmodifieddate" content="2023-05-08T10:11:44.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:31:40.000Z">
    <meta name="meta-description" content="360008408371">
    <meta name="meta-title" content="StealthAUDIT, StealthINTERCEPT, SQL Native Client, and TLS">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="7159">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IoWCAU.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>StealthAUDIT, StealthINTERCEPT, SQL Native Client, and TLS</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> StealthAUDIT and StealthINTERCEPT both leverage SQL Native Client which supports TLS. This is an overview of those functionalities.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">Transport Layer Security (TLS) is a protocol that has superseded SSL.� The latest version is 1.2, as of January 2018.� Some customers chose not to secure the internal communication between our products and their databases, but if they do, they&#39;ll likely enable TLS 1.2, at this point.� </span></span></span><br><br><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">There are several providers that can be used for making a connection to SQL.� In the past, our products have used a generic Microsoft OLE DB Provider for SQL to connect to the database, which will not work with TLS enabled.� We now use the SQL Native Client (SNAC) provider, instead.� This provider does work with TLS.� </span></span></span><br><br><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;"><strong>SFAM</strong>: Doesn&#39;t connect to SQL, and should not be affected.��<br><strong>AIC</strong>: Versions 7.2+ should support TLS 1.2 for both the https aspect and the sql connection.��</span></span></span><br><strong><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">StealthINTERCEPT:</span></span></span></strong><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;"> 5.0+ installers include SQL Native Client.� Versions prior to 5.0 DO NOT support SQL Native Client.��</span></span></span><br><strong><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">StealthAUDIT:</span></span></span></strong><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">� SQL Native Client is not part of our installer, but is required on the StealthAUDIT server starting in:</span></span></span></p>
<ul><li><font face="arial, sans-serif"><span style="font-size: 12px;">10.0</span></font></li><li><font face="arial, sans-serif"><span style="font-size: 12px;">9.0</span></font></li><li><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">8.1</span></span></span></li><li>
<span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">8.0 Hotfix 29 (presumably�</span></span></span>v8.0.707)</li><li>
<span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">7.2 Hotfix 57 (presumably�</span></span></span>v7.2.639)</li></ul>
<p><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">Note: If the customer enables TLS 1.2 without installing SQL Native Client, StealthAUDIT will no longer be able to connect to the database.��<br>StealthAUDIT attempts to use SQL Native Client 11, 10.5, 10, then the older OLE DB / ADO providers, in that order.��</span></span></span><br>�</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <strong><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">Installing SQL Native Client<br>Download from this page:�</span></span></span></strong><a href="https://support.microsoft.com/en-us/help/3135244/tls-1-2-support-for-microsoft-sql-server" target="_blank"><span style="color: #333435;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">TLS 1.2 support for Microsoft SQL Server</span></span></span>�</a><br>Use the link for�<span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">&quot;Microsoft SQL Server 2012 Native Client - QFE&quot; under the &quot;Client Component Downloads&quot; section.� </span></span></span><br><br>SQL Server Native Client 11.0 (SQL Server 2012 and SQL Server 2014)<span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">�supports connections to</span></span></span></p>
<ul><li><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">SQL Server 2008</span></span></span></li><li><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">SQL Server 2008 R2</span></span></span></li><li><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">SQL Server 2012</span></span></span></li><li><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">SQL Server 2014</span></span></span></li><li><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">Azure SQL Database.</span></span></span></li></ul>
<p><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">It is also�supported on the following operating systems: Server 2008 R2, Server 2012, and presumably later versions, although this site doesn&#39;t specifically mention that.��</span></span></span><br><a href="https://docs.microsoft.com/en-us/sql/relational-databases/native-client/applications/support-policies-for-sql-server-native-client" target="_blank">Support Policies for SQL Server Native Client</a><br>�<br><strong><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">Issues with StealthAUDIT Agent-based SharePoint Collections</span></span></span></strong><br><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">The connection string to connect to the SA database is built on the SA server, and it contains the exact provider being used there, as part of our connection string to the SA database.� </span></span></span><br><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">The problem occurs because the SP Agent is trying to use that same connection string to connect to the SA database.� It has nothing to do with connecting to the SharePoint databases.� </span></span></span><br><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">For this to work in the current versions, the version of SQL Native Client on the target SharePoint Application Server running our agent needs to be equal (or possibly newer) than the version installed on the StealthAUDIT server.� </span></span></span><br><span style="color: black;"><span style="font-family: arial,sans-serif;"><span style="font-size: 9pt;">Development is planning on changing the product so the agent won&#39;t need to connect to the SA database in YouTrack�<a href="https://stealthbits.myjetbrains.com/youtrack/issue/SAFS-1465" target="_blank">SAFS-1465</a>.� </span></span></span><br><br>This provider:<br><br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=56730" target="_blank">https://www.microsoft.com/en-us/download/details.aspx?id=56730</a><br><br>Also works for SA 8.0+ as long�SA_8.1_106 (or later) or SA_8.0_098 (or later) is installed.<br>�</p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - Core;SI - Installer;SI - Web Reporting<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.1+, 8.0 Hotfix 29+, 7.2 Hotfix 57+<br><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SMPC-3315, SAFS-1465<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1710</p>
</body>
</html>