<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotfix: SA_8.1_084</title>
    <meta name="article-id" content="ka0Qk000000DnvmIAC">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:52:59.000Z">
    <meta name="articlenumber" content="000007926">
    <meta name="article-drafts-folder" content="https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA04u0000000ICxCAM">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2025-05-11T17:41:44.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:53:00.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000ICxCAM">
    <meta name="knowledge-article-id" content="kA04u0000000ICxCAM">
    <meta name="lastmodifiedbyid" content="0054u0000093LZ4AAM">
    <meta name="lastmodifieddate" content="2025-05-11T17:46:48.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:53:00.000Z">
    <meta name="meta-description" content="360012217852">
    <meta name="meta-title" content="Hotfix: SA_8.1_084">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="7926">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000ICxCAM.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Hotfix: SA_8.1_084</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> FSAA | Error &quot;Invalid discretionary access control list on security descriptor&quot; when security descriptor has no DACL</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <strong><span style="font-family: calibri,sans-serif;">Summary: </span></strong>�FSAA | Error &quot;Invalid discretionary access control list on security descriptor&quot; when security descriptor has no DACL<br><strong><span style="font-family: calibri,sans-serif;">Before Fix: </span></strong>There was a subtle misuse of the Windows API that, due to an uninitialized variable for the DACL pointer in the case where the SD did not contain a DACL, we would still try to load the DACL even in the case where we correctly determined it did not exist.<br><strong><span style="font-family: calibri,sans-serif;">After Fix: </span></strong>We don&#39;t try to load the DACL if it&#39;s determined that it doesn&#39;t exist.<br><strong><span style="font-family: calibri,sans-serif;">Submitted by: </span></strong><br>Michael Burrofato<br><strong><span style="font-family: calibri,sans-serif;">Affected Versions:</span></strong><br>�8.1<br><strong><span style="font-family: calibri,sans-serif;">Affected Module:</span></strong><br>Access Analyzer - DC - FSAA<br>�<br><strong><span style="font-family: calibri,sans-serif;">Dev Ticket:</span></strong> 
</p><ul><li><span style="color: black;">SAFS-15353</span></li></ul><strong><span style="font-family: calibri,sans-serif;">Resolved in Version:</span></strong> 
<ul><li>
<span style="color: windowtext;">DCFSAA.dll�������������������������������������������������������������������������������������������� 8.1.979</span>
</li><li>
<span style="color: windowtext;">FSAASrv.dll�������������������������������������������������������������������������������������������� 8.1.979</span>
</li><li><span style="color: windowtext;">Stealthbits.StealthAUDIT.DataCollectors.FSAA.dll���������������������� 8.1.979</span></li></ul><b><span style="color: windowtext;">Other dependencies included:</span></b> 
<ul><li>
<span style="color: windowtext;">StealthAUDITRPC.exe������������ �������������������������������������������� �������������� 8.1.102</span>
</li><li>
<span style="color: windowtext;">StealthAUDITRPCClient.dll������������������������������������������������� �������������� 8.1.102</span>
</li><li>
<span style="color: windowtext;">Stealthbits.StealthAUDIT.DataCollectors.FSAA.RPCClient.dll��� 8.1.0</span>
</li><li>
<span style="color: windowtext;">Stealthbits.StealthAUDIT.DataCollectors.dll������������������ �������������� 8.1.59</span>
</li><li>
<span style="color: windowtext;">INIFileParser.dll����������������������������������������������������������������������������������� 2.5.2</span>
</li><li><span style="color: windowtext;">FSAAConfig.xml</span></li></ul><strong><span style="font-family: calibri,sans-serif;">KB Type: </span></strong><br>�������������� Hotfix<br>�<br><strong><span style="font-family: calibri,sans-serif;">YouTrack/Escalations</span></strong><br>�<br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15353/Escalation 27010</span></strong><br>�<br><strong><span style="font-family: calibri,sans-serif;">Customers</span></strong> 
<ul><li><strong><span style="font-family: calibri,sans-serif;">������ Pacific Dental Services, Inc.</span></strong></li></ul>�<br>�<br><strong><span style="font-family: calibri,sans-serif;">Cumulative List of fixes included since Service Pack:</span></strong><br>-������������� SAFS-14545 SDD Bulk Import clearing tier 1 data prior to checking if DLPEX db exists<br>-������������� SAFS-14541 Remove Description in FSAAConfig.xml<br>-������������� SAFS-14548 FSAC Bulk Import performance issue<br>-������������� SAFS-2705 15281 - FSAA unspecified error<br>-������������� SAFS-14573 22741 - FSAA Migration Query 7.2 to 8.0 Duplicate Column Error<br>-������������� SAFS-14598 22741 - FSAA Migration Query 7.2 to 8.0 could not convert variant of type (Null) into type (Integer)<br>-������������� SAFS-14593 Update bulk import to not delete Activity and DLPEX tier 2 dbs.<br>-������������� SAFS-2707 19757 - FSAC Bulk Import Rollback Due to Unspecified Error<br>-������������� SAFS-14595 22840 - There is an error in XML document (0, 0). ---&gt; System.OverflowException: Value was either too large or too small for an Int32.<br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14633 Update FSAA to not delete DLPEX db when streaming</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14566 Update FSAA to pass parameters to SDD</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14672 FSAC Access Violation on scans</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14685 Access violation when cancelling streaming FSAA scan due to timeout or DC-side streaming error</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14596 22751 - Access Violation with FSAA Scan v8.1</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14483 22116 - Do Not Delete Activity Data Automatically (8.1+ Implementation)</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14723 NFS Scans Don&#39;t Scan Subfolders when &quot;Limit Subfolder Depth&quot; is checked</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14720 23415 - DFS Collection: FSAA.FSAAException: Unable to determine domain: 5</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14670 23199 - FSAA doesn&#39;t throw error when service account doesn&#39;t have enough permission to scan shares.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14688 Applet log level of &quot;None&quot; sends all log messages to StealthAUDITRPC.exe trace log file</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14677 22992/22994 - FSAA automatically clean up old files.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-2771 20689 - Error during storing DailyActivity: &#39;&#39; is not a valid integer value</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14735 rename streaming database to include scan type</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14738 Error when scanning with System default profile.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-2173 14049 - Downgrade/Eliminate NetApp OnTap 9 Warnings</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14757 Improve DFS error messages and diagnostic logging; only enumerate domain namespaces on domain controllers</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14719 23412 - FSAA collection error: (0x80004005): SQL logic error or missing database no such table: TBL_FSAA_Sequence</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14767 23670 - Connect to SQL server before connection profile impersonation</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14748 23546 - Retry timeout exceeded</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14616 20970 - The INSERT statement conflicted with the FOREIGN KEY constraint &quot;FK_SA_FSAC_ActivityEvents_New_PathID&quot; (8.1+ Implementation).</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14656 23094 - Strip trailing spaces from shares&#39; landing folders</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-2957 21750 - FSAA | Skip IPC$ check in applet mode</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14607 22956/23113 - Waiting for Parser Queue to be Empty</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14809 Automatic procdump functionality in FSAA applet can cause access violations after scan completes</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14597 Add RPC_IF_ALLOW_CALLBACKS_WITH_NO_AUTH and auth callback even if not using secure RPC to permit working with RestrictRemoteClients=1</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14792 Fix &#39;Object Reference Not Set To Instance of an Object&#39; Error in FSAC scans</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14803 FSAC: Add option of maximum days of activity to scan at once</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14848 TxtForAllFiles option not being passed correctly to SDD (8.1)</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14800 23738 - SDD Scoping to folders</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14841 License file should not be directly copied to remote hosts</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-2692 19369/19531 - FSAA | Shares Marked as Deleted When Access to Enumerate Shares is Revoked</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14824 20963 - FSAA Failed to Copy Tier 2: Prop db was being compressed during non-permission scans</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14921 FSAA scans throws a null reference exception when access is denied on the target host</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14898 FSAC Scans not cycling through proxies</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14888 24391 - Foreign Key Constraint Violation</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14854 24061 - FSAC scan does not create _suspend.xml properly</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14966 Fix race condition when creating tier 1 schema in FSAA DC</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14946 24764 - SEEK streaming doesn&#39;t populate gates proxy ID for files</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14973 FSAA: &quot;Created&quot; column is missing from Resources table when schema is created from DC</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14978 Update FSAA scan and bulk import so that create schema is run in the background</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14943 24731 - Update Proxy Service Query Fails</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14802 23668 - FSAA scan fails for NAS devices with scan set to applet mode</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-2883 21474/23308 - Sensitive Data Scan clearing SDD data when changing criteria/SDD Scope Overlap &amp; Save Previous Scan Results</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14680 FSAA Streaming: Deleting share between streams causes an error.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14791 Change FSAA/FSAC to create SQLite temporary files in FSAA folder</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14984 24911 - FSAC | SQLite Locking during bulk import</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14964 24790 - FSAA | SQLite Locking during bulk import</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14485 18434: FSAC Support milliseconds in event timestamps</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14961 Duplicate Gates are Created When T2s are Deleted and Shares Removed</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15033 25120 - Scan aborting on failed login error</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15002 25062 - FS | Unique Key Constraint Violation during StrucMap rebuild</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15022 25144 - Canceling a streaming scan before the target host has been successfully imported results in the inability scan or import that host</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14994 NFS Resources have null GatesProxyIDs when scanning for both CIFS/NFS</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14988 Streaming: OwnerID and RightsProxyID values are null when streaming NFS resources</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14681 23320 - FSAC Import | NFS Activity is collected in SFAM but can&#39;t be imported</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14746 23540 - Limit lifetype of XML Interfaces to avoid application crash with WER</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15069 FSAC Bulk Import Not filtering out old activity Data</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-14993 24957 - Migration Error for Hosts that aren&#39;t in Tier 1</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15131 25758 - GatesProxyIDs are off when scoping is different for FSAA and SEEK scans</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15092 25521 - Null Gates Proxy IDs</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15145 Check tier 2 database schema before bulk import</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15147 Resources have NULL GatesProxyIDs when the NFS export is &#39;/&#39;</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15211 26214 - FSAC processing logs beyond size limit</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15148 25830 - could not initialize with any proxy ... deployment.lock</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15137 25789 - FSAA Prop Database not up to date after successful migration</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15172 25956 - Prevent timeout when deploying applet as scheduled task</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15212 26216 - Access Analyzer - 8.1 FS proxy fails to scan without RPC 135 when running proxy service.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15217 26234 -FSAA | Remove RPC dependency for data deletion query</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15032 24940 -- Add filters for DFS Targets Host List</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15190 Task credential not working properly</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15247 FSAA: FS_DLP_Criteria table inserting incorrect GUID</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15188 26144 - 0-FSDFS System Scans: Error enumerating domain DFS namespaces for domain: The RPC server is unavailable</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-1643 11296 - Improve error logging for FSAA Proxy scanning</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15110 Remove Skip nested shares option</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15136 25760 - FSAA | Make Delete Host query more fault tolerant</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15295 Building DLP Patterns Takes Too Long</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15311 26791 -Update &quot;Cannot find any activity logs&quot; warning</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15354 Add input validation to share include/exclude in FSAA UI</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15346 26986 - FSAA Exclusion/Inclusion using UNC paths not working as expected.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15338 26949 - FS_Migration Job Failing Domain Check</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15388 FSAA/SDD: Performance bug limits scan performance</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15312 26796 - DAG SDD | Support of Files Without Extensions</span></strong><br>�<br>�<br><strong><span style="font-family: calibri,sans-serif;">Changes since last Hotfix</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-������������� SAFS-15353 27010 - FSAA | Error &quot;Invalid discretionary access control list on security descriptor&quot; when security descriptor has no DACL</span></strong><br>�<br><b>Comments:</b><br><strong><span style="color: red;"><span style="font-family: calibri,sans-serif;">THIS HOTFIX REQUIRES AT LEAST HOTFIX SDD_8.1_003 TO BE INSTALLED IF USING SDD.</span></span></strong><br><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;"><a href="https://na55.salesforce.com/articles/General/Hotfix-SDD-8-1-002" target="_blank">https://na55.salesforce.com/articles/General/Hotfix-SDD-8-1-002</a></span></span><br><br>�<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> </p><ol><li>Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there.�
</li><li>Close all instances of Access Analyzer (check task manager under processes for all users)
</li><li>
<strong><span style="font-family: calibri,sans-serif;">Update all DC files in your %SAInstallDir%DC folder</span></strong>
</li><li>
<strong><span style="font-family: calibri,sans-serif;">Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</span></strong>
</li><li><strong><span style="font-family: calibri,sans-serif;">Run the &#39;Update Proxy Service&#39; query under the Maintenance tab in the FSAA data collector against your proxy servers (if running proxy service).</span></strong></li></ol>�<br><b><u><span style="color: red;">ADDITIONAL STEPS IF CURRENT VERSION IS OLDER THAN HOTFIX 59 (FSAA version 8.1.948)</span></u></b> 
<ol><li>Drop the contents located in the FSAA folder of this hotfix into the folder where your tier 2 SQLite databases are located. (By default this will be located in %SAInstallDir%FSAA folder).
</li><li>Run the &#39;GPMFix.ps1&#39; script in PowerShell ISE as an Administrator. Ensure that it runs successfully. (You should see the following message &quot;Script Ran Successfully&quot;).
</li><li>In your tier 1 database run the following script &quot;UPDATE SA_FSAA_Hosts SET AccessUSN = -1, DLPUSN = -1&quot;.
</li><li>Launch Access Analyzer. Run FSAA permission bulk import and FSAA SDD bulk import against your hosts. (No need to re-scan).</li></ol>� 
<table cellspacing="0" cellpadding="0" width="64" border="0"><tbody><tr height="38"><td colspan="1" rowspan="1" height="38" width="64"><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/8.1/SA_8.1_084.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/8.1/SA_8.1_084.zip</a></td></tr></tbody></table><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> Access Analyzer<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> Access Analyzer - DC - FSAA - Activity;Access Analyzer - DC - FSAA - DFS;Access Analyzer - DC - FSAA - Permissions<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.1<br><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAFS-15353<br><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> -	DCFSAA.dll							8.1.979
-	FSAASrv.dll							8.1.979
-	Stealthbits.StealthAUDIT.DataCollectors.FSAA.dll		8.1.979

Other dependencies included:
-	StealthAUDITRPC.exe					8.1.102
-	StealthAUDITRPCClient.dll					8.1.102
-	Stealthbits.StealthAUDIT.DataCollectors.FSAA.RPCClient.dll	8.1.0
-	Stealthbits.StealthAUDIT.DataCollectors.dll			8.1.59
-	INIFileParser.dll						2.5.2
-	FSAAConfig.xml<br><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 2058<br></p>
</body>
</html>