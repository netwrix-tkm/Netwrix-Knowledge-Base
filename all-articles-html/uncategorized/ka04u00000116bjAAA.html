<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firewall rules required by Password Manager</title>
    <meta name="article-id" content="ka04u00000116bjAAA">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="00570000005NmamAAC">
    <meta name="articlecreateddate" content="2020-03-31T18:26:55.000Z">
    <meta name="articlenumber" content="000003580">
    <meta name="createdbyid" content="00570000005NmamAAC">
    <meta name="createddate" content="2023-07-11T11:58:13.000Z">
    <meta name="firstpublisheddate" content="2020-04-01T09:29:46.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA00g000000H9cMCAS">
    <meta name="knowledge-article-id" content="kA00g000000H9cMCAS">
    <meta name="lastmodifiedbyid" content="0054u000007Mj6zAAC">
    <meta name="lastmodifieddate" content="2023-07-11T11:58:31.000Z">
    <meta name="lastpublisheddate" content="2020-04-01T09:29:46.000Z">
    <meta name="meta-description" content="The KB provides the list of necessary ports and protocols required for Netwrix Password Manager.">
    <meta name="meta-title" content="Firewall rules required by Password Manager">
    <meta name="ownerid" content="00570000005NmamAAC">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="2145">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA00g000000H9cMCAS.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Firewall rules required by Password Manager</h1>
    <div>The table below lists all necessary properties for the firewall rules:</div>
<div>

On DMZ:
<table style="width: 700px;" border="1"><thead><tr><th colspan="1" rowspan="1">Type</th><th colspan="1" rowspan="1">Local Ports</th><th colspan="1" rowspan="1">Remote ports</th><th colspan="1" rowspan="1">Remote machine</th><th colspan="1" rowspan="1">Protocol</th><th colspan="1" rowspan="1">Application</th><th colspan="1" rowspan="1">Action</th></tr></thead><tbody><tr><td colspan="1" rowspan="1" style="text-align: center;">Inbound</td><td colspan="1" rowspan="1" style="text-align: center;">80,443</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;">Inbound</td><td colspan="1" rowspan="1" style="text-align: center;">135</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range*</td><td colspan="1" rowspan="1" style="text-align: center;">Backend</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;">Outbound</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">135-139</td><td colspan="1" rowspan="1" style="text-align: center;">Backend, all DCs</td><td colspan="1" rowspan="1" style="text-align: center;">TCP, UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;">Outbound</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">88, 389,464</td><td colspan="1" rowspan="1" style="text-align: center;">All DCs</td><td colspan="1" rowspan="1" style="text-align: center;">TCP, UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;">Outbound</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">DCOM range</td><td colspan="1" rowspan="1" style="text-align: center;">Backend</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;">Outbound</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">53</td><td colspan="1" rowspan="1" style="text-align: center;">DNS</td><td colspan="1" rowspan="1" style="text-align: center;">UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr></tbody></table>
On Backend:
<table style="width: 700px;" border="1"><thead><tr><th colspan="1" rowspan="1">Type</th><th colspan="1" rowspan="1">Local Ports</th><th colspan="1" rowspan="1">Remote ports</th><th colspan="1" rowspan="1">Remote machine</th><th colspan="1" rowspan="1">Protocol</th><th colspan="1" rowspan="1">Application</th><th colspan="1" rowspan="1">Action</th></tr></thead><tbody><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Inbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">DCOM range</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">DMZ</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Inbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">135-139</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">DMZ</td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">TCP, UDP</span></td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Outbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">135-139</td><td colspan="1" rowspan="1" style="text-align: center;">DMZ, all DCs</td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">TCP, UDP</span></td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Outbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">88,389,464</td><td colspan="1" rowspan="1" style="text-align: center;">All DCs</td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">TCP, UDP</span></td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Outbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">53</td><td colspan="1" rowspan="1" style="text-align: center;">DNS</td><td colspan="1" rowspan="1" style="text-align: center;">UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Outbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">All DCs</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Lsass.exe**</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Outbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">25</td><td colspan="1" rowspan="1" style="text-align: center;">Mail server</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr></tbody></table>
On DCs:
<table style="width: 700px;" border="1"><thead><tr><th colspan="1" rowspan="1">Type</th><th colspan="1" rowspan="1">Local ports</th><th colspan="1" rowspan="1">Remote ports</th><th colspan="1" rowspan="1">Remote machine</th><th colspan="1" rowspan="1">Protocol</th><th colspan="1" rowspan="1">Application</th><th colspan="1" rowspan="1">Action</th></tr></thead><tbody><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Inbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">88,389,464</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">DMZ, Backend</td><td colspan="1" rowspan="1" style="text-align: center;">TCP, UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Allow</span></td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Inbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">135-139</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">Backend</td><td colspan="1" rowspan="1" style="text-align: center;">TCP, UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Allow</span></td></tr><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Inbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">RPC dynamics</td><td colspan="1" rowspan="1" style="text-align: center;">RPC range</td><td colspan="1" rowspan="1" style="text-align: center;">Backend</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Lsass.exe**</span></td><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Allow</span></td></tr></tbody></table>
On DNS server:
<table style="width: 700px;" border="1"><thead><tr><th colspan="1" rowspan="1">Type</th><th colspan="1" rowspan="1">Local ports</th><th colspan="1" rowspan="1">Remote ports</th><th colspan="1" rowspan="1">Remote machine</th><th colspan="1" rowspan="1">Protocol</th><th colspan="1" rowspan="1">Application</th><th colspan="1" rowspan="1">Action</th></tr></thead><tbody><tr><td colspan="1" rowspan="1" style="text-align: center;"><span style="text-align: center;">Inbound</span></td><td colspan="1" rowspan="1" style="text-align: center;">53</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">UDP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr></tbody></table>
On Mail server:
<div>
<table style="width: 700px;" border="1"><thead><tr><th colspan="1" rowspan="1">Type</th><th colspan="1" rowspan="1">Local ports</th><th colspan="1" rowspan="1">Remote ports</th><th colspan="1" rowspan="1">Remote machine</th><th colspan="1" rowspan="1">Protocol</th><th colspan="1" rowspan="1">Application</th><th colspan="1" rowspan="1">Action</th></tr></thead><tbody><tr><td colspan="1" rowspan="1" style="text-align: center;">Inbound</td><td colspan="1" rowspan="1" style="text-align: center;">25</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">TCP</td><td colspan="1" rowspan="1" style="text-align: center;">Any</td><td colspan="1" rowspan="1" style="text-align: center;">Allow</td></tr></tbody></table>
</div>
* RPC range is 1024 � 65535 (Windows NT/XP/2003) or 49152 � 65535 (Windows Vista/2008/7/2k8r2)
RPC dynamic port allocation can be reconfigured. Refer the following Microsoft Knowledge Base article: <a href="http://support.microsoft.com/kb/154596" target="_blank">http://support.microsoft.com/kb/154596</a>

**Lsass.exe is %systemroot%System32lsass.exe

</div>
<div>Note: All Inbound and Outbound connections on all servers are blocked if they do not match the rules.</div>
</body>
</html>