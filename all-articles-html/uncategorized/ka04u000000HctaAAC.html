<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emulate IPC$ check in FSAA</title>
    <meta name="article-id" content="ka04u000000HctaAAC">
    <meta name="articlecaseattachcount" content="2">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:32:40.000Z">
    <meta name="articlenumber" content="000007183">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2023-05-08T10:09:58.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:32:40.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000IhCCAU">
    <meta name="knowledge-article-id" content="kA04u0000000IhCCAU">
    <meta name="lastmodifiedbyid" content="0054u000006gSmgAAE">
    <meta name="lastmodifieddate" content="2023-05-08T10:09:58.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:32:40.000Z">
    <meta name="meta-description" content="360008408371">
    <meta name="meta-title" content="Emulate IPC$ check in FSAA">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="7183">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IhCCAU.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Emulate IPC$ check in FSAA</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> How to run a check to emulate use in FSAA system scan CIFS/SMB</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Assist with troubleshooting FSAA scans..</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> The script was written to emulate the IPC$ check in FSAA system scan when CIFS/SMB are targeted. We are utilizing the windows API to call the CREATEFILE windows function in order to open a file or I/O device.<br>�<br><strong>Steps to run script</strong>�</p>
<ul><li>Launch PowerShell with Admin rights</li><li>Run the script</li><li>Input the desired File or path</li><li>Result should reflect whether file or path is valid or invalid. ( <em>If the result is Valid, it means that the File or path exist and we can read from it</em> )</li></ul>
<p><strong>File Link</strong> : <span style="color: #1f497d;"><a href="http://downloads.stealthbits.com/access/files/StealthTOOLS/AUDIT/CreateFile%20Script/CreateFile-FSAA.ps1" target="_blank">http://downloads.stealthbits.com/access/files/StealthTOOLS/AUDIT/CreateFile%20Script/CreateFile-FSAA.ps1</a></span>�<br><br>*** Additional Information ***<br>�<br><strong><em>Information regarding ISCLOSED message in the result of the scrip: </em>�</strong>ISCLOSED value relates to the file handle closing. TRUE = handle is closed� , FALSE = Handle Open.<br>�<br><em>When an application is finished using the object handle returned by <strong>CreateFile</strong>, use the <a href="https://msdn.microsoft.com/9b84891d-62ca-4ddc-97b7-c4c79482abd9" target="_blank">CloseHandle</a> function to close the handle. This not only frees up system resources, but can have wider influence on things like sharing the file or device and committing data to disk. </em><br>�<br>For more information regarding the file and I/O devices supported please check<br><a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea" target="_blank">https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea</a><br><br><span style="color: red;">I have attached screenshots from a valid and not valid returns. </span><br><br><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LcaVw&amp;d=%2Fa%2F4u000000LysS%2FNTl5KUigBNE6vH24U2YV8jedwlTXlx9yuJ12neuvrTY&amp;asPdf=false" alt="mceclip0.png"></img><br><br><br>�</p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Activity;SA - DC - FSAA - DFS;SA - DC - FSAA - Permissions<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.1+<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2094</p>
</body>
</html>