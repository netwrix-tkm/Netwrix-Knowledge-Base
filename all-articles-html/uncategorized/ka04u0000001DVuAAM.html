<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FSAA Scan Modes and Log Locations</title>
    <meta name="article-id" content="ka04u0000001DVuAAM">
    <meta name="articlecaseattachcount" content="1">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:41:33.000Z">
    <meta name="articlenumber" content="000007320">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2022-02-01T18:41:33.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:41:34.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000Iv3CAE">
    <meta name="lastmodifiedbyid" content="0054u000006god6AAA">
    <meta name="lastmodifieddate" content="2022-02-01T18:41:34.000Z">
    <meta name="lastpublisheddate" content="2022-02-01T18:41:34.000Z">
    <meta name="meta-description" content="360008408371">
    <meta name="meta-title" content="FSAA Scan Modes and Log Locations">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="FSAAScanModesandLogLocations61f97edd500d1">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot; &quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>FSAA Scan Modes and Log Locations</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Where FSAA keeps tier 2 databases and logs for each of the scan modes.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> There are several different scan modes that the FSAA data collector can leverage.<br><br>The location of the tier 2 databases and applet logs will vary, depending on that mode.<br><br>This article assumes that StealthAUDIT was installed to a path ending in \StealthAUDIT\.<br>Otherwise, the FSAA folder would actually be located in \StealthAUDIT\FSAA in the parent folder of the installation directory.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong></p>
<div>
<strong><span style="color: #1f4e79;">Local Mode</span></strong><br><span style="color: #1f4e79;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">(An active network connection is used to stream the data between the target)</span></span></span><br><span style="color: #1f4e79;">Tier 2s are built locally on the StealthAUDIT console while the scan is running.� </span><br><span style="color: #1f4e79;">Applet logs are stored on the StealthAUDIT console&#39;s FSAA folder</span><br><span style="color: #1f4e79;">%sainstalldir%FSAA������� (if using the default installation directory: C:\Program Files (x86)\STEALTHbits\StealthAUDIT\FSAA)</span><br>�</div>
<p><strong><span style="color: #1f4e79;">Applet Mode</span></strong><br><span style="color: #1f4e79;">(An applet is deployed to the target and the scan runs on the target instead of streaming data over the network.)</span><br><span style="color: #1f4e79;">Tier 2 databases are sent to the <strong>target </strong>server, if they exist on the StealthAUDIT console, otherwise, they�are built on the target host. �(See bottom of article for more detail.)<br>In either case, they are then zipped and copied back to the StealthAUDIT console&#39;s FSAA folder when the scan is finished.� </span><br><br><span style="color: #1f4e79;">Applet logs are stored in the FSAA folder on the <strong>target </strong>host:�<br>It tries to read &quot;HKLM\ SYSTEM\CurrentControlSet\Control\Session Manager\Environment\SAInstallDIr&quot; registry first<br>if that doesn&#39;t exist then default path is C:\Program Files (x86)\STEALTHbits\StealthAUDIT\FSAA</span><br><br><strong><span style="color: #1f4e79;">Proxy Mode</span></strong><br><span style="color: #1f4e79;">(Scans are performed from a remote proxy server to help distribute resources and localize scans geographically to improve performance for large deployments and slow links.)</span><br><span style="color: #1f4e79;">Tier 2 databases are sent to the <strong>proxy </strong>server, if they exist on the StealthAUDIT console, otherwise, they�are built on the proxy. �(See bottom of article for more detail.)<br>In either case, they are then zipped and copied back to the StealthAUDIT console&#39;s FSAA folder when the scan is finished.� </span><br><br><span style="color: #1f4e79;">Applet logs are stored in the FSAA folder on the <strong>proxy </strong>host:�<br>It tries to read &quot;HKLM\ SYSTEM\CurrentControlSet\Control\Session Manager\Environment\SAInstallDIr&quot; registry first<br>f that doesn&#39;t exist then default path is C:\Program Files (x86)\STEALTHbits\StealthAUDIT\FSAA</span><br><br><span style="color: #1f4e79;">Proxy mode can work one of two ways:</span></p>
<ol><li>���� <span style="color: #1f4e79;">Standard Proxy mode:� an applet is sent from StealthAUDIT to the proxy server and started through a remote scheduled task.� </span>
</li><li>���� <span style="color: #1f4e79;">FSAA as a service: FSAA is installed on the proxy server and constantly runs as a service instead of an applet�<br></span><span style="color: #1f4e79;">The up to date FSAA proxy installed is available for each supported StealthAUDIT version from our website.<br>Log in to <a href="http://www.stealthbits.com" target="_blank">www.stealthbits.com</a> and navigate to &quot;Product downloads&quot;</span>
</li></ol>
<p><span style="color: #1f4e79;">https://www.stealthbits.com/product-downloads</span></p>
<p><span style="color: #1f4e79;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">In either of these modes, FSAA uses a local mode style connection between the proxy and the target, meaning�an active network connection is used to stream the data between the target and the proxy instead of an applet being deployed to the target. �</span></span></span><br>�<br><span style="color: #2e75b5;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 14pt;">Conditions for sending tier2 from SA console to Proxy/Target server in 7.1+ FSAA</span></span></span><br><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">FSAADC collects GUID, USN and� ScanCompleted value from TBL_FSAA_Sequence table from Proxy or Target server(let&#39;s call it RemoteGUID, RemoteUSN and RemoteScanCompleted) and collects GUID, USN and ScanCompleted value from TBL_FSAA_Sequence table from local SA console(LocalGUID, LocalUSN and LocalScanCompleted).</span></span></span><br>�<br><span style="color: black;">1.</span>������ <span style="color: black;">RemoteGUID is blank or</span><br><span style="color: black;">2.</span>������ <span style="color: black;">RemoteGUID is not equal to LocalGUID or</span><br><span style="color: black;">3.</span>������ <span style="color: black;">RemoteUSN is not equal to LocalUSN or</span><br><span style="color: black;">4.</span>������ <span style="color: black;">RemoteScan is not completed <strong>and </strong>Local Tier 2 is newer than Remote Tier 2 (based on TBL_FSAA_Status.ScanTime)<br>5.</span>� � � �Remote Tier 2s have the correct user version<br>�<br><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">If one of the above condition is true then DCFSAA sends the Tier 2s from SA to the Proxy or Target server.</span></span></span><br>�<br><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">FSAA applet unzips the Tier 2s on Proxy/Target server and replace local tier2, which is on Proxy or Target, with File from zip only if file from zip is newer than local file.</span></span></span><br>�<br><span style="color: #2e75b5;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 14pt;">How FSAA Determines if it should run a scan</span></span></span><br><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">FSAA first checks:</span></span></span></p>
<div style="margin-left: 40px;"><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">No Tier 2s exist<br>previous scan wasn&#39;t completed<br>Tier 2s are older than the value for &quot;Restart Incomplete Scan After...&quot; (or if it&#39;s set to 0)</span></span></span></div>
<p><br><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">If <strong>none </strong>of the above conditions are met, it will start a new scan, unless one of the following conditions are met:�</span></span></span></p>
<div style="margin-left: 40px;"><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">Host is not present in SA_FSAA_Hosts, meaning that host has never had a bulk import<br>Tier 1&#39;s GUID no longer matches Tier 2&#39;s GUID (meaning Tier 1 and 2 have different data. �they need to match. �more detail on this below)<br>Tier 2&#39;s USN is &gt; Tier 1&#39;s USN, meaning there is data for bulk import (this only applies to activity or sensitive data?)</span></span></span></div>
<p><br><span style="color: #2e75b5;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 14pt;">Tier 1 vs. Tier 2 GUID Mismatch</span></span></span><br><span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">Tier 1 and 2 need to match because FSAA uses numbers to identify objects, such as folders or users. �<br>If the tier 1 and 2 GUIDs don&#39;t match, we can&#39;t know that those numbers represent the same object from tier 1 to tier 2, making the scan data invalid. �<br><br>If there is only permission information in Tier 1 for that host, and FSAA detects a GUID mismatch, it will automatically clear Tier 1 for that host, and import the new Tier 2 data. �<br>If there is activity data, it will throw an error telling the user to contact support, preventing any further action. �<br>(this shouldn&#39;t happen, but it does, and we need to do our best to identify why and prevent it going forward. �<br>the only solution to this is to </span></span></span></p>
<div style="margin-left: 40px;">
<span style="color: black;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 11pt;">1)�back up the customer&#39;s data, either by a full db backup or select * into ActivityBackupTable from SA_FSAC_ActivityEventsView�<br>2) drop the existing data for that host (7.2 and newer has a query category in the FSAA for this)<br>3) remove Tier 2s from SA Console, Proxy, and Target (where applicable)�<br>4) re-scan</span></span></span>�</div>
<div>
<br><span style="color: #2e75b5;"><span style="font-family: calibri,sans-serif;"><span style="font-size: 14pt;">Moving the location of the FSAA folder on proxy or target servers</span></span></span>
</div>
<div style="margin-left: 40px;">
<span style="font-size: 11pt;font-family: calibri, sans-serif;color: #1f4e79;">1) Move your FSAA folder on the target machine to where you want it located.� It must be within a folder named StealthAUDIT.��</span><br><span style="font-size: 11pt;font-family: calibri, sans-serif;color: #1f4e79;">2) Update the SAINSTALLDIR environment variable on the target machine to point to your new StealthAUDIT folder from above.��</span>
</div>
<div style="margin-left: 80px;">
<span style="font-size: 11pt;font-family: calibri, sans-serif;color: #1f4e79;">The default for this path is�</span><span style="color: #1f4e79;">C:\Program Files (x86)\STEALTHbits\StealthAUDIT\<br>The data collector references�%SAInstallDir%\..\StealthAUDIT\FSAA<br>That means that it will remove the last folder from the %sainstalldir% path, and will add the StealthAUDIT\FSAA<br>(eg. If your %sainstalldir% is set to D:\temp, your FSAA Tier 2s will be stored in D:\StealthAUDIT\FSAA.)</span>
</div>
<div>
<img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LcTO4&amp;d=%2Fa%2F4u000000Lz57%2FYX0cfP2hST42lVPfGbYcLalgstm.tChgcGjth.I7Ydg&amp;asPdf=false" alt="mceclip0.png"></img><br>�</div>
<div>�</div>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Activity;SA - DC - FSAA - DFS;SA - DC - FSAA - Permissions;SA - DC - FSAA - Sensitive Data<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1290</p>
</body>
</html>