<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Upgrade to Gen7 Agents using an automated batch file - Windows</title>
    <meta name="article-id" content="ka0Qk000000Dk3TIAS">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-07T00:44:10.000Z">
    <meta name="articlenumber" content="000008168">
    <meta name="article-drafts-folder" content="https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA04u0000000JXWCA2">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2025-05-09T04:13:41.000Z">
    <meta name="firstpublisheddate" content="2022-02-07T00:44:10.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000JXWCA2">
    <meta name="knowledge-article-id" content="kA04u0000000JXWCA2">
    <meta name="lastmodifiedbyid" content="0054u0000093LZ4AAM">
    <meta name="lastmodifieddate" content="2025-05-09T04:18:22.000Z">
    <meta name="lastpublisheddate" content="2022-06-29T14:14:44.000Z">
    <meta name="meta-description" content="HELPDESK">
    <meta name="meta-title" content="How to Upgrade to Gen7 Agents using an automated batch file - Windows">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="8168">
    <meta name="versionnumber" content="5">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000JXWCA2.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>How to Upgrade to Gen7 Agents using an automated batch file - Windows</h1>
    <p>This document will show you how to upgrade your Netwrix Change Tracker 6.5 Agents to the Netwrix Gen7 Agents in Windows based operating systems using a batch file and a shared directory.</p><h2 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-Pre-Stagingguide">Pre-Staging guide</h2><p>You will need to configure the following prior to attempting this</p><ol><li>Create a Share directory with a folder in it named &quot;Netwrix Change Tracker&quot;<br><br></li><li><p class="auto-cursor-target">Download the following zip file, and extract it. Copy the &quot;gen7upgrade-windows-new&quot; folder into the &quot;Netwrix ChangeTracker&quot; Shared folder created above.<strong> NOTE: This folder contains all installers, batch files, and required files for the installation. Please copy its entirity to the created drive.<br><br></strong></p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><p class="title">ZIP Folder to Download &amp; Notepad ++</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p><br></p><p>Here is the Zip Folder containing the upgrade files and script:<span style="color: rgb(255,0,0);"><strong>NOTE - THE NPP EXE INSTALLERS ARE FOR NOTEPAD++ NOT CHANGE TRACKER. THE CHANGE TRACKER FILES ARE IN THE .ZIP FILE.</strong></span><br><br></p><p>      <span class="confluence-embedded-file-wrapper conf-macro output-inline"><a class="confluence-embedded-file" href="/wiki/download/attachments/58294273/gen7upgrade-windows-new.zip?version=1&amp;modificationDate=1507836901317&amp;cacheVersion=1&amp;api=v2" target="_blank"><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdJrz&amp;d=%2Fa%2F4u000000Lzsd%2FBurJF_bIoNw3JzJwCGWLeAlup_tkmAgHLN1IPXnwX_M&amp;asPdf=false" height="250"></img></a></span>        <span class="confluence-embedded-file-wrapper conf-macro output-inline"><a class="confluence-embedded-file" href="/wiki/download/attachments/58294273/npp.7.5.1.Installer.exe?version=1&amp;modificationDate=1507839781263&amp;cacheVersion=1&amp;api=v2" target="_blank"><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNF&amp;d=%2Fa%2F4u000000LzTh%2FZTzAI3OK607reHMqz1LqP8NvNZBhO.B0tWayN5Mq10M&amp;asPdf=false" height="250"></img></a></span>       <span class="confluence-embedded-file-wrapper conf-macro output-inline"><a class="confluence-embedded-file" href="/wiki/download/attachments/58294273/npp.7.5.1.Installer.x64.exe?version=1&amp;modificationDate=1507840012076&amp;cacheVersion=1&amp;api=v2" target="_blank"><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNF&amp;d=%2Fa%2F4u000000LzTh%2FZTzAI3OK607reHMqz1LqP8NvNZBhO.B0tWayN5Mq10M&amp;asPdf=false" height="250"></img></a></span></p><p></p></div></div></li><li>Once you have copied the folder to the share drive, exploring the folder you will discover the following sub-directories:<br><ol><li><strong>Installers </strong>- This contains the latest Gen7 Agent Installer, and the required Microsoft C++ Redistributable installation files.</li><li><strong>update-logs</strong> - The batch file has a built in logging mechanism. The devices the script is run on will create a log file within this directory. That files name will be whatever the device&#39;s computer name is. Example: &quot;MyComputerName.log.&quot; This can help troubleshoot in case an upgrade doesnt start or complete correctly.</li></ol></li></ol><p><br></p><h2 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-ModifyingtheBatchFileGuide">Modifying the Batch File Guide</h2><p>Once you have completed the above steps, you can now move onto editing the batch file.</p><ol><li>We highly recommend using a third party text editor to do this to make the process easier. This application is called Notepad++ and can be downloaded from its official home page -<a class="external-link" href="https://notepad-plus-plus.org" target="_blank">https://notepad-plus-plus.org</a>or in the above downloads section.<br><br></li><li>within the gen7upgrade-windows-new folder - you right click the &quot;agent-gen7upgrade-windows.bat&quot; file and click on &quot;Edit with Notepad++&quot; - If you are using the standard microsoft notepad, just click on &quot;Edit&quot;<br><br></li><li>There are several things that need to be changed.<ol><li style="margin-left: 0.0px;">You will need to change the share folder location for all of the paths containing &quot;\\mysharefolder&quot; to your shared location</li><li style="margin-left: 0.0px;">You will need to change the installer switches to match your environment -/UseNewHub=true /HUBURL=<a class="external-link" href="https://localhost/api" target="_blank">https://localhost/api</a> /HUBUSERNAME=agent /HUBPASSWORD=passWord121 /SP- /VERYSILENT /SUPPRESSMSGBOXES /NORESTART<br><br></li></ol></li><li>Using Windows Notepad, you will have to do the above steps manually. We can make this process a lot faster using Notepad++ However.<br><br></li><li><p class="auto-cursor-target">To complete Step 3-a above, we can do a &quot;Ctrl+F&quot; in Notepad++ and go to the &quot;Replace&quot; Tab</p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><p class="title">Replace Tab</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p><br></p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNK&amp;d=%2Fa%2F4u000000LzcT%2Ff0nMeeXKFKrw3nHCQXH53WslMaTewNsxanWBJOw78tc&amp;asPdf=false"></img></span><br><br></p></div></div></li><li><p class="auto-cursor-target">in the &quot;Find What&quot; field, type in &quot;\\mysharefolder\NNT Change Tracker\&quot; and in the &quot;Replace with&quot; filed, type in your share location and then click the &quot;Replace All&quot; button - Example &quot;\\CHGTRKSRV01\DATA\NNT Change Tracker\&quot;</p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><p class="title">Replacing Default Text</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p><br><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNP&amp;d=%2Fa%2F4u000000LzRu%2Fs0.kBTGPEJCva3.8s6HK2k4O1f_xXkMO7.6mS1f.C2A&amp;asPdf=false"></img></span></p><p><br></p></div></div></li><li>This should have replaced all of the directory locations as you specified.<br><br></li><li>Next, you will have to modify the installer properties for the following information<ol><li style="margin-left: 0.0px;">/HUBURL - This is the location of your Netwrix Server - you can use Fully Qualified Domain Name, or IP Address</li><li style="margin-left: 0.0px;">/HUBUSERNAME - This is the username defined in Change Tracker for the agents to use to authenticate to the hub. By default, this is &quot;agent&quot; and in the script can be left alone if you have not changed it on the Change Tracker Hub.</li><li style="margin-left: 0.0px;">/HUBPASSWORD - This is the password for the Change Tracker Agent account to authenticate to the hub, by default this is &quot;passWord121&quot; and in the script can be left alone if you have not changed it on the Change Tracker Hub.</li><li style="margin-left: 0.0px;">/THUMBPRINT - If you have a custom IIS - SSL certificate, you will need to add this option and input your custom certificate &quot;Thumbprint&quot; here.<br></li></ol></li><li>Again, we can use Notepad++ to modify these using the replace tab, if you are using Windows notepad, you will need to manually modify this.<br><br></li><li>In the script, these values are currently set to the following:<ol><li style="margin-left: 0.0px;">&quot;\\mysharefolder\NNT Change Tracker\gen7upgrade-windows\Installers\nnt-changetracker-Gen7Agent-7.0.0.29-98.exe&quot; /UseNewHub=true <span style="color: rgb(255,0,0);">/HUBURL=<span class="nolink">https://localhost/api</span> /HUBUSERNAME=agent /HUBPASSWORD=passWord121</span> /SP- /VERYSILENT /SUPPRESSMSGBOXES /NORESTART<br><br></li></ol></li><li>If you need to add a thumbprint, please remember to add it after the password - Example:<span style="color: rgb(255,0,0);">/HUBPASSWORD=passWord121 /THUMBPRINT=a3e3f5e15e48e7e7e7e8e89e5e<span style="color: rgb(0,0,0);">/SP- /VERYSILENT<br><br></span></span></li><li>To do this using the replace, copy and paste the current script options, and modify them as I have in the example below. My server had the following settings: <span style="color: rgb(255,0,0);">/HUBURL=<span class="nolink">https://192.168.2.50/api</span>/HUBUSERNAME=agent /HUBPASSWORD=n3Wp@ssw0rd121</span><ol><li><p class="auto-cursor-target"><span style="color: rgb(255,0,0);margin-left: 0.0px;"><span style="color: rgb(0,0,0);">Note - Since I didnt have a thumbprint, I did not add the /THUMBPRINT options.</span><br></span></p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><p class="title">ZIP Folder to Download</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><br><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKI7&amp;d=%2Fa%2F4u000000LzrM%2FzLduCQxWG6lGTNrAS9MLMz_CBp.IFCI_GPFbciQLIow&amp;asPdf=false"></img></span><br><br></div></div></li></ol></li><li>Once you click &quot;Replace All&quot; you are all set. Make sure you save your work and you can proceed with the deployment.</li></ol><p><br></p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><p class="title">Deployment Options</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p><br>From this point, you can deploy this using one of many ways, however, here is some ways our other clients have deployed it:</p><p>      1 - Using Group Policy, have the script run at start up to the correct group of computers.</p><p>      2 - Using Group Policy, have the &quot;agent-gen7upgrade-windows.bat&quot; file be placed in a specific directory, then have someone manually run the file as administrator on each device</p><p>      3 - Deploy using other managment tools<br><br></p></div></div><h2 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-UnderstandingtheScriptLogic">Understanding the Script Logic</h2><p>This section will help you understand the actual logic in the script.</p><p><br></p><h4 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-Section1-Thebeginningofthescript">Section 1 - The beginning of the script</h4><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNU&amp;d=%2Fa%2F4u000000LzlY%2F45DnD5s3He5pspe6VeNmQp31grfyoVuz2RYCPBCE5pQ&amp;asPdf=false"></img></span></p><p>The script begins by doing an echo, which is what is used as the logging mechanism. It then checks to se if the Gen7Agent executable is on the system. This is to make sure it doesnt run on a system that already has it.</p><p>If the system does not have the executable - it will go to the &quot;START&quot; Section. If it does have the executable, it will go to the &quot;END&quot; section.</p><p><br></p><h4 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-Section2-TheSTARTsection">Section 2 - The START section</h4><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdK90&amp;d=%2Fa%2F4u000000LzsZ%2F7jlXBk25xqDyQjWAZwuQUVLE2bo.34aYJoUQjltrqjM&amp;asPdf=false"></img></span></p><p><br></p><p>This section does all the installations once the system determines that the agent is not already installs. It first disables the old agent service, installs the C++ Redistributable, installs the Gen7 Agent with the custom hub variables discussed above, starts the redis service, then starts the gen7agent service. At the end it will go to the &quot;Finished&quot; section, which just skips the &quot;END&quot; Section described below, and exits the script.</p><h4 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-Section3&amp;4-TheENDsectionandFINISHEDsection">Section 3 &amp; 4 - The END section and FINISHED section</h4><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNZ&amp;d=%2Fa%2F4u000000Lzsi%2FNHqK1woOxMn5ogUqzu9aFfxXLHToCPDGe5sHH0sXMH8&amp;asPdf=false"></img></span></p><p>The end section simply writes within the agent log in the share folder where the log directory resides that was prepackaged in the Zip file that the agent service already exists, and then exits the script. The &quot;Finished&quot; section skips the END section so that when new installations occur, you will not get the &quot;agent already exists&quot; message. The script will then exit.</p><h2 id="HowtoUpgradetoGen7Agentsusinganautomatedbatchfile-Windows-Relatedarticles">Related articles</h2><p></p><p>











</p><ul class="content-by-label conf-macro output-block"><li>
        <div>
                <span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span>        </div>

        <div class="details">
                                    <a href="https://kb.netwrix.com/8164" target="_blank">How to Add Palo Alto Device to a Proxy Agent as a Proxy Device in Change Tracker Gen7</a>
                        
                        
                    </div>
    </li><li>
        <div>
                <span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span>        </div>

        <div class="details">
                                    <a href="https://kb.netwrix.com/8273" target="_blank">Supporting Documents for Hub Server Problems</a>
                        
                        
                    </div>
    </li><li>
        <div>
                <span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span>        </div>

        <div class="details">
                                    <a href="https://kb.netwrix.com/8368" target="_blank">Change Tracker Gen 7 Change Log / Update Log / ReadMe.txt Documents for Agent/Hub</a>
                        
                        
                    </div>
    </li><li>
        <div>
                <span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span>        </div>

        <div class="details">
                                    <a href="https://kb.netwrix.com/8307" target="_blank">Rolling-Log Fix: &quot;Hub Offline, connection retries exhausted (The remote server returned an error: (403) Forbidden.)&quot;</a>
                        
                        
                    </div>
    </li><li>
        <div>
                <span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span>        </div>

        <div class="details">
                                    <a href="https://kb.netwrix.com/8287" target="_blank">Rolling-Log Fix: ERROR &quot;HubDetails - Crypto error. Has the agent process account changed since the password data was entered?&quot;</a>
                        
                        
                    </div>
    </li></ul>
<p><br></p> <br><b>Attachments:</b><br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNj&amp;d=%2Fa%2F4u000000LzcX%2FsSCoksDFxiuNC5xtlWxYMdjJ94_XbC7zcPxJjbBA1oI&amp;asPdf=false" target="_blank">8.PNG</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNo&amp;d=%2Fa%2F4u000000LzpM%2FpH_3Bl990_yGjc58.i66Sbq3vZzJetZ64rSZDFVFJoA&amp;asPdf=false" target="_blank">5.PNG</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNt&amp;d=%2Fa%2F4u000000Lzt7%2FT47BKbdklSkjk0gGP8_KWGmmX9LHIG2J1d9R5M5DYIs&amp;asPdf=false" target="_blank">4.PNG</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdK6f&amp;d=%2Fa%2F4u000000Lzli%2FFis.mBu0Qk_xIj38HGEiLkf6KdcI.1tx_fPYkHp_GGY&amp;asPdf=false" target="_blank">npp.7.5.1.Installer.x64.exe</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKNy&amp;d=%2Fa%2F4u000000LzSo%2F.3i2rL5mSMJXaWZF_QE6Rv6itJknhu6LTRmkxQaTRVA&amp;asPdf=false" target="_blank">npp.7.5.1.Installer.exe</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdJsP&amp;d=%2Fa%2F4u000000Lzh7%2FYe0KQER6MjghmC67U0W0wmx7OgIqZnqbAv_1gDGZndw&amp;asPdf=false" target="_blank">3.PNG</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdJtx&amp;d=%2Fa%2F4u000000LztC%2FflSzyIuom8flB8lt_I8HIk_UlAXYbzLtwlM5cI56UYU&amp;asPdf=false" target="_blank">2.PNG</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdKLU&amp;d=%2Fa%2F4u000000LzZi%2FJ5kM0eIDWL4lV7sf9ta8vaN95GwFEVvmJyZP2ZA34xs&amp;asPdf=false" target="_blank">1.PNG</a> <br><a href="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LdK5m&amp;d=%2Fa%2F4u000000LztH%2Fd0ypdtCnvfBvvD1Sc7FrRGnXuU8JPnOJ7DzaUPVzGZk&amp;asPdf=false" target="_blank">gen7upgrade-windows-new.zip</a> <br>
</body>
</html>