<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to run a custom powershell script with elevated privileges in a playbook</title>
    <meta name="article-id" content="ka04u000000HdClAAK">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006RPEQAA4">
    <meta name="articlecreateddate" content="2022-04-21T21:16:38.000Z">
    <meta name="articlenumber" content="000008418">
    <meta name="createdbyid" content="0054u000006RPEQAA4">
    <meta name="createddate" content="2023-05-08T10:18:54.000Z">
    <meta name="firstpublisheddate" content="2022-04-21T21:16:42.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000K7UCAU">
    <meta name="knowledge-article-id" content="kA04u0000000K7UCAU">
    <meta name="lastmodifiedbyid" content="0054u000006gSmgAAE">
    <meta name="lastmodifieddate" content="2023-05-08T10:18:55.000Z">
    <meta name="lastpublisheddate" content="2022-04-21T21:16:42.000Z">
    <meta name="meta-description" content="A custom powershell script that requires elevated privilege&#x27;s will not run, even if the credential profile has elevated privilege&#x27;s.">
    <meta name="meta-title" content="How to run a custom powershell script with elevated privileges in a playbook">
    <meta name="ownerid" content="0054u000006RPEQAA4">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="8418">
    <meta name="versionnumber" content="1">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000K7UCAU.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>How to run a custom powershell script with elevated privileges in a playbook</h1>
    <span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;"><b><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">Summary:</span></span></span></b><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">�How to run a custom powershell script with elevated privileges in a playbook</span></span></span></span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;">�</span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;"><b><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">Issue:�</span></span></span></b><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">A custom powershell script that requires elevated privilege&#39;s will not run, even if the credential profile has elevated privilege&#39;s.</span></span></span></span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;">�</span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;"><b><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">Instructions:</span></span></span></b>��</span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">1. Upgrade the customer to 2.7 SP1 HF8 or greater</span></span></span></span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">2. In the actions Credential Profile select a profile that has elevated privileges.</span></span></span></span></span></span></span><br><span style="font-size: 11pt;"><span style="background: white;"><span style="line-height: normal;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 11.5pt;"><span style="font-family: Montserrat;"><span style="color: #1d1d1d;">3. Put this line of code at the start of the script, and paste the rest of the former script into the code block.</span></span></span></span></span></span></span>
<div style="border: solid #dddddd 1.0pt;padding: 8.0pt 11.0pt 8.0pt 11.0pt;"><span style="background: #f7f7f7;"><span style="font-size: 11pt;"><span style="background: #f7f7f7;"><span style="line-height: normal;"><span style="tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Calibri,sans-serif;"><span style="border: solid #dddddd 1.0pt;font-size: 11.5pt;padding: 0in;"><span style="background: #f7f7f7;"><span style="font-family: &quot;Courier New&quot;;"><span style="color: #1d1d1d;">Invoke-WithImpersonation -ScriptBlock { #Insert code in here }</span></span></span></span></span></span></span></span></span></span></div>
<br>�
</body>
</html>