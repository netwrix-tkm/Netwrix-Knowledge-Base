<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SI 7.0.1 AutoSecurityMode_v1.0</title>
    <meta name="article-id" content="ka04u000000Hcm7AAC">
    <meta name="articlecaseattachcount" content="0">
    <meta name="articlecreatedbyid" content="0054u000006god6AAA">
    <meta name="articlecreateddate" content="2022-02-01T18:18:58.000Z">
    <meta name="articlenumber" content="000006518">
    <meta name="createdbyid" content="0054u000006god6AAA">
    <meta name="createddate" content="2023-05-08T10:06:28.000Z">
    <meta name="firstpublisheddate" content="2022-02-01T18:18:59.000Z">
    <meta name="islatestversion" content="true">
    <meta name="knowledgearticleid" content="kA04u0000000IOiCAM">
    <meta name="knowledge-article-id" content="kA04u0000000IOiCAM">
    <meta name="lastmodifiedbyid" content="0054u000006gSmgAAE">
    <meta name="lastmodifieddate" content="2023-05-08T10:06:29.000Z">
    <meta name="lastpublisheddate" content="2022-02-22T13:47:43.000Z">
    <meta name="meta-description" content="360008304132">
    <meta name="meta-title" content="SI 7.0.1 AutoSecurityMode_v1.0">
    <meta name="ownerid" content="0054u000006god6AAA">
    <meta name="recordtypeid" content="0124u000000UUgLAAW">
    <meta name="urlname" content="6518">
    <meta name="versionnumber" content="2">
    <meta name="website-url" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IOiCAM.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>SI 7.0.1 AutoSecurityMode_v1.0</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Documentation for how the new Auto Security Mode in SI v7.0.1 works</p>

<h1 style="text-align: center;"><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Overview</span></span></span></h1>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">There are two security modes in SI 7.0.1:</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Advanced Security mode:</span></span></p>

<ul><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">This mode works the same way as described in SI 7.0.1 documentation.</span></span></li></ul>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Auto Security mode:</span></span></p>

<ul><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">In this mode each component of the system at startup generates new dynamic certificate signed by common for all components root CA certificate and uses these two certificates to setup gRPC communication.</span></span></li><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">All components assume that needed root CA certificate is located in the .\CertsInfo\root.dat file of corresponding component.</span></span></li></ul>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If both .\CertsInfo\root.dat (needed for Auto security mode) and .\CertsInfo\thumbprint.dat (needed for Advanced Security mode) files are present then component will initialize itself in Advanced security mode.</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If none of these files exit then component will not initialize itself and will exit.</span></span><br>�</p>

<h1 style="text-align: center;"><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Application Behavior</span></span></span></h1>

<p>�<span style="font-size: 18pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Server (SI Enterprise Manager) Startup</span></span></span></p>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">1. If there is a file &quot;.\CertsInfo\thumbprint.dat&quot; then initialize gRPC using Advanced security mode in the same way like it works now in SI 7.0.0.</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">2. If there is no &quot;.\CertsInfo\thumbprint.dat&quot; file then check for &quot;.\CertsInfo\root.dat&quot; file.</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">3. If there is no &quot;.\CertsInfo\root.dat&quot; file then exit the process.</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">4. If file &quot;.\CertsInfo\root.dat&quot; exists then read from this file values for Certificate Name, Serial Number, Certificate (including private key). Then generate new certificate signed by certificate from &quot;.\CertsInfo\root.dat&quot; file. Then initialize gRPC with dynamically generated certificate and certificate from &quot;.\CertsInfo\root.dat&quot; file.</span></span><br>�</p>

<h2><span style="font-size: 18pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Client (SI Agent, SI WinConsole, SI Reporting Console) Startup</span></span></span></h2>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">The same logic is applied as for Server.</span></span><br>�</p>

<h2><span style="font-size: 18pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Agent Deployment from WinConsole</span></span></span></h2>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">1. If there is a file \CertsInfo\root.dat then after uploading SI Agent installer but before starting SI Agent installer WinConsole will also upload this file to the same location as SI Agent installer. If such file already exists it must be overwritten.</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">2. After SI Agent installation finished and WinConsole deletes installer it also will delete root.dat file from the same location.</span></span><br>�</p>

<h2><span style="font-size: 18pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Automatic Agent Deployment</span></span></span></h2>

<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">The same logic is applied as for Agent deployment from WinConsole but this will be a part of Enterprise Manager and root.dat file will be taken from� <em>\CertsInfo folder.</em></span></span><br><em>�</em></p>

<h1 style="text-align: center;"><em><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Installer Behavior</span></span></span></em></h1>

<p><em>�<span style="font-size: 18pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">SI Server Installer (StealthINTERCEPT Server.msi)</span></span></span></em></p>

<p><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Enterprise Manager component install:</span></span></em></p>

<ul><li><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If there is a root.dat file in the same folder with SI Server installer then during installation process copy this file to the <em>\CertsInfo folder. This file must be copied before starting SI Enterprise Manager service. If such file already exists it must be overwritten.</em></span></span></em></li><li><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If there is no such file then EM installer will check additionally for existence of these two files:<br>	�- <em>\CertsInfo\thumbprint.dat<br>	�- <em>\CertsInfo\root.dat<br>	If any of these file exists then continue installation. Otherwise generate new &#39;root.dat&#39; and continue installation as described above.</em></em></span></span></em></em></li></ul>

<p><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">WinConsole and Reporting Console component install:</span></span></em></em></em></em></p>

<ul><li><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If there is a root.dat file in the same folder with SI Server installer then during installation process copy this file to the &lt; Destination Folder&gt;\CertsInfo folder of corresponding component. This file must be copied before starting corresponding service or application. If such file already exists it must be overwritten.</span></span></em></em></em></em></li><li><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If there is no root.dat file in the same folder with SI Server installer and if EM component is already installed on this box and there is a file <em>\CertsInfo\root.dat then during installation process copy this file to the \CertsInfo folder of corresponding component. This file must be copied before starting corresponding service or application. If such file already exists it must be overwritten.</em></span></span></em></em></em></em></li></ul>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Uninstall:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">During uninstallation process CertsInfo folder must not be modified.</span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em>�<span style="font-size: 18pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">SI Agent Installer (SI Agent.exe)</span></span></span></em></em></em></em></em></p>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Install:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If there is a root.dat file in the same folder with Agent installer then during installation process copy this file to the \CertsInfo\root.dat. This file must be copied before starting SI Agent service. If such file already exists it must be overwritten.</span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Uninstall:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">During uninstallation process CertsInfo folder must not be modified.</span></span></em></em></em></em></em></li></ul>

<p class="wysiwyg-text-align-center"><em><em><em><em><em><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Possible Scenarios</span></span></span></em></em></em></em></em></p>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">New installation with Advanced security mode:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">User must prepare and pre-configure SI Server box and SI Agent boxes with needed certificates and files and then install components like described in SI 7.0.0 documentation.</span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Upgrade/Reinstall with Advanced security mode:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">User must Upgrade/Reinstall components like described in SI 7.0.0 documentation.</span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">New installation with Auto security mode using custom certificate:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">User must generate new root.dat file and place it to the folder where &#39;StealthINTERCEPT Server.msi&#39; file is located and start installation from this folder.</span></span></em></em></em></em></em></li><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">All Agents will automatically get this file if they will be installed from WinConsole or using Automatic Agent deployment.</span></span></em></em></em></em></em></li><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If user wants to install Agent manually then the same root.dat file which was used for SI Server installation must be copied to the folder with &#39;SI Agent.exe&#39; file and then user can run installer.</span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Upgrade/Reinstall with Auto security mode using custom certificate:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">No any additional steps needed in case if the same location will be used for components.� </span></span></em></em></em></em></em></li><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If user wants to change component location during re-install then before running corresponding installer file root.dat must be copied from \CertsInfo to the folder where component installer is located.</span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">New installation with Auto security mode using automatically generated certificate:</span></span></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">No additional steps needed to install SI Server.</span></span></em></em></em></em></em></li><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">No additional steps needed to install Agents if they will be installed from WinConsole or using Automatic Agent deployment.</span></span></em></em></em></em></em></li><li><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If user wants to install Agent manually then the <em>\CertsInfo\root.dat file must be copied to the folder with &#39;SI Agent.exe&#39; file and then user can run installer.</em></span></span></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Upgrade/Reinstall with Auto security mode using automatically generated certificate:</span></span></em></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">No any additional steps needed in case if the same location will be used for components.� </span></span></em></em></em></em></em></em></li><li><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If user wants to change component location during re-install then before running corresponding installer file root.dat must be copied from \CertsInfo to the folder where component installer is located.</span></span></em></em></em></em></em></em></li></ul>

<h1 style="text-align: center;"><em><em><em><em><em><em><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Appendix #1. Root.dat file format</span></span></span></em></em></em></em></em></em></h1>

<p><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Root.dat file has the following format:</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Name of the Certificate</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Serial Number of the Certificate</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Certificated in PEM format</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Private Key of the Certificate in PEM format</span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Example:</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">CN=SI,DC=SB</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">260448959622822828</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">-----BEGIN CERTIFICATE-----</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">MIIDTDCCAjSgAwIBAgIIA51M8uhwO6wwDQYJKoZIhvcNAQELBQAwITELMAkGA1UE</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">AwwCU0kxEjAQBgoJkiaJk/IsZAEZFgJTQjAgFw0xOTA2MTIwMDAwMDBaGA8yMTE5</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">MDYxMjAwMDAwMFowITELMAkGA1UEAwwCU0kxEjAQBgoJkiaJk/IsZAEZFgJTQjCC</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">ASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKxJu1m78Fv2Hhkxr8yqS+QF</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">89Y20O9sWGJfifg+Yc2hxuoiX/wh6oeLwUbalv7QiDqFxMf+DbJBEpkG118B2qSW</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">wCrl1GmMG78tkCdX4bV4MrVRwWaN9sP0q/3Z29YqdH5/UinLPqI28VqLNANfBOox</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Fvv5jSjdzzjalsxcbPVZQBKve+9YyKggnL8pGxWtNew3aeMQMxyF8B78LhW94K3x</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">idtgWQAc0axjlEU+sdRh23DqtBuh4tNXSd0P1pEP68uUMifVXEcRHRjTXYH1fiBd</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">4cxy4mbc4y7p8rC1/aFkFUVlAMV/Q2Ob+vjGORUtk5lzDu5QpuiJgjFl8+l28Y0C</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">AwEAAaOBhTCBgjBQBgNVHSMESTBHgBR/fpVOvNMvNmlp4CMZyjSrAzGc5qElpCMw</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">ITELMAkGA1UEAwwCU0kxEjAQBgoJkiaJk/IsZAEZFgJTQoIIA51M8uhwO6wwHQYD</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">VR0OBBYEFH9+lU680y82aWngIxnKNKsDMZzmMA8GA1UdEwEB/wQFMAMBAf8wDQYJ</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">KoZIhvcNAQELBQADggEBAIe0UWX/1BgLHOdY0zoI8oILJEo/u8RDsAp9K4owu5yU</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">ou6Q36xBJqMSGGB1uTGLQOqpH3jAtQMHpMmN0tHtnEfiNgJWnQBe5uuBnZukoXrP</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">cDYRmeavi1VCrHIYYlPIfovzVeQyjhqYMEquD/QwyXpAMAI9vBCCK1vD0lCvnOaz</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">7FwLYbX/sdyLpEAEd/cMRr89cu0Kue0qZ58pm24cxQNVFjwIm/v5TUCDTG0r3AD+</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">/ToqhU1mQdvfTAJ3vF/wxIMMKtoBkrOnN33NPz2rhVzynnQ6vtzf7jkEpf2d0IZB</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">hrJ58ZNIWs/zoPT7SIhc585LCyV7E375WUdj5P8Tjf4=</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">-----END CERTIFICATE-----</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">-----BEGIN RSA PRIVATE KEY-----</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">MIIEpAIBAAKCAQEArEm7WbvwW/YeGTGvzKpL5AXz1jbQ72xYYl+J+D5hzaHG6iJf</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">/CHqh4vBRtqW/tCIOoXEx/4NskESmQbXXwHapJbAKuXUaYwbvy2QJ1fhtXgytVHB</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Zo32w/Sr/dnb1ip0fn9SKcs+ojbxWos0A18E6jEW+/mNKN3PONqWzFxs9VlAEq97</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">71jIqCCcvykbFa017Ddp4xAzHIXwHvwuFb3grfGJ22BZABzRrGOURT6x1GHbcOq0</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">G6Hi01dJ3Q/WkQ/ry5QyJ9VcRxEdGNNdgfV+IF3hzHLiZtzjLunysLX9oWQVRWUA</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">xX9DY5v6+MY5FS2TmXMO7lCm6ImCMWXz6XbxjQIDAQABAoIBADSJs3EUx6IzdlA2</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">f6aI0+WwDwBm7OXmAznUao1h8I81YyQo4V5QtWUqMAE8TUldK/20pyJZjbGq+FHj</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">7S9SsGr6cZVjSpf5Gsj8yvXEbdbZ1ZTHXpO4fOSaqwwZMFmpzqZ4iwSlru7mlEkJ</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">JA5XHneQCrNCEVLB+RwcRFoDYVKbqXoThjyQBOa1vWrYVIPrfU2cmr/6w7NcyUXk</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">qft9nvZFC3kSvZ9O7QTlVlfAB2BapYEEyFqUlq3Dt6EFF2u5z3fBNhLHL0UaarDK</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">B/K/L56DfI7B4xBFpD0OmUCLtkv4Pb7DryoTvdq8vJgf0mhnVtBH3Vvw3SNJnsZt</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">HlJnyh0CgYEA4FDa9Mx2xYBqrdkeA6bvOhRT6B3hjtOMFO5wgKxoxlaQHslRbeem</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">/Eiwyuzh3O6on6q5TurV4o+QFwQjRTmlI0kCPnoAEPj78K/iYC0h9PU/0zOCBUsC</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">Tp5m+et+g9R8b0lwJgTRC984d6yVNlJIK9c5niTdwH5JLTzM6A+WLYMCgYEAxJ+T</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">yLuvda0tttYV9leYWKXKoEMvB7Yr8koaAavLM6D/TMmAfgIgSWvQqxMvnLJbU/0X</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">XIOMNLPoiXgjZmfwRQmtWpQoz+tP1NCwn+nqZXI/cB0kpHZyeFlKnktVcIE0vYCo</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">kv8NPUnDruP3l2Af3ZYZcmC28ZVE4OMTXlNPx68CgYEAynqRukjZqRtqsDR8sEU+</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">ScnRl4Npd/giyT4V1UBLb0Tx4KhOVYu2IqIm23WJx1iyYzXDAaZenJyELxJwF+uZ</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">0cj0Opr7dlaZbEAHclMrBKdgDm+/HLIBih/Xyh41XCAwlm/OyLKuVC4RFY12Pst1</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">FAW5n7Oda0VTHn90YsC3CasCgYBoBcS5vhHlv+kfgcO8wDrpK0033FNVURuO44U+</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">vRSUC+kFRtWj1JwgO9n5p/zYecO3e36Qg0f52fR8RgL0eqiy3ZvI//lXhraFcKMA</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">90/6u6a0ObbZC5Ej+plvhYt+Kd0tJJQKsMTgV9YfAJxMiZ5SLMbprCEdTktSbtAg</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">ZxMeIQKBgQCZGQvMrPWRua1x0P0lsZYsVGLK7h6Eol025e1uqsm9wogJ9OmxOiHx</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">oKr0/ah9SUsXFA6d9d1q8n2kuJhIlo/B/f8+ij35PiXyu/pmLzT6x6ZGAtZajaFE</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">OqR0hbymjtDdvyMxu387DpTqC3byRAII7E1y1mjH5eIwyIXWMdWFgw==</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 10pt;">-----END RSA PRIVATE KEY-----</span></span></span><br>�</em></em></em></em></em></em></p>

<h1 style="text-align: center;"><em><em><em><em><em><em><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Appendix #2.�</span></span></span><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Dynamic certificate generation function source code example.</span></span></span> </em></em></em></em></em></em></h1>

<p><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">// generate serial number</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> serialNumber = BigIntegers.CreateRandomInRange(BigInteger.One,</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">BigInteger.ValueOf(Int64.MaxValue), random);</span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">// generate key pair</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> keyGenerationParameters = </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> KeyGenerationParameters(random, 2048);</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> keyPairGenerator = </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> RsaKeyPairGenerator();</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">keyPairGenerator.Init(keyGenerationParameters);</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> keyPair = keyPairGenerator.GenerateKeyPair();</span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">// create Generator</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> certificateGenerator = </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> X509V3CertificateGenerator();</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">// init Generator</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">certificateGenerator.Set... </span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> authorityKeyIdentifierExtension =</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> AuthorityKeyIdentifier(</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">SubjectPublicKeyInfoFactory.CreateSubjectPublicKeyInfo(caKeyPair.Public),</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> GeneralNames(</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> GeneralName(caName)),</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">caSerialNumber);</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">certificateGenerator.AddExtension(X509Extensions.AuthorityKeyIdentifier.Id, </span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">false</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">, authorityKeyIdentifierExtension);</span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> subjectKeyIdentifierExtension =</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> SubjectKeyIdentifier(</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">SubjectPublicKeyInfoFactory.CreateSubjectPublicKeyInfo(keyPair.Public));</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">certificateGenerator.AddExtension(X509Extensions.SubjectKeyIdentifier.Id, </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">false</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">,</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">subjectKeyIdentifierExtension);</span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">certificateGenerator.AddExtension(X509Extensions.BasicConstraints.Id, </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">true</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">, </span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> BasicConstraints(</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">false</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">));</span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">// generate certificate</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">ISignatureFactory signatureFactory = </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> Asn1SignatureFactory(</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #a31515;">&quot;SHA256WithRSA&quot;</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">,</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">caKeyPair.Private, random);</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">var</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> certificate = certificateGenerator.Generate(signatureFactory);</span></span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: green;">// prepare key pair</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">return</span></span></span> <span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> KeyCertificatePair(ObjectToPem(certificate), ObjectToPem(keyPair.Private));</span></span></span></span></span><br>�</em></em></em></em></em></em></p>

<h1 style="text-align: center;"><em><em><em><em><em><em><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">Appendix #3.�</span></span></span><span style="font-size: 20pt;"><span style="color: #1c75bc;"><span style="font-weight: normal;">gRPC credentials initialization source code example.</span></span></span> </em></em></em></em></em></em></h1>

<p><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Server:</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">creds = </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> SslServerCredentials(</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> List { GenerateNewKeyCertificatePair() }, </span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">CA_PEM, SslClientCertificateRequestType.RequestAndRequireAndVerify);</span></span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Client:</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;">creds = </span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: blue;">new</span></span></span><span style="font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: black;"> SslCredentials(CA_PEM, GenerateNewKeyCertificatePair());</span></span></span></span></span><br><br><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Of special note <strong>if doing manual / local install of agent </strong>you must either:</span></span></em></em></em></em></em></em></p>

<ul><li><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">Copy the &#39;root.dat&#39; file from the Enterprise Manager machine (typically &quot;C:\Program Files\STEALTHbits\StealthINTERCEPT\SIEnterpriseManager\CertsInfo\root.dat&quot;) to the same folder as the &quot;SI Agent.exe&quot; - the installer when run will look in its current folder for the file &#39;root.dat&#39; and will copy it as part of running the agent install.</span></span></em></em></em></em></em></em></li><li><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">OR create / ensure the Agents target install path has folder &quot;CertsInfo&quot; with root.dat file in it from EM before running agent installer - the installer also looks here if root.dat is not in same folder as &quot;SI Agent.exe&quot;.� This would be the typical case if manually upgrading from original 7.0.1 agent to a newer build of 7.0.1 agent.</span></span></em></em></em></em></em></em></li></ul>

<p><em><em><em><em><em><em><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">If deploying agent from SI 7.0.1 console then the SI Console does all the above for you as part of deploying a new agent or upgrading from an old agent.</span></span><br>�</em></em></em></em></em></em></p>

<p><em><em><em><em><em><em><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthINTERCEPT<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 7.0.1<br><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> 7.0.1<br><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 000002565</em></em></em></em></em></em></p>
</body>
</html>