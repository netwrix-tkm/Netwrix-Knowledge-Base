<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>High CPU usage on domain controllers</title>
    <meta name="product" content="auditor">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="00570000005NmamAAC">
    <meta name="ArticleCreatedDate" content="2020-03-31T18:26:53.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="00570000005NmamAAC">
    <meta name="CreatedDate" content="2023-05-08T09:50:23.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2020-04-01T09:29:39.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA00g000000H9bjCAC">
    <meta name="Knowledge_Article_ID__c" content="kA00g000000H9bjCAC">
    <meta name="LastModifiedById" content="0054u000006gSmgAAE">
    <meta name="LastModifiedDate" content="2023-05-08T09:50:23.000Z">
    <meta name="LastPublishedDate" content="2020-04-01T09:29:39.000Z">
    <meta name="Meta_Description__c" content="The KB provides troubleshooting when Account Lockout Examiner causes high CPU usage on domain controllers.">
    <meta name="Meta_Title__c" content="High CPU usage on domain controllers">
    <meta name="OwnerId" content="00570000005NmamAAC">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="1371">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA00g000000H9bjCAC.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>High CPU usage on domain controllers</h1>
    After installation of Account Lockout Examiner(ALE) I can see CPU spikes on monitored domain controllers. If I stop ALE, these spikes are gone.

<hr></hr>

<span style="background-color: #ffffff;">ALE tracks for lockout events and failed logon events from the Windows security event log of domain controllers. By default it uses WMI calls that may result in high CPU usage of domain controllers.</span>

<hr></hr>

There are two options to fix the issue:

1. Switch method of communication with domain controllers. In this case ALE will stop querying domain controllers for new events in the log, but domain controllers will notify about new events themselves (WMI feature). This will reduce the number of WMI calls and as a result - reduce CPU usage.

<span style="background-color: #ffffff;">In order to do this perform the following on the machine where ALE is installed:</span>
<ol><li>Run Registry Editor (regedit),</li><li>Go to HKLMSoftware[Wow6432Node]NetWrixAccount Lockout Examiner (Wow6432Node only for x64 OS)</li><li>Create a DWORD called UseWatcher with value to 1</li><li>Restart the Netwrix Account Lockout Examiner service via Services.msc</li></ol>
<img src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000HcUT&amp;feoid=00N0g000004CA0p&amp;refid=0EM7000000052iw" alt="User-added image" width="500" height="161"></img>

2. If the above does not help, disable usage of WMI to communicate with domain controllers. (A <span style="background-color: #ffffff;">.Net-based mechanism will be used for it.)</span>

<span style="background-color: #ffffff;">In order to do this perform the following on the machine where ALE is installed:</span>
<ol><li>Run Registry Editor (regedit),</li><li>Go to HKLMSoftware[Wow6432Node]NetWrixAccount Lockout Examiner (Wow6432Node only for x64 OS)</li><li>Change the UseWMI value to 0</li><li>Restart the Netwrix Account Lockout Examiner service via Services.msc</li></ol>
<img src="https://nwxcorp.file.force.com/servlet/rtaImage?eid=ka04u000000HcUT&amp;feoid=00N0g000004CA0p&amp;refid=0EM7000000052jG" alt="User-added image" width="500" height="245"></img>
</body>
</html>