<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Find Destination of Failed NTLM Logons?</title>
    <meta name="product" content="auditor">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0050g000006HS99AAG">
    <meta name="ArticleCreatedDate" content="2023-10-12T16:21:58.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0050g000006HS99AAG">
    <meta name="CreatedDate" content="2023-10-30T09:59:04.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2023-10-12T16:22:28.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u00000111KxCAI">
    <meta name="Knowledge_Article_ID__c" content="kA04u00000111KxCAI">
    <meta name="LastModifiedById" content="0050g000006HS99AAG">
    <meta name="LastModifiedDate" content="2023-10-30T09:59:20.000Z">
    <meta name="LastPublishedDate" content="2023-10-30T09:59:20.000Z">
    <meta name="Meta_Description__c" content="This article explains how to find origin (destination) of the failed logons occurred through NTL authentication.">
    <meta name="Meta_Title__c" content="How to Find Destination of Failed NTLM Logons?">
    <meta name="OwnerId" content="0050g000006HS99AAG">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="8855">
    <meta name="VersionNumber" content="3">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u00000111KxCAI.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>How to Find Destination of Failed NTLM Logons?</h1>
    <h1>Question</h1>

<div>
<p>How to identify the origin (destination) of the failed logons occurring through NTLM instead of Kerberos? For example, if a system administrator set up some process on a file server that was trying to authenticate over NTLM, which is hitting the Domain Controllers to authenticate and failing to perform said process.</p>
</div>

<h1>Answer</h1>

<div>
<p>Because failed logons occurred through NTLM, the Domain Controllers were not documenting the details of the login attempts origin via event ID 4776 (not 4768/4769/4771), thus there is no information on failed logons&#39; details in logs, such as the originating workstation name or IP address.</p>

<p>To find the actual source of failed logons, enable NTLM auditing temporarily. For that:</p>

<ol><li>
	<p>On the Domain Controller, open the <b>Group Policy</b> snap-in.</p>
	</li><li>
	<p>Expand the <b>Computer Configuration</b> <b>Policies</b> -&gt; <b>Windows Settings</b> -&gt; <b>Security Settings</b> -&gt; <b>Local Policies</b> -&gt; <b>Security Options</b> -&gt; <b>Network Security: Restrict NTLM: Audit NTLM authentication</b>.</p>
	</li><li>
	<p>Set it to <em>enable all</em>, which only enables auditing of NTLM attempts, does not allow or restrict NTLM traffic.</p>
	</li><li>
	<p>Open command prompt as an elevated <em>user/administrator</em> and run the <b>gpupdate /force</b> command so the policy change takes effect on the Domain Controller.</p>
	</li><li>
	<p>The actual NTLM login attempts on the DC are logged here:</p>

	<p><b>Applications</b> -&gt; <b>Microsoft</b> -&gt; <b>Windows</b> -&gt; <b>NTLM</b> -&gt; <b>Operational</b></p>

	<p>Which contains information about the failed logon origin. For example, the name (and I think IP, but cannot guarantee) of a file server.</p>
	</li><li>
	<p>Disable NTLM authentication by unselecting <em>enable all</em> checkbox enabled on the step 3.</p>
	</li><li>
	<p>In the command prompt, run the <b>gpupdate /force</b> command again to turn off the extra auditing on the Domain Controller.</p>
	</li></ol>
</div>

<h2>Related Articles:</h2>
<a href="https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000HNFCA2.html" target="_blank">Why Do I Have Incomplete Information on Failed Logons?</a>.

<p>Â </p>
</body>
</html>