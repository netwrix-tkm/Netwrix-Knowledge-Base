<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exporting and Importing the Database to a New Server</title>
    <meta name="product" content="privilege_secure">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006gpnvAAA">
    <meta name="ArticleCreatedDate" content="2024-02-06T14:02:33.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006gpnvAAA">
    <meta name="CreatedDate" content="2024-02-06T14:02:33.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2024-02-06T14:18:03.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA0Qk0000000RBVKA2">
    <meta name="Knowledge_Article_ID__c" content="kA0Qk0000000RBVKA2">
    <meta name="LastModifiedById" content="0054u000006gpnvAAA">
    <meta name="LastModifiedDate" content="2024-02-06T14:18:03.000Z">
    <meta name="LastPublishedDate" content="2024-02-06T14:18:03.000Z">
    <meta name="Meta_Description__c" content="Exporting and Importing the Database to a New Server">
    <meta name="Meta_Title__c" content="Exporting and Importing the Database to a New Server">
    <meta name="OwnerId" content="0054u000006gpnvAAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="9044">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000000RBVKA2.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Exporting and Importing the Database to a New Server</h1>
    <h1>Overview</h1>
This article outlines the process of exporting your Netwrix Privilege Secure database, and importing it to a new Privilege Secure server.

<p>The data transferred includes:</p>

<ol><li>PostgreSQL Database</li><li>RDP/SSH Recordings</li><li>Configuration files</li><li>Encryption keys</li></ol>

<h1>Instructions</h1>

<h3>On the new server</h3>
    1. Install Netwrix Privilege Secure on the new server.

<h3 id="user-content-on-existing-server">On the existing server</h3>

<ol><li>Stop the following services on the server by running the indicated PowerShell commands:
	<pre>
<code>Stop-Service SbPAM* -Force
Stop-Service W3SVC
Stop-Service postgresql-x64-12
</code></pre>
	</li><li>Create an archive of PostgreSQL database by running the indicated command:<br>	<code>Compress-Archive -Path C:\ProgramData\Stealthbits\Postgres12 -DestinationPath C:\Temp\pg_data.zip -CompressionLevel Optimal</code></li><li>Export the NPS encryption keys, and capture the password generated by the export <em><strong>(note: the keys.exp file created in this step is sensitive and should be deleted after the import is complete)</strong></em>:<br>	<code>&quot;C:\Program Files\Stealthbits\PAM\KeyTools\SbPAM.RotateKey.exe&quot; export -n c:\temp\keys.exp</code></li><li>Create an archive of the NPS configuration files:<br>	<code>Compress-Archive -Path C:\ProgramData\Stealthbits\PAM -DestinationPath C:\Temp\nps_config.zip -CompressionLevel Optimal</code></li><li>Copy <code>pg_data.zip</code>, <code>keys.exp</code>, and <code>nps_config.zip</code> to the new server.</li></ol>

<h2 id="user-content-on-new-server">On new server</h2>

<ol><li>Stop the following services on the server by running the indicated PowerShell commands:
	<pre>
<code>Stop-Service SbPAM* -Force
Stop-Service W3SVC
Stop-Service postgresql-x64-12
</code></pre>
	</li><li>Decompress the configuration files from the original server:<br>	<code>Expand-Archive -Path c:\temp\nps_config.zip -DestinationPath c:\ProgramData\Stealthbits -Force</code></li><li>Decompress the PostgreSQL files from the original server:<br>	<code>Expand-Archive -Path C:\temp\pg_data.zip -DestinationPath c:\ProgramData\Stealthbits -Force</code></li><li>Import the key files from the original server <em><strong>(note: the keys.exp file is sensitive and should be deleted after the import is complete)</strong></em>:<br>	<code>&quot;C:\Program Files\Stealthbits\PAM\KeyTools\SbPAM.RotateKey.exe&quot; import -f -n c:\temp\keys.exp</code></li><li>Start the following services on the server by running the indicatedPowerShell commands:
	<pre>
<code>Start-Service postgresql-x64-12
Start-Service W3SVC
Start-Service SbPAM* -Force</code></pre>
	</li></ol>
</body>
</html>