<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoke Management Shell from PowerShell 7 in v11</title>
    <meta name="visibility" content="public_v">
    <meta name="content_type" content="ct_howto">
    <meta name="former_brand" content="f_imanami">
    <meta name="product" content="groupid">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000008F0JoAAK">
    <meta name="ArticleCreatedDate" content="2024-05-10T12:31:06.000Z">
    <meta name="Article_Drafts_Folder__c" content="https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA0Qk00000015QfKAI">
    <meta name="Article_Reviewer__c" content="0054u000008icp2AAA">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="https://app.asana.com/1/46926129243726/project/1203106155380297/task/1209993441600594?focus=true">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="Validated">
    <meta name="CreatedById" content="0054u000008F0JoAAK">
    <meta name="CreatedDate" content="2025-04-16T19:56:19.000Z">
    <meta name="Draft_Status__c" content="Ready to Publish">
    <meta name="FirstPublishedDate" content="2024-05-10T12:32:16.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA0Qk00000015QfKAI">
    <meta name="Knowledge_Article_ID__c" content="kA0Qk00000015QfKAI">
    <meta name="LastModifiedById" content="0054u000008icp2AAA">
    <meta name="LastModifiedDate" content="2025-04-16T19:56:33.000Z">
    <meta name="LastPublishedDate" content="2025-04-15T18:51:58.000Z">
    <meta name="Meta_Description__c" content="Make a remote connection to Directory Manager Management Shell from regular PS">
    <meta name="Meta_Title__c" content="How To: Invoke Directory Manager Management Shell from Powershell 7 in V11">
    <meta name="OwnerId" content="0054u000008F0JoAAK">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="9162">
    <meta name="VersionNumber" content="3">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk00000015QfKAI.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Invoke Management Shell from PowerShell 7 in v11</h1>
    <h2>Applies To</h2>
<p>Directory Manager 11</p>
<h2>Overview</h2>
<p>This article explains how to remotely invoke the Management Shell from PowerShell 7 in Netwrix Directory Manager version 11. This article covers the process of establishing a remote session, importing the necessary modules, and connecting to an Identity Store using credentials. This method allows administrators to run Directory Manager cmdlets in PowerShell 7 without directly signing into the Directory Manager server.</p>
<h2>Instructions</h2>
<p>Follow the steps below to remotely connect to the Management Shell:</p>
<ol><li>Open <strong>PowerShell 7</strong> as an Administrator.</li><li>Enter the following cmdlet and update the placeholders with the correct values:</li></ol>
<ul><li><code>&quot;DOMAIN\\USERNAME&quot;</code>  Replace with the domain and username of your account.</li><li><code>&quot;USER-PASSWORD&quot;</code>  Replace with your actual password (in plain text).</li><li><code>&quot;YOUR MACHINE NAME HERE&quot;</code>  Replace with the name of the Directory Manager server.</li><li><code>&quot;IDENTITYSTOREID HERE&quot;</code>  Replace with the appropriate Identity Store ID.</li></ul>
<pre class="has-inner-focus"><code>$username = &quot;DOMAIN\USERNAME&quot;
$pass = ConvertTo-SecureString &quot;USER-PASSWORD&quot; -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential ($username, $pass)
$s = New-PSSession -ComputerName &quot;YOUR MACHINE NAME HERE&quot; -Credential $Cred -ConfigurationName PowerShell.7

Invoke-Command -Session $s -ScriptBlock {
  $srcu = [reflection.assembly]::LoadFrom(&#39;C:\Program Files\PowerShell\7\System.Windows.Forms.dll&#39;)
  $OnAssemblyResolve = [System.ResolveEventHandler] {
    param($sender, $e)
    if ($e.Name -like &quot;System.Windows.Forms, Version=*&quot;) {
      return $srcu
    }
    return $null
  }
  [System.AppDomain]::CurrentDomain.add_AssemblyResolve($OnAssemblyResolve)
  $reg = Get-ItemProperty -Path HKLM:SOFTWARE\Microsoft\PowerShell\1\PowerShellSnapIns\Imanami.Groups.Management.PowerShell.Admin11
  $appbase = $reg.ApplicationBase
  Import-Module -Name &quot;$appbase\GroupIDManagementShell\bin\Imanami.GroupID.Management.dll&quot;
  Set-ModulePath -ModulePath &quot;$appbase\GroupIDManagementShell\bin&quot;
}

Import-PSSession -Session $s -Type cmdlet -AllowClobber
Connect-IdentityStore -mode &quot;2&quot; -IdentityStoreID &quot;IDENTITYSTOREID HERE&quot; -Credential $Cred</code></pre>
<ol start="3"><li>Once the script completes, a remote session will be established. This allows you to run Directory Manager cmdlets in PowerShell 7 without logging directly into the Directory Manager server.</li></ol>
</body>
</html>