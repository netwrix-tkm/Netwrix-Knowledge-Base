<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scanning SharePoint in a load-balanced environment</title>
    <meta name="visibility" content="employees_v">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:35:50.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2023-05-08T10:08:37.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:35:51.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000Ia2CAE">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000Ia2CAE">
    <meta name="LastModifiedById" content="0054u000006gSmgAAE">
    <meta name="LastModifiedDate" content="2023-05-08T10:08:37.000Z">
    <meta name="LastPublishedDate" content="2022-02-01T18:35:51.000Z">
    <meta name="Meta_Description__c" content="360008408371">
    <meta name="Meta_Title__c" content="Scanning SharePoint in a load-balanced environment">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="7234">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000Ia2CAE.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Scanning SharePoint in a load-balanced environment</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> It&#39;s common for customers to use load balancers to help with performance as well as provide an additional layer of security in their networks but this can cause issues during SharePoint scans.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> A load balancer does what the name implies, it balances the load of traffic on a network by spreading connections out between multiple servers which direct traffic appropriately. This can cause issues when scanning SharePoint since while we&#39;re scanning the connection can be changed from one load balancer to another. This effectively confuses our DC since the expected IP address will be different from what we originally connected to.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> There are two ways we can bypass a load balancer to ensure our connections aren&#39;t interrupted:</p>
<ol><li>Run scans in agent mode.
<ol style="list-style-type: lower-alpha;"><li>Since the agent resides on the actual SharePoint application server we can connect directly to the sites without making any web calls which would go through the load balancer.</li></ol>
</li><li>Specify the site collection URL&#39;s on the static host list on the StealthAUDIT console.
<ol style="list-style-type: lower-alpha;"><li>The hosts file is located within C:\Windows\System32\drivers\etc
<ol style="list-style-type: lower-roman;"><li>Copy this file to the desktop before editing it</li><li>Enter the individual Site Collection URL&#39;s here</li><li>Directions for formatting this can be found here: <a href="https://www.petri.com/easily-edit-hosts-file-windows-10" target="_blank">Link</a>
</li></ol>
</li><li>Here we specify the URL&#39;s we intent to scan and bypass the load balancer since we already know what the URL&#39;s are instead of going through the load balancer and it telling us what those URL&#39;s are.</li></ol>
</li></ol>
<p><img src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LcacT&amp;d=%2Fa%2F4u000000LyoM%2F6c3.cHKZsFqEasWBnyGKCiLws12PvbPY_SerOC9n24Y&amp;asPdf=false" alt="mceclip0.png"></img></p>
<p> <br> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SPAA - Activity;SA - DC - SPAA - Permissions;SA - DC - SPAA - Sensitive Data<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2198</p>
</body>
</html>