<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filtering SDD matches with additional validation</title>
    <meta name="visibility" content="employees_v">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:44:22.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2023-05-08T10:11:14.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:44:23.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000InZCAU">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000InZCAU">
    <meta name="LastModifiedById" content="0054u000006gSmgAAE">
    <meta name="LastModifiedDate" content="2023-05-08T10:11:15.000Z">
    <meta name="LastPublishedDate" content="2022-02-01T18:44:23.000Z">
    <meta name="Meta_Description__c" content="360008408371">
    <meta name="Meta_Title__c" content="Filtering SDD matches with additional validation">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="7367">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000InZCAU.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Filtering SDD matches with additional validation</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Sometimes regexes/patterns are not enough to validate sensitive data matches and additional validation/filtering is required</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Describes a method to validate sensitive data against checksums/algorithms that are not available in the standard product.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong>  <br><strong><span style="font-size: 12pt;">Summary</span></strong><br><span style="font-family: arial,sans-serif;">.</span>        <strong>Sensitive data discovery includes Luhn and Mod 11 validation as standard, but it is sometimes necessary to apply alternative validation approaches. This KB article describes the implementation of code to perform such a validation and accurately update the match tables by removing data that fails the validation.</strong><br><strong><span style="font-size: 12pt;">Scope</span></strong><br><span style="font-family: arial,sans-serif;">.</span>        <strong>This applies to all versions of StealthAUDIT </strong><br><strong>(Has been tested v8.1)</strong><br> <br><strong><span style="font-size: 12pt;">Details</span></strong><br><span style="font-family: arial,sans-serif;">.</span>        <strong>The validation is implemented in two parts, a function to determine if a data item passes validation, and a processing script to apply this function to collected data and delete data that does not pass validation. </strong><br> <br><span style="font-family: arial,sans-serif;">.</span>        <strong>An example of such function code is:</strong><br> <br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">IF</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: fuchsia;">OBJECT_ID</span><span style="color: gray;">(</span><span style="color: red;">&#39;SA_PS_DoesPatternMatch&#39;</span><span style="color: gray;">,</span> <span style="color: red;">&#39;FN&#39;</span><span style="color: gray;">)</span> <span style="color: gray;">IS</span> <span style="color: gray;">NOT</span> <span style="color: gray;">NULL</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">                                          <span style="color: blue;">DROP</span> <span style="color: blue;">FUNCTION</span> dbo<span style="color: gray;">.</span>SA_PS_DoesPatternMatch</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">GO</span></span></span><br> <br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">CREATE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: blue;">FUNCTION</span> dbo<span style="color: gray;">.</span>SA_PS_DoesPatternMatch<span style="color: gray;">(</span>@Pattern <span style="color: blue;">varchar</span><span style="color: gray;">(</span>15<span style="color: gray;">))</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">RETURNS</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: blue;">INT</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">AS</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">BEGIN</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">DECLARE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> @RetVal <span style="color: blue;">INT</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @K <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @L <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @M <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @N <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @O <span style="color: blue;">INT</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @P <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @Q <span style="color: blue;">INT</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @R <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @S <span style="color: blue;">INT</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">DECLARE</span> @T <span style="color: blue;">INT</span> </span></span><br>     <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">IF</span> @Pattern <span style="color: gray;">IS</span> <span style="color: gray;">NULL</span> <span style="color: green;">-- Check not blank</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">            <span style="color: blue;">RETURN</span> <span style="color: gray;">-</span>1</span></span><br>           <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">IF</span> <span style="color: fuchsia;">LEN</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">)</span> <span style="color: gray;">!=</span> 15 <span style="color: green;">-- Check right length</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">            <span style="color: blue;">RETURN</span> <span style="color: gray;">-</span>2</span></span><br>           <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">IF</span> @Pattern <span style="color: gray;">NOT</span> <span style="color: gray;">LIKE</span> <span style="color: red;">&#39;IDCZE[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]&#39;</span> <span style="color: green;">-- Check format</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">            <span style="color: blue;">RETURN</span> <span style="color: gray;">-</span>3</span></span><br> <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @K <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">, </span>6<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @L <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">, </span>7<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span> </span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @M <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">, </span>8<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @N <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">, </span>9<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @O <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">,</span> 10<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @P <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">,</span> 11<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @Q <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">,</span> 12<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @R <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">,</span> 13<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @S <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">,</span> 14<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">SET</span> @T <span style="color: gray;">=</span> <span style="color: fuchsia;">CAST</span><span style="color: gray;">(</span><span style="color: fuchsia;">SUBSTRING</span><span style="color: gray;">(</span>@Pattern<span style="color: gray;">,</span> 15<span style="color: gray;">,</span>1<span style="color: gray;">)</span> <span style="color: blue;">AS</span> <span style="color: blue;">INT</span><span style="color: gray;">)</span></span></span><br>     <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">IF</span> @T <span style="color: gray;">!=</span> <span style="color: gray;">(</span>@K<span style="color: gray;">*</span>7 <span style="color: gray;">+</span> @L<span style="color: gray;">*</span>3 <span style="color: gray;">+</span> @M<span style="color: gray;">*</span>1 <span style="color: gray;">+</span> @N<span style="color: gray;">*</span>7 <span style="color: gray;">+</span> @O<span style="color: gray;">*</span>3 <span style="color: gray;">+</span> @P<span style="color: gray;">*</span>1 <span style="color: gray;">+</span> @Q<span style="color: gray;">*</span>7 <span style="color: gray;">+</span> @R<span style="color: gray;">*</span>3 <span style="color: gray;">+</span> @S<span style="color: gray;">*</span>1<span style="color: gray;">)</span> <span style="color: gray;">%</span> 10 <span style="color: green;">-- Check checksum</span></span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">            <span style="color: blue;">RETURN</span> <span style="color: gray;">-</span>4</span></span><br>     <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">RETURN</span> 1 </span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">END</span></span></span><br> <br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">GO</span></span></span><br> <span style="font-family: arial,sans-serif;">                                                                                                                                    .</span><span style="font-family: times new roman,serif;"><span style="font-size: 7pt;">                                                            </span></span><strong>Example code which then uses the function to delete false matches. Note this updates the matches table so that match counts still correspond to the number of related rows in the match hits table.</strong><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">declare</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> @CriteriaName <span style="color: blue;">varchar</span><span style="color: gray;">(</span>64<span style="color: gray;">)</span> <span style="color: gray;">=</span> <span style="color: red;">&#39;IDC&#39;</span></span></span><br> <br><span style="color: green;"><span style="font-family: courier new;"><span style="font-size: 10pt;">-- Delete invalid hit records for the criteria</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">DELETE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> mh</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">FROM</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;">  dbo<span style="color: gray;">.</span>SA_FSDLP_Criteria c</span></span><br><span style="color: gray;"><span style="font-family: courier new;"><span style="font-size: 10pt;">INNER</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: gray;">JOIN</span> dbo<span style="color: gray;">.</span>SA_FSDLP_MatchHits mh</span></span><br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: blue;">ON</span> mh<span style="color: gray;">.</span>HOST <span style="color: gray;">=</span> c<span style="color: gray;">.</span>HOST <span style="color: gray;">AND</span> mh<span style="color: gray;">.</span>CriteriaId <span style="color: gray;">=</span> c<span style="color: gray;">.</span>ID</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">WHERE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> c<span style="color: gray;">.</span>Name <span style="color: gray;">=</span> @CriteriaName</span></span><br><span style="color: gray;"><span style="font-family: courier new;"><span style="font-size: 10pt;">AND</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> dbo<span style="color: gray;">.</span>SA_PS_DoesPatternMatch<span style="color: gray;">(</span>matchdata<span style="color: gray;">)</span> <span style="color: gray;">!=</span> 1</span></span><br> <br><span style="color: green;"><span style="font-family: courier new;"><span style="font-size: 10pt;">-- Delete match records that no longer have hit records for the criteria (every hit for this host/criteria failed validation)</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">DELETE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> M</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">FROM</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;">  dbo<span style="color: gray;">.</span>SA_FSDLP_Criteria c</span></span><br><span style="color: gray;"><span style="font-family: courier new;"><span style="font-size: 10pt;">INNER</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: gray;">JOIN</span> dbo<span style="color: gray;">.</span>SA_FSDLP_Matches m</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">ON</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> m<span style="color: gray;">.</span>HOST <span style="color: gray;">=</span> c<span style="color: gray;">.</span>HOST </span></span><br><span style="color: gray;"><span style="font-family: courier new;"><span style="font-size: 10pt;">AND</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> m<span style="color: gray;">.</span>CriteriaId <span style="color: gray;">=</span> c<span style="color: gray;">.</span>ID</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">WHERE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> c<span style="color: gray;">.</span>Name <span style="color: gray;">=</span> @CriteriaName <span style="color: gray;">AND</span> <span style="color: gray;">NOT</span> <span style="color: gray;">EXISTS</span> <span style="color: gray;">(</span><span style="color: blue;">SELECT</span> <span style="color: red;">&#39;x&#39;</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">FROM</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> dbo<span style="color: gray;">.</span>SA_FSDLP_MatchHits mh</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">WHERE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> mh<span style="color: gray;">.</span>HOST <span style="color: gray;">=</span> c<span style="color: gray;">.</span>HOST <span style="color: gray;">AND</span> mh<span style="color: gray;">.</span>CriteriaId <span style="color: gray;">=</span> c<span style="color: gray;">.</span>ID <span style="color: gray;">AND</span> mh<span style="color: gray;">.</span>FileId <span style="color: gray;">=</span> m<span style="color: gray;">.</span>FileId<span style="color: gray;">)</span></span></span><br> <br><span style="font-family: courier new;"><span style="font-size: 10pt;">      <span style="color: green;">-- Update match count records for the criteria</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">UPDATE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> M</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">SET</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> Matchcount <span style="color: gray;">=</span> <span style="color: gray;">(</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">SELECT</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: fuchsia;">COUNT</span><span style="color: gray;">(*)</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">FROM</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> dbo<span style="color: gray;">.</span>SA_FSDLP_MatchHits mh</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">WHERE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> mh<span style="color: gray;">.</span>HOST <span style="color: gray;">=</span> c<span style="color: gray;">.</span>HOST <span style="color: gray;">AND</span> mh<span style="color: gray;">.</span>CriteriaId <span style="color: gray;">=</span> c<span style="color: gray;">.</span>ID <span style="color: gray;">AND</span> mh<span style="color: gray;">.</span>FileId <span style="color: gray;">=</span> m<span style="color: gray;">.</span>FileId<span style="color: gray;">)</span></span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">FROM</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;">  dbo<span style="color: gray;">.</span>SA_FSDLP_Criteria c</span></span><br><span style="color: gray;"><span style="font-family: courier new;"><span style="font-size: 10pt;">INNER</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> <span style="color: gray;">JOIN</span> dbo<span style="color: gray;">.</span>SA_FSDLP_Matches m</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">ON</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> m<span style="color: gray;">.</span>HOST <span style="color: gray;">=</span> c<span style="color: gray;">.</span>HOST <span style="color: gray;">AND</span> m<span style="color: gray;">.</span>CriteriaId <span style="color: gray;">=</span> c<span style="color: gray;">.</span>ID</span></span><br><span style="color: blue;"><span style="font-family: courier new;"><span style="font-size: 10pt;">WHERE</span></span></span><span style="font-family: courier new;"><span style="font-size: 10pt;"> c<span style="color: gray;">.</span>Name <span style="color: gray;">=</span> @CriteriaName</span></span><br>  <br><strong><span style="font-size: 12pt;">Implementation Notes</span></strong><br><span style="font-family: arial,sans-serif;">.</span>        <strong>The example code is for File sensitive data, but should be easily adapted for SharePoint/Exchange/SQL.</strong><br> <br> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Sensitive Data;SA - DC - SPAA - Sensitive Data;SA - Solution Set - File System;SA - Solution Set - SharePoint<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1884</p>
</body>
</html>