<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell: &quot;Only core types are supported in this language mode&quot;</title>
    <meta name="visibility" content="employees_v">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:04:37.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2023-05-08T10:03:39.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:04:38.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000I9TCAU">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000I9TCAU">
    <meta name="LastModifiedById" content="0054u000006gSmgAAE">
    <meta name="LastModifiedDate" content="2023-05-08T10:03:39.000Z">
    <meta name="LastPublishedDate" content="2022-02-01T18:04:38.000Z">
    <meta name="Meta_Description__c" content="360010581231">
    <meta name="Meta_Title__c" content="PowerShell: &quot;Only core types are supported in this language mode&quot;">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="6249">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000I9TCAU.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>PowerShell: &quot;Only core types are supported in this language mode&quot;</h1>
    <p>If PowerShell throws an error that says <em>&quot;Only core types are supported in this language mode&quot;</em>, the host is running PowerShell in <a href="https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/" target="_blank">Constrained Language Mode</a>. </p>
<p>You can confirm this by navigating to HKLM:\\SYSTEM\CurrentControlSet\Control\Session Manager\Environment in the registry and checking the value of the __PsLockdownPolicy key. </p>
<p>This script will do that for you:</p>
<pre>$Hive = [Microsoft.Win32.RegistryHive]::LocalMachine<br>$Registry = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey($Hive, $env:COMPUTERNAME)<br>$KeyPath = &#39;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&#39;<br>$Key = $Registry.OpenSubKey($KeyPath)<br>$LockdownPolicy = $Key.GetValue(&#39;__PSLockdownPolicy&#39;)<br><br>switch($LockdownPolicy) {<br>    $null { Write-Host &quot;PSLockdownPolicy is not enabled&quot;}<br>    0 { Write-Host &quot;PSLockdownPolicy is set to &quot;&quot;Full Language&quot;&quot;&quot;}<br>    1 { Write-Host &quot;PSLockdownPolicy is set to &quot;&quot;Full Language&quot;&quot;&quot;}<br>    2 { Write-Host &quot;PSLockdownPolicy is set to &quot;&quot;Full Language&quot;&quot;&quot;}<br>    3 { Write-Host &quot;PSLockdownPolicy is set to &quot;&quot;Full Language&quot;&quot;&quot;}<br>    4 { Write-Warning &quot;PSLockdownPolicy is set to &quot;&quot;Constrained Language Mode&quot;&quot;&quot;}<br>    5 { Write-Warning &quot;PSLockdownPolicy is set to &quot;&quot;Constrained Language Mode&quot;&quot;&quot;}<br>    6 { Write-Warning &quot;PSLockdownPolicy is set to &quot;&quot;Constrained Language Mode&quot;&quot;&quot;}<br>    7 { Write-Warning &quot;PSLockdownPolicy is set to &quot;&quot;Constrained Language Mode&quot;&quot;&quot;}<br>    8 { Write-Host &quot;PSLockdownPolicy is set to &quot;&quot;Full Language&quot;&quot;&quot;}<br>}</pre>
<p>If the value is 4, 5, 6, or 7, PowerShell is in Constrained Language Mode and you&#39;re gonna have a bad time. </p>
<p>If the key doesn&#39;t exist or the value is 0, 1, 2, 3, or 8 everything is awesome. </p>
<p>You&#39;ll have to restart any PowerShell consoles after changing this value before the change will take effect.</p>
</body>
</html>