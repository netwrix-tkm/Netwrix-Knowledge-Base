<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotfix: SA_7.2_SP1_085</title>
    <meta name="visibility" content="employees_v">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:24:48.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2023-05-08T10:08:16.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:24:48.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000IXzCAM">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000IXzCAM">
    <meta name="LastModifiedById" content="0054u000006gSmgAAE">
    <meta name="LastModifiedDate" content="2023-05-08T10:08:16.000Z">
    <meta name="LastPublishedDate" content="2022-02-01T18:24:48.000Z">
    <meta name="Meta_Description__c" content="360012217812">
    <meta name="Meta_Title__c" content="Hotfix: SA_7.2_SP1_085">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="6695">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IXzCAM.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Hotfix: SA_7.2_SP1_085</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> FSAA | Folders not marked as deleted</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <strong><span style="font-family: calibri,sans-serif;">Summary:  FSAA | Folders not marked as deleted</span></strong><br><strong><span style="font-family: calibri,sans-serif;">Before Fix: Deleted Resources discovered in FSAC scans will cause them to be come not marked as deleted in Tier 1. </span></strong><br><strong><span style="font-family: calibri,sans-serif;">After fix: Add hidden XML option to always use FSAA for marking resources as deleted. See Comments for more details.</span></strong><br><strong><span style="font-family: calibri,sans-serif;">Submitted by: </span></strong><br>Michael Burrofato<br><strong><span style="font-family: calibri,sans-serif;">Affected Versions:</span></strong><br> 7.2<br><strong><span style="font-family: calibri,sans-serif;">Affected Module:</span></strong><br>SA - DC - FSAA<br> <br><strong><span style="font-family: calibri,sans-serif;">Dev Ticket:</span></strong><br>SAFS-806<br><strong><span style="font-family: calibri,sans-serif;">Resolved in Version:</span></strong> 
</p><ul><li>DCFSAA.dll                                 7.2.766
</li><li>FSAASrv.dll                                 7.2.766</li></ul><b>Other dependencies included:</b> 
<ul><li>FSAAConfig.xml                        N/A
</li><li>
<strong><i><span style="font-family: calibri,sans-serif;">FSAANetApp.dll                       7.2.30</span></i></strong>
</li><li>StealthAUDITRPC.exe             7.2.87
</li><li>StealthAUDITRPCClient.dll     7.2.87</li></ul><strong><span style="font-family: calibri,sans-serif;">KB Type: </span></strong><br>               Hotfix<br> <br><strong><span style="font-family: calibri,sans-serif;">YouTrack/Escalations</span></strong><br> <br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-806/Escalation </span></strong><span><span style="color: #1a1a1a;"><span style="font-family: segoe ui,sans-serif;"><span style="font-size: 10pt;">8057, 7822, 29158, 29216</span></span></span></span><br> <br><strong><span style="font-family: calibri,sans-serif;">Customers</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              Westfield Insurance Companies (Ohio Farmers)</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              ANZ</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              HPS Investment Partners</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              Meggitt SA</span></strong><br> <br><strong><span style="font-family: calibri,sans-serif;">Cumulative List of fixes included since Service Pack:</span></strong><br> <br>-              SAFS-1637  FSAA subfolder depth not respected for nested shares.<br>-              SAFS-755  FSAA/FSAC bulk import with unicode characters causes issues<br>-              SAFS-1680  Update validation for FSAC Scan<br>-              SAFS-1666  timeouts during proxy scan<br>-              SAFS-1480 FSAA | FKCV ParentResourceID<br>-              SAFS-994  FSAA SDD Rescan unimported hosts after x days setting not working<br>-              SASP-1239 Error on SDD Bulk Import &#39;FSAA DLP DB files do not exist.&#39; trying to process object of type FSAADifferential. Skipping object&#39;<br>-              SAFS-1850  FSAA Regression: GatesProxy table no longer being populated after pausing scans.<br>-              SAFS-1583  12104 - Database schema is out of date<br>-              SAFS-1581  FSAA should not send tier 2 dbs from SA console to proxy\target if files are identical<br>-              SAFS-1628 Make Partial imports optional<br>-              SAFS-1895 Error pausing scans<br>-              SAFS-1793 Error &#39;Tier 2 databases no longer match Tier 1<br>-              SAFS-1803 FS_Migration job fills up Transaction log and the job will not complete<br>-              SAFS-2026 : Fixed file encoding for patterndefs.update file (reading as ANSI, file is encoded as UTF-8)<br>-              SAFS-1996  FSAA: Big transaction log after first time bulk import<br>-              SAFS-1834 FSAA | Hang during permission scan after verifying host IsNetApp.<br>-              SAFS-2104  FSAA is not bringing correct permission back from folder when permission is applied to only children and file<br>-              SAFS-2062  14436 - FSAA | Read &amp; Execute Shown as List Only<br>-              SAFS-714  Activity scan is returning invalid activity events / errors processing certain events<br>-              SAFS-2098 14727 - Local Group Membership not Updating for Disabled Users<br>-              SAFS-2175  FSAA: DFS results not being written to DEFAULT table<br>-              SAFS-2038  FSAA NFS scans on C-mode netapp &quot;Cound not find mount point&quot;<br>-              SAFS-1974 : Fix endless &quot;Tolerated processing error&quot; debug messages in log when DC not able to contact applet, not respecting applet timeout setting.<br>-              SAFS-1893 13436 - Error when compressing tier 2 databases<br>-              SAFS-2135 14914 - Access Violations in DCFSAA.dll during system scan<br>-              SAFS-1834 13110 - FSAA | Hang during permission scan after verifying host IsNetApp<br>-              SAFS-2099 : Improve SDD scan speed by checking queue status every millisecond instead of every 15 seconds<br>-              SAFS-1947  13700 - SDD scans with updates binaries project to take months / years to complete<br>-              SAFS-2197  15132 - Feature Request - FSAA | Implement Retry On IPC$ Check<br>-              SAFS-1582  9969 - FSAA | Timeout while compressing SQLites on proxy<br><strong><span style="font-family: calibri,sans-serif;">-              SASP-879 : Fixed negate children patterns not included into scan config</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-2324  Investigate FSAA functionality when there is lack of access to IPC$</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-2359  16217 - Error Getting Activity Count from TBL_FSAC_ActivityEvents: Overflow while converting variant of type (OleStr) into type (Integer)</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-2442  DFS Scan: Error during processing: cannot DETACH database within transaction[0x0001] DETACH DATABASE Struc</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-2364  12262 - FSAA | Do not overwrite trace.log files</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-2411: </span></strong>FS_Migration Finishes with Success but doesn&#39;t Add USN Column to Activity Tier 2<br>-              SAFS-2515 FSAC: Scan is throwing an error &quot;Buffer too small&#39;&quot;<br>-              SAFS-2490  17161 - FSAC collection stuck in loop<br>-              SAFS-2574  FSAA: FSAC scan parses local sa console logs instead of windows cluster node<br>-              SAFS-2633 18401 - Skipping Invalid Activities. Scan was reading first 32kb twice instead of subsequent events<br>-              SAFS-2626 : Cache was not properly handling files/folders with same names in same parent folder (can happen from deletion/recreation)<br>-              SAFS-2767 NFS scans aren&#39;t picking up files<br>-              SAFS-2743 DFS listing wrong active link<br>-              SAFS-2628 18381 - Server Scan file doesn&#39;t upload to the console.<br>-              SAFS-2777 20796 - FSAA | Error when checking for active sessions on proxy<br>-              SAFS-2837 19948 - DFS: Unique Key violation<br>-              SAFS-2698 19491 - FSAA not traversing mounted volumes<br>-              SAFS-2809  20970 - The INSERT statement conflicted with the FOREIGN KEY constraint &quot;FK_SA_FSAC_ActivityEvents_New_PathID&quot;.<br>-              SAFS-2205 13113 - Detect and throw an error when an invalid share (e.g., one with a backslash) is detected<br>-              SAFS-2329 16097 - FSAA | DFS Uses NTDomainName instead of FQDN<br>-              SAFS-3026 Foreign key constraint violations after failed bulk import<br>-              SAFS-14593 Update bulk import to not delete Activity and DLPEX tier 2 dbs.<br>-              SAFS-2705 15281 - FSAA unspecified error<br>-              SAFS-2707  19757 - FSAC Bulk Import Rollback Due to Unspecified Error<br>-              SAFS-14672 FSAC Access Violation on scans<br>-              SAFS-14694 23344 - TFSAAAppletObjectProcessor.GetScanDatabaseFromExecHostWithRetry &quot;Error downloading scan database from exec host, attempt 3: Error in TAppletRPCHelper.GetScanDatabase: (0x80070057) The parameter is incorrect&quot;<br>-              SAFS-14702  22116 - Do Not Delete Activity Data Automatically<br> <br><b>Fixes since last hotfix:</b><br><b>-              </b>SAFS-2771 20689 - Error during storing DailyActivity: &#39;&#39; is not a valid integer value<br>-              SAFS-14656  23094 - Strip trailing spaces from shares&#39; landing folders<br>-              SAFS-2957 21750 - FSAA | Skip IPC$ check in applet mode<br>-              SAFS-14809 Automatic procdump functionality in FSAA applet can cause access violations after scan completes<br>-              SAFS-14597 : Add RPC_IF_ALLOW_CALLBACKS_WITH_NO_AUTH and auth callback even if not using secure RPC to permit working with RestrictRemoteClients=1<br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-14800 23738 - SDD Scoping to folders Added a warning log message if the ScanResourceFilter option is using the unsupported target &quot;Resource&quot;</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-2692 19369/19531 - FSAA | Shares Marked as Deleted When Access to Enumerate Shares is Revoked</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-14824 20963 - RESURFACED TICKET: FSAA Failed to Copy Tier 2</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-14791 Change FSAA/FSAC to create SQLite temporary files in FSAA folder</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-14485 18434: FSAC Support milliseconds in event timestamps</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-14996 24391 - Foreign Key Constraint Violation</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-1643 11296 - Improve error logging for FSAA Proxy scanning</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-15388 FSAA/SDD: Performance bug limits scan performance</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-15353 27010 - FSAA | Error &quot;Invalid discretionary access control list on security descriptor&quot; when security descriptor has no DACL</span></strong><br><strong><span style="font-family: calibri,sans-serif;">-              SAFS-806 FSAA | Folders not marked as deleted</span></strong><br> <br><b>Comments:</b><br><strong><span style="font-family: calibri,sans-serif;">The following fix requires the Job XML for ALL FSAA scans and bulk import jobs (permissions, activity, and Sensitive Data) to be manually modified. See screenshot below for the syntax required.</span></strong><br> <br><img alt="User-added image" src="https://nwxcorp--c.na147.content.force.com/sfc/dist/version/download/?oid=00D7000000091pB&amp;ids=0684u00000LcYx1&amp;d=%2Fa%2F4u000000LyqC%2FuWv8U0H76h.Zp_IEsNt7uTQlAcDS7xJW412DZOTgGac&amp;asPdf=false" width="500" height="169"></img><br><br> <br><b><u><span style="color: red;">ADDITIONAL STEPS IF YOU HAVE DELETED RESOURCES NOT MARKED AS DELETED IN TIER 1</span></u></b> 
<ol><li>Drop the contents located in the FSAA folder of this hotfix into the FSAA folder of your local SA Console.
</li><li>Open an elevated command prompt and change directory to FSAA folder.</li></ol><span><span style="color: #1a1a1a;"><span style="font-family: segoe ui,sans-serif;"><span style="font-size: 10.5pt;">1) To update all tier2 files: </span></span></span></span><span style="color: #660066;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">FSAAUpdateDeletedUSN</span></span></span><span style="color: #666600;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">.</span></span></span><span style="color: black;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">exe </span></span></span><span style="color: #666600;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">-</span></span></span><span style="color: black;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">a</span></span></span><br><span style="color: #1a1a1a;"><span style="font-family: segoe ui,sans-serif;"><span style="font-size: 10.5pt;"><span>2) To update a single host: </span></span></span></span><span style="color: #660066;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">FSAAUpdateDeletedUSN</span></span></span><span style="color: #666600;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">.</span></span></span><span style="color: black;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;">exe </span></span></span><span style="color: #008800;"><span style="font-family: courier new;"><span style="font-size: 10.5pt;"></span></span></span> 
<ol><li>Run FSAA permission bulk import against the affected hosts.</li></ol><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> </p><ol><li>
<strong><span style="color: #404040;"><span style="font-family: calibri,sans-serif;">Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there. </span></span></strong>
</li><li>
<strong><span style="color: #404040;"><span style="font-family: calibri,sans-serif;">Close all instances of StealthAUDIT. </span></span></strong>
</li><li>
<strong><span style="color: #404040;"><span style="font-family: calibri,sans-serif;">Update all DC files in your %SAInstallDir%DC folder</span></span></strong>
</li><li><strong><span style="color: #404040;"><span style="font-family: calibri,sans-serif;">Stop FSAA proxy service (if applicable). Update all Proxy files in location where proxy service is installed. Restart proxy service.</span></span></strong></li></ol>
<div>  
<table cellspacing="0" cellpadding="0" width="64" border="0"><tbody><tr height="77"><td colspan="1" rowspan="1" height="77" width="64"><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/7.2/SA_7.2_SP1_085.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/7.2/SA_7.2_SP1_085.zip</a></td></tr></tbody></table>
</div><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Activity;SA - DC - FSAA - DFS;SA - DC - FSAA - Permissions<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 7.2<br><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAFS-806<br><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 2176<br></p>
</body>
</html>