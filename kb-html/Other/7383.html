<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enabling Compression for FSAA tables in SQL Standard Edition when Available</title>
    <meta name="visibility" content="employees_v">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:44:53.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2023-05-08T10:12:40.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:44:54.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000IwRCAU">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000IwRCAU">
    <meta name="LastModifiedById" content="0054u000006gSmgAAE">
    <meta name="LastModifiedDate" content="2023-05-08T10:12:40.000Z">
    <meta name="LastPublishedDate" content="2022-02-01T18:44:54.000Z">
    <meta name="Meta_Description__c" content="360008408371">
    <meta name="Meta_Title__c" content="Enabling Compression for FSAA tables in SQL Standard Edition when Available">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="7383">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IwRCAU.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Enabling Compression for FSAA tables in SQL Standard Edition when Available</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Shows how to alter the appropriate tables to include compression, and how to edit the &quot;0-Create Schema&quot; job&#39;s #CreateWithCompression procedure to work on SQL Server 2016 SP1 Standard Edition and above.</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Deploying SQL Enterprise Edition is expensive, but we typically recommend it for activity monitoring and sensitive data use cases are in scope because of the data compression feature (<a href="https://docs.microsoft.com/en-us/sql/relational-databases/data-compression/data-compression?view=sql-server-2017" target="_blank">https://docs.microsoft.com/en-us/sql/relational-databases/data-compression/data-compression?view=sql-server-2017</a>). However, starting with SQL 2016 SP1, compression became available in non-enterprise editions, like standard and express. As a result, we&#39;re able to direct customers to Standard edition, which presents a significant cost savings in terms of Total Cost of Ownership (TCO) compared to Enterprise Edition. However, we do not enable compression unless the database is enterprise edition.<br><br>The following rows may be added to the standard &quot;1. Create Tables&quot; analysis task in the &quot;0-Create Schema&quot; job in the File System Solution Set.<br> <br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">CREATE</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">PROCEDURE</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> #CreateWithCompression</span></span></span><br><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">  @CompressionType </span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">nvarchar</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">128</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">),</span></span></span><br><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">  @CreateScript </span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">nvarchar</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">max</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span><br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AS</span></span></span><br>  <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">DECLARE</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> @cmd </span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">nvarchar</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">max</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">);</span></span></span><br>  <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SET</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> @cmd </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> @CreateScript</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">;</span></span></span><br>  <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">IF</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">CAST</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;edition&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AS</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">VARCHAR</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">32</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">))</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">LIKE</span></span></span> <span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;Enterprise%&#39;</span></span></span><br>  <span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">OR</span></span></span></span> <span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span></span><span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductMajorVersion&#39;</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)&gt;</span></span></span></span><span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">13</span></span></span></span><br>  <span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">OR</span></span></span></span> <span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span></span><span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span></span><span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductMajorVersion&#39;</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)=</span></span></span></span><span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">13 </span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AND</span></span></span></span> <span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">CAST</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span></span><span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span></span><span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductLevel&#39;</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span></span> <span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AS</span></span></span></span> <span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">VARCHAR</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span></span><span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">5</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">))</span></span></span></span> <span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">LIKE</span></span></span></span> <span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SP%&#39;</span></span></span></span><span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span></span><br>    <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SELECT</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> @cmd </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> @cmd </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">+</span></span></span> <span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">N&#39; WITH (DATA_COMPRESSION = &#39;</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">+</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> @CompressionType </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">+</span></span></span> <span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">N&#39;)&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">;</span></span></span><br>  <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">EXECUTE</span></span></span> <span style="color: maroon;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">sp_executesql</span></span></span> <span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">@cmd</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">;</span></span></span><br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">GO</span></span></span><br> </p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> If the tables have already been created, the following will add compression if it&#39;s possible to add by: 
</p><ol><li style="margin-left: 0in;">checking if the SQL server supports compression
</li><li style="margin-left: 0in;">checking if compression exists on the table already
</li><li style="margin-left: 0in;"> adds it on the appropriate tables if it&#39;s not already present</li></ol> <br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">IF </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;EngineEdition&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)=</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">3  </span></span></span><span style="color: green;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">--enterprise edition</span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">OR</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductMajorVersion&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)&gt;</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">13 </span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">OR</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductMajorVersion&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)=</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">13 </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AND</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">cast</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductLevel&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AS</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">VARCHAR</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">5</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">))</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">LIKE</span></span></span> <span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SP%&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">and</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">exists</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">select</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">null</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">from</span></span></span> <span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">sys</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">.</span></span></span><span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">objects</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">where</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">name</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SA_FSAA_Resources&#39;</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AND</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">type</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;u&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: green;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">--table exists</span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">and</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">not</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">exists</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">select</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">null</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">from</span></span></span> <span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">sys</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">.</span></span></span><span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">partitions</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">where</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">object_ID</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">object_id</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SA_FSAA_Resources&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">,</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;u&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">and</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">data_compression</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&gt;</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">0</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: green;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">--compression is not enabled</span></span></span><br>       <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">ALTER</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">TABLE</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> dbo</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">.</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SA_FSAA_Resources </span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">REBUILD</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">PARTITION</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">ALL</span></span></span> <br>       <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">WITH </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">DATA_COMPRESSION</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">ROW</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">);</span></span></span><br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">GO</span></span></span><br> <br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">IF </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;EngineEdition&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)=</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">3  </span></span></span><span style="color: green;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">--enterprise edition</span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">OR</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductMajorVersion&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)&gt;</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">13 </span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">OR</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductMajorVersion&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)=</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">13 </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AND</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">cast</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SERVERPROPERTY</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;ProductLevel&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AS</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">VARCHAR</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">5</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">))</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">LIKE</span></span></span> <span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SP%&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">and</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">exists</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">select</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">null</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">from</span></span></span> <span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">sys</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">.</span></span></span><span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">objects</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">where</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">name</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SA_FSAA_Rights&#39;</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">AND</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">type</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;u&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: green;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">--table exists</span></span></span><br><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">and</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">not</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">exists</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">select</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">null</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">from</span></span></span> <span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">sys</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">.</span></span></span><span style="color: lime;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">partitions</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">where</span></span></span> <span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">object_ID</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span><span style="color: fuchsia;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">object_id</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;SA_FSAA_Rights&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">,</span></span></span><span style="color: red;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&#39;u&#39;</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">and</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">data_compression</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">&gt;</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">0</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">)</span></span></span> <span style="color: green;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">--compression is not enabled</span></span></span><br> <br>       <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">ALTER</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">TABLE</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;"> dbo</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">.</span></span></span><span style="color: black;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">SA_FSAA_Rights </span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">REBUILD</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">PARTITION</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">ALL</span></span></span> <br>       <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">WITH </span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">(</span></span></span><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">DATA_COMPRESSION</span></span></span> <span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">=</span></span></span> <span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">ROW</span></span></span><span style="color: gray;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">);</span></span></span><br><span style="color: blue;"><span style="font-family: consolas;"><span style="font-size: 9.5pt;">GO</span></span></span><br> <br>Only the Rights and Resources tables should have any level of compression.<br> <p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Activity;SA - DC - FSAA - DFS;SA - DC - FSAA - Permissions<br><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.0+<br><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> Escalation 27720 / SAFS-15477<br><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> Not addressed in product as of 8.2 CU Released 2019/03/29<br><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2306<br></p>
</body>
</html>