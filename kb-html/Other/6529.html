<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collecting Debug Info for Threat Manager Action Services</title>
    <meta name="visibility" content="employees_v">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:19:08.000Z">
    <meta name="Article_Drafts_Folder__c" content="https://nwxcorp.sharepoint.com/sites/TechnicalSupportOperations/Shared%20Documents/Technical%20Knowledge%20Management/Salesforce%20Knowledge%20Drafts/kA04u0000000IPMCA2">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2025-05-05T11:43:01.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:19:09.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000IPMCA2">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000IPMCA2">
    <meta name="LastModifiedById" content="0054u0000093LZ4AAM">
    <meta name="LastModifiedDate" content="2025-05-05T11:48:22.000Z">
    <meta name="LastPublishedDate" content="2022-02-01T18:19:09.000Z">
    <meta name="Meta_Description__c" content="360008304072">
    <meta name="Meta_Title__c" content="Collecting Debug Info for Threat Manager Action Services">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="6529">
    <meta name="VersionNumber" content="1">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IPMCA2.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>Collecting Debug Info for Threat Manager Action Services</h1>
    <p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Describes how to generate additional logs for investigation if the Threat Manager Action Service does not appear to be working correctly.</p>
<p><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>Issue:</strong>  Sometimes the Actions Log and information in the application GUI may not be detailed enough to capture the level of detail required to diagnose a failed job.</span></span></p>
<p><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong><span style="color: black;">Instructions:</span></strong><span style="color: black;">  Create a playbook with a PowerShell Runtime. Use the below script. This will generate logs files containing </span></span></span></p>
<ol><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">The Threat Data (which caused the action to run)</span></span></span></li><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">The Event Data, and </span></span></span></li><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">The Hostname</span></span></span></li></ol>
<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">and store them in C:\ProgramData\STEALTHbits\StealthDEFEND.</span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">Be sure to also collect the standard Action Service log file from [InstallPath]\ StealthDEFEND\ActionService\Log (C:\ProgramData\STEALTHbits\StealthDEFEND\ActionService\Log by default)<br><br>------ Start of shell -----</span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Threat</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: blue;">Get-SDThreat</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-id</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$ThreatId</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-RestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-RestApiToken</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiToken</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: blue;">Get-SDEvent</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Id</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Threat</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">PrimaryEventId </span></span><span style="font-size: 9pt;"><span style="color: navy;">-RestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-RestApiToken</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiToken</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: blue;">Get-ShortSamAccountName</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-SamAccountName</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">SourceHost</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Threat</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">&gt;&gt;</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;C:\ProgramData\STEALTHbits\StealthDEFEND\threat.log&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">&gt;&gt;</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;C:\ProgramData\STEALTHbits\StealthDEFEND\event.log&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">&gt;&gt;</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;C:\ProgramData\STEALTHbits\StealthDEFEND\hostname.log&quot;</span></span></span></span><br><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: darkblue;">if</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$env:COMPUTERNAME</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">-Like</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span><span style="font-size: 9pt;"><span style="color: black;">) {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: blue;">Stop-Process</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Name</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Process</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">ToLower()</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">TrimEnd(</span></span><span style="font-size: 9pt;"><span style="color: darkred;">&#39;.exe&#39;</span></span><span style="font-size: 9pt;"><span style="color: black;">) </span></span><span style="font-size: 9pt;"><span style="color: navy;">-Force</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">} </span></span><span style="font-size: 9pt;"><span style="color: darkblue;">else</span></span><span style="font-size: 9pt;"><span style="color: black;"> {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: darkblue;">if</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">-not</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: blue;">Test-Connection</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-ComputerName</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Quiet</span></span><span style="font-size: 9pt;"><span style="color: black;">)) {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">        <span style="font-size: 9pt;"><span style="color: darkblue;">throw</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;Could not stop process </span></span><span style="font-size: 9pt;"><span style="color: black;">$(</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Process</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name)</span></span><span style="font-size: 9pt;"><span style="color: darkred;"> on remote computer </span></span><span style="font-size: 9pt;"><span style="color: black;">$(</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">SourceHost</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name)</span></span><span style="font-size: 9pt;"><span style="color: darkred;"> because the computer was not available.&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">    }</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: #a82d00;">$Args</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span><span style="font-size: 9pt;"><span style="color: black;"> @{</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        ComputerName </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        Authentication </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;Kerberos&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        ScriptBlock </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span><span style="font-size: 9pt;"><span style="color: black;">  { </span></span><span style="font-size: 9pt;"><span style="color: blue;">Stop-Process</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Name</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Args</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">[</span></span><span style="font-size: 9pt;"><span style="color: purple;">0</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">]</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Force</span></span><span style="font-size: 9pt;"><span style="color: black;"> }</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        ArgumentList </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Process</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">ToLower()</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">TrimEnd(</span></span><span style="font-size: 9pt;"><span style="color: darkred;">&#39;.exe&#39;</span></span><span style="font-size: 9pt;"><span style="color: black;">)</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">    }</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: darkblue;">if</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$Credential</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">-ne</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$null</span></span><span style="font-size: 9pt;"><span style="color: black;">) {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">        <span style="font-size: 9pt;"><span style="color: #a82d00;">$Args</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">[</span></span><span style="font-size: 9pt;"><span style="color: darkred;">&quot;Credential&quot;</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">]</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Credential</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">    }</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: blue;">Invoke-Command</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">@Args</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">}</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">------ END of shell -----</span></span><br> </p>
<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong><span style="color: black;">Instructions:</span></strong><span style="color: black;">  Create a playbook with a PowerShell Runtime. Use the below script. This will generate logs files containing </span></span></span></p>
<ol><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">The Threat Data (which caused the action to run)</span></span></span></li><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">The Event Data, and </span></span></span></li><li><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">The Hostname</span></span></span></li></ol>
<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">and store them in C:\ProgramData\STEALTHbits\StealthDEFEND.</span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="color: black;">Be sure to also collect the standard Action Service log file from [InstallPath]\ StealthDEFEND\ActionService\Log (C:\ProgramData\STEALTHbits\StealthDEFEND\ActionService\Log by default)<br><br>------ Start of shell -----</span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Threat</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: blue;">Get-SDThreat</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-id</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$ThreatId</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-RestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-RestApiToken</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiToken</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: blue;">Get-SDEvent</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Id</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Threat</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">PrimaryEventId </span></span><span style="font-size: 9pt;"><span style="color: navy;">-RestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiUri</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-RestApiToken</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$SDRestApiToken</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: blue;">Get-ShortSamAccountName</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-SamAccountName</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">SourceHost</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Threat</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">&gt;&gt;</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;C:\ProgramData\STEALTHbits\StealthDEFEND\threat.log&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">&gt;&gt;</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;C:\ProgramData\STEALTHbits\StealthDEFEND\event.log&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">&gt;&gt;</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;C:\ProgramData\STEALTHbits\StealthDEFEND\hostname.log&quot;</span></span></span></span><br><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: darkblue;">if</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$env:COMPUTERNAME</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">-Like</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span><span style="font-size: 9pt;"><span style="color: black;">) {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: blue;">Stop-Process</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Name</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Process</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">ToLower()</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">TrimEnd(</span></span><span style="font-size: 9pt;"><span style="color: darkred;">&#39;.exe&#39;</span></span><span style="font-size: 9pt;"><span style="color: black;">) </span></span><span style="font-size: 9pt;"><span style="color: navy;">-Force</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">} </span></span><span style="font-size: 9pt;"><span style="color: darkblue;">else</span></span><span style="font-size: 9pt;"><span style="color: black;"> {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: darkblue;">if</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">-not</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: blue;">Test-Connection</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-ComputerName</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Quiet</span></span><span style="font-size: 9pt;"><span style="color: black;">)) {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">        <span style="font-size: 9pt;"><span style="color: darkblue;">throw</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;Could not stop process </span></span><span style="font-size: 9pt;"><span style="color: black;">$(</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Process</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name)</span></span><span style="font-size: 9pt;"><span style="color: darkred;"> on remote computer </span></span><span style="font-size: 9pt;"><span style="color: black;">$(</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">SourceHost</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name)</span></span><span style="font-size: 9pt;"><span style="color: darkred;"> because the computer was not available.&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">    }</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: #a82d00;">$Args</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span><span style="font-size: 9pt;"><span style="color: black;"> @{</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        ComputerName </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$HostName</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        Authentication </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: darkred;">&quot;Kerberos&quot;</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        ScriptBlock </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span><span style="font-size: 9pt;"><span style="color: black;">  { </span></span><span style="font-size: 9pt;"><span style="color: blue;">Stop-Process</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Name</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Args</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">[</span></span><span style="font-size: 9pt;"><span style="color: purple;">0</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">]</span></span> <span style="font-size: 9pt;"><span style="color: navy;">-Force</span></span><span style="font-size: 9pt;"><span style="color: black;"> }</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">        ArgumentList </span></span><span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Event</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Process</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">Name</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">ToLower()</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">.</span></span><span style="font-size: 9pt;"><span style="color: black;">TrimEnd(</span></span><span style="font-size: 9pt;"><span style="color: darkred;">&#39;.exe&#39;</span></span><span style="font-size: 9pt;"><span style="color: black;">)</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">    }</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: darkblue;">if</span></span><span style="font-size: 9pt;"><span style="color: black;"> (</span></span><span style="font-size: 9pt;"><span style="color: #a82d00;">$Credential</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">-ne</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$null</span></span><span style="font-size: 9pt;"><span style="color: black;">) {</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">        <span style="font-size: 9pt;"><span style="color: #a82d00;">$Args</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">[</span></span><span style="font-size: 9pt;"><span style="color: darkred;">&quot;Credential&quot;</span></span><span style="font-size: 9pt;"><span style="color: dimgray;">]</span></span> <span style="font-size: 9pt;"><span style="color: dimgray;">=</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">$Credential</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">    }</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">    <span style="font-size: 9pt;"><span style="color: blue;">Invoke-Command</span></span> <span style="font-size: 9pt;"><span style="color: #a82d00;">@Args</span></span></span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><span style="font-size: 9pt;"><span style="color: black;">}</span></span></span></span><br><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;">------ END of shell -----</span></span><br> </p>
<p><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>Submitted by:</strong> Matt Johnson </span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>Product:</strong> Threat Manager</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>Affected Versions:</strong> All</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>Affected Module:</strong>  Actions</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>Dev Ticket:</strong> N/A<br><strong>Resolved In Version:</strong> N/A</span></span><br><span style="font-size: 11pt;"><span style="font-family: Calibri,sans-serif;"><strong>KB Type:</strong> How To</span></span><br><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 000002568</p>
</body>
</html>