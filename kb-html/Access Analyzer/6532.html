<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Connect to Office 365 Exchange Online</title>
    <meta name="visibility" content="employees_v">
    <meta name="product" content="enterprise_auditor">
    <meta name="ArticleCaseAttachCount" content="0">
    <meta name="ArticleCreatedById" content="0054u000006god6AAA">
    <meta name="ArticleCreatedDate" content="2022-02-01T18:19:17.000Z">
    <meta name="Article_Drafts_Folder__c" content="nan">
    <meta name="Article_Reviewer__c" content="nan">
    <meta name="Article_SME__c" content="nan">
    <meta name="Article_Version_Origin__c" content="nan">
    <meta name="Asana_Task_URL__c" content="nan">
    <meta name="AssignedById" content="nan">
    <meta name="AssignedToId" content="nan">
    <meta name="AssignmentDate" content="nan">
    <meta name="AssignmentDueDate" content="nan">
    <meta name="AssignmentNote" content="nan">
    <meta name="Case__c" content="nan">
    <meta name="Confidence_Level__c" content="nan">
    <meta name="CreatedById" content="0054u000006god6AAA">
    <meta name="CreatedDate" content="2024-06-05T20:43:25.000Z">
    <meta name="Draft_Status__c" content="nan">
    <meta name="FirstPublishedDate" content="2022-02-01T18:19:18.000Z">
    <meta name="IsLatestVersion" content="True">
    <meta name="KnowledgeArticleId" content="kA04u0000000IO5CAM">
    <meta name="Knowledge_Article_ID__c" content="kA04u0000000IO5CAM">
    <meta name="LastModifiedById" content="005Qk0000017MRRIA2">
    <meta name="LastModifiedDate" content="2024-06-05T20:46:11.000Z">
    <meta name="LastPublishedDate" content="2024-06-05T20:46:11.000Z">
    <meta name="Meta_Description__c" content="How to Connect to Office 365 Exchange Online">
    <meta name="Meta_Title__c" content="How to Connect to Office 365 Exchange Online">
    <meta name="OwnerId" content="0054u000006god6AAA">
    <meta name="PublishStatus" content="Online">
    <meta name="RecordTypeId" content="0124u000000UUgLAAW">
    <meta name="UrlName" content="6532">
    <meta name="VersionNumber" content="3">
    <meta name="Website_URL__c" content="&lt;a href=&quot;https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000IO5CAM.html&quot; target=&quot;_blank&quot;&gt;Open in a new window&lt;/a&gt;">
</head>
<body>
    <h1>How to Connect to Office 365 Exchange Online</h1>
    <h2>Overview</h2>

<p>This article describes how to connect to Office 365 Exchange Online using a PowerShell script.</p>

<h2>Instructions</h2>

<ol><li>Remark the first five lines and run it like an on-premise server:</li></ol>

<pre>
##$password = convertto-securestring &quot;%HIDDEN PASSWORD%!&quot; -asplaintext -force
##$userid = &quot;%HIDDEN USERID%&quot;
##$cred = New-Object System.Management.Automation.PSCredential $userid,$password 
##$global:session365 = New-PSSession -configurationname Microsoft.Exchange -connectionuri https://ps.outlook.com/powershell/ -credential $cred -authentication Basic -AllowRedirection 
##Import-PSSession $global:session365

add-pssnapin microsoft.exchange.management.powershell.e2010 
get-mailbox -ResultSize Unlimited | where-object {$_.litigationholdenabled -eq $true} | fl LegacyExchangeDN, ServerName, Database, LitigationHoldEnabled, LitigationHoldDate, LitigationHoldOwner, DisplayName
##Remove-PSSession $global:session365
</pre>

<p>Validate the script and select the columns which now show up defined as expected. Then after the Wizard closes, go into the XML and un-remark the above 6 lines in a text editor.</p>

<h2>Additional Comments</h2>

<p>When asked why not just use the connection profile instead of un-remarking the impersonation lines from the code, the response was this:</p>

<p>The connection profile authenticates against our Active Directory, while the top lines run a session using admin credentials specific for Office 365 Exchange Online on their server. Remarking the top lines returns on-premise mailboxes.</p>

<p><strong>Note:</strong> The PowerShell DC has been updated to support UPN for 7.1 but is not included in the December 2015 release.</p>
</body>
</html>